<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>接口测试 | Fylasd</title><meta name="author" content="Fylasd"><meta name="copyright" content="Fylasd"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="基础版HTTP协议简介讲解http常见的请求方法和使用 WEB API接口 大都是基于 HTTP 协议的，所以，要进行接口测试 首先要了解 HTTP 协议 的 基础知识。 HTTP 协议 全称是 超文本传输协议， 英文是 Hypertext Transfer Protocol 。 HTTP 最初是用来 在 浏览器和 网站服务器（web服务）之间 传输超文本（网页、视频、图片等）信息的。 由于 HT">
<meta property="og:type" content="article">
<meta property="og:title" content="接口测试">
<meta property="og:url" content="https://www.fixbox.top/2024/01/22/2-8-%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/index.html">
<meta property="og:site_name" content="Fylasd">
<meta property="og:description" content="基础版HTTP协议简介讲解http常见的请求方法和使用 WEB API接口 大都是基于 HTTP 协议的，所以，要进行接口测试 首先要了解 HTTP 协议 的 基础知识。 HTTP 协议 全称是 超文本传输协议， 英文是 Hypertext Transfer Protocol 。 HTTP 最初是用来 在 浏览器和 网站服务器（web服务）之间 传输超文本（网页、视频、图片等）信息的。 由于 HT">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img2.baidu.com/it/u=3725066843,1857864369&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500">
<meta property="article:published_time" content="2024-01-22T07:03:45.191Z">
<meta property="article:modified_time" content="2024-01-22T07:09:36.932Z">
<meta property="article:author" content="Fylasd">
<meta property="article:tag" content="接口测试">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img2.baidu.com/it/u=3725066843,1857864369&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"><link rel="shortcut icon" href="https://img1.baidu.com/it/u=2559221203,2316879426&fm=253&fmt=auto&app=138&f=PNG?w=400&h=400"><link rel="canonical" href="https://www.fixbox.top/2024/01/22/2-8-%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '接口测试',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-22 15:09:36'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><div id="myscoll"></div><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2.baidu.com/it/u=3725066843,1857864369&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Fylasd"><span class="site-name">Fylasd</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">接口测试</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-01-22T07:03:45.191Z" title="发表于 2024-01-22 15:03:45">2024-01-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-22T07:09:36.932Z" title="更新于 2024-01-22 15:09:36">2024-01-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/">软件测试</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">17.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>76分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="接口测试"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="基础版"><a href="#基础版" class="headerlink" title="基础版"></a>基础版</h1><h2 id="HTTP协议简介"><a href="#HTTP协议简介" class="headerlink" title="HTTP协议简介"></a>HTTP协议简介</h2><p>讲解http常见的请求方法和使用</p>
<p>WEB API接口 大都是基于 HTTP 协议的，所以，要进行接口测试 首先要了解 HTTP 协议 的 基础知识。</p>
<p>HTTP 协议 全称是 超文本传输协议， 英文是 Hypertext Transfer Protocol 。</p>
<p>HTTP 最初是用来 在 浏览器和 网站服务器（web服务）之间 传输超文本（网页、视频、图片等）信息的。</p>
<p>由于 HTTP 简洁易用，后来，不仅仅是浏览器 和 服务器之间 使用它， 服务器和服务器之间， 手机App 和 服务器之间， 都广泛的采用。 成了一个软件系统间 通信 的首选协议 之一。</p>
<p>HTTP 有好几个版本，包括： <code>0.9</code> 、 <code>1.0</code> 、 <code>1.1</code> 、 <code>2</code> 、 <code>3</code> ，当前最广泛使用的是 <code>HTTP/1.1</code> 版本。</p>
<p>HTTP 协议最大的特点是 通讯双方 分为 <code>客户端</code> 和 <code>服务端</code> 。</p>
<p>HTTP3 以前版本 （除了HTTP3） , 都是 基于 TCP 协议的， 所以要进行通讯，客户端 必须先 和服务端 创建 TCP 连接。</p>
<p>而且 HTTP 双方的信息交互，必须是这样一种方式：</p>
<ul>
<li>客户端 先发送 http请求（request）给 服务端</li>
<li>然后服务端 发送 http响应（response）给 客户端</li>
</ul>
<p>特别注意：HTTP协议中，服务端不能主动先发送信息给 客户端。</p>
<ul>
<li>http1.0定义了三种：<ul>
<li>GET: 向服务器获取资源，比如常见的查询请求</li>
<li>POST: 向服务器提交数据而发送的请求</li>
<li>Head: 和get类似，返回的响应中没有具体的内容，用于获取报头</li>
</ul>
</li>
<li>http1.1定义了六种<ul>
<li>PUT：一般是用于更新请求，比如更新个人信息、商品信息全量更新</li>
<li>PATCH：PUT 方法的补充,更新指定资源的部分数据</li>
<li>DELETE：用于删除指定的资源</li>
<li>OPTIONS: 获取服务器支持的HTTP请求方法,服务器性能、跨域检查等</li>
<li>CONNECT: 方法的作用就是把服务器作为跳板，让服务器代替用户去访问其它网页，之后把数据原原本本的返回给用户，网页开发基本不用这个方法，如果是http代理就会使用这个，让服务器代理用户去访问其他网页，类似中介</li>
<li>TRACE：回显服务器收到的请求，主要用于测试或诊断</li>
</ul>
</li>
</ul>
<p>而且在1.1 以前的版本， 服务端 返回响应给客户端后，连接就会 断开 ，下一次双方要进行信息交流，必须重复上面的过程，重新建立连接，客户端发送请求，服务返回响应。</p>
<p>到了 1.1 版本， 建立连接后，这个连接可以保持一段时间（keep alive）， 这段时间，双方可以多次进行 请求和响应， 无需重新建立连接。</p>
<p>如果客户端是浏览器，如何在chrome浏览器中查看 请求和响应的HTTP消息。</p>
<h2 id="HTTP请求消息"><a href="#HTTP请求消息" class="headerlink" title="HTTP请求消息"></a>HTTP请求消息</h2><p><strong>响应状态码</strong></p>
<ul>
<li><p>浏览器向服务器请求时，服务端响应的消息头里面有状态码，表示请求结果的状态</p>
</li>
<li><p>分类</p>
<ul>
<li><p>1XX: 收到请求，需要请求者继续执行操作，比较少用</p>
</li>
<li><p>2XX: 请求成功，常用的 200</p>
</li>
<li><p>3XX: 重定向，浏览器在拿到服务器返回的这个状态码后会自动跳转到一个新的URL地址，这个地址可以从响应的Location首部中获取；</p>
<ul>
<li>好处：网站改版、域名迁移等，多个域名指向同个主站导流</li>
<li>必须记住： 301：永久性跳转，比如域名过期，换个域名 302：临时性跳转</li>
</ul>
</li>
<li><p>4XX: 客服端出错，请求包含语法错误或者无法完成请求</p>
<ul>
<li>必须记住： 400: 请求出错，比如语法协议 403: 没权限访问 404: 找不到这个路径对应的接口或者文件 405: 不允许此方法进行提交，Method not allowed，比如接口一定要POST方式，而你是用了GET</li>
</ul>
</li>
<li><p>5XX: 服务端出错，服务器在处理请求的过程中发生了错误</p>
<ul>
<li>必须记住： 500: 服务器内部报错了，完成不了这次请求 503: 服务器宕机</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>http请求消息由下面几个部分组成</p>
<h3 id="请求行-request-line"><a href="#请求行-request-line" class="headerlink" title="请求行 request line"></a>请求行 request line</h3><p>是http请求的第一行的内容，表示要操作什么资源，使用的 http协议版本是什么。</p>
<p>里面包含了3部分信息： 请求的方法，操作资源的地址， 协议的版本号</p>
<p>例如</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /mgr/login.html HTTP/<span class="number">1.1</span></span><br></pre></td></tr></table></figure>
<p>表示要 <code>获取</code> 资源， 资源的 <code>地址</code>是 <code>/mgr/login.html</code> ， 使用的 <code>协议</code> 是 <code>HTTP/1.1</code></p>
<p>而</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST /api/medicine HTTP/<span class="number">1.1</span></span><br></pre></td></tr></table></figure>
<p>表示 <code>添加</code> 资源信息， 添加资源 到 地址 <code>/api/medicine</code> ， 使用的 <code>协议</code> 是 <code>HTTP/1.1</code></p>
<p>GET、POST是请求的方法，表示这个动作的大体目的，是获取信息，还是提交信息，还是修改信息等等</p>
<p>常见的HTTP 请求方法包括：</p>
<ul>
<li><p>GET</p>
<p>从服务器 <code>获取</code> 资源信息，这是一种最常见的请求。</p>
<p>比如 要 从服务器 获取 网页资源、获取图片资源、获取用户信息数据等等。</p>
</li>
<li><p>POST，请求方法就应该是</p>
<p><code>添加</code> 资源信息 到 服务器进行处理（例如提交表单或者上传文件）。</p>
<p>比如 要 添加用户信息、上传图片数据 到服务器 等等</p>
<p>具体的数据信息，通常在 HTTP消息体中， 后面会讲到</p>
</li>
<li><p>PUT</p>
<p>请求服务器 <code>更新</code> 资源信息 。</p>
<p>比如 要 更新 用户姓名、地址 等等</p>
<p>具体的更新数据信息，通常在 HTTP消息体中， 后面会讲到</p>
</li>
<li><p>DELETE</p>
<p>请求服务器 <code>删除</code> 资源信息 。</p>
<p>比如 要 删除 某个用户、某个药品 等等</p>
</li>
</ul>
<p>HTTP还有许多其他方法，比如 PATCH、HEAD 等，不是特别常用，暂且不讲。</p>
<p>请求行里面还包括了url，</p>
<p>比如</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/mgr/login.html</span><br></pre></td></tr></table></figure>
<p>url表示要获取资源的具体路径</p>
<p>url特别要注意的是 <code>url参数</code> ，英文叫 <code>url query String</code></p>
<p>什么是url参数？</p>
<p>比如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.baidu.com/s?wd=iphone&amp;rsv_spt=1</span><br></pre></td></tr></table></figure>
<p>问号后面的部分 <code>wd=iphone&amp;rsv_spt=1</code> 就是 url 参数，</p>
<p>每个参数之间是用 <code>&amp;</code> 隔开的。</p>
<p>上面的例子中 有两个参数 wd 和 rsv_spt， 他们的值分别为 iphone 和 1 。</p>
<p>url参数的格式，有个术语叫 <code>urlencoded</code> 格式。</p>
<h3 id="请求头-request-headers"><a href="#请求头-request-headers" class="headerlink" title="请求头 request headers"></a>请求头 request headers</h3><p>请求头是http请求行下面的 的内容，里面存放 一些 信息。</p>
<p>比如，请求发送的服务端域名是什么， 希望接收的响应消息使用什么语言，请求消息体的长度等等。</p>
<p>通常请求头 都有好多个，一个请求头 占据一行</p>
<p>单个请求头的 格式是： <code>名字: 值</code></p>
<p>HTTP协议规定了一些标准的请求头，<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">点击查看MDN的描述</a></p>
<p>开发者，也可以在HTTP消息中 添加自己定义的请求头</p>
<h3 id="消息体-message-body"><a href="#消息体-message-body" class="headerlink" title="消息体 message body"></a>消息体 message body</h3><p>请求的url、请求头中 可以存放 一些数据信息， 但是 有些数据信息，往往需要 存放在消息体中。</p>
<p>特别是 POST、PUT等请求，添加、修改的数据信息 通常都是 存放在 请求消息体 中的。</p>
<p>如果 HTTP 请求 有 消息体， 协议规定 需要在 消息头和消息体 之间 插入一个空行， 隔开 它们。</p>
<p>请求消息体中保存了要提交给服务端的数据信息。</p>
<p>比如：客户端要上传一个文件给服务端，就可以通过HTTP请求发送文件数据给服务端。</p>
<p>文件的数据 就应该在请求的消息体中。</p>
<p>再比如：上面示例中 客户端要添加药品，药品的名称、编码、描述，就存放在请求消息体中。</p>
<p>WEB API 请求消息体 通常是某种格式的文本，常见的有</p>
<ul>
<li>Json</li>
<li>Xml</li>
<li>www-form-urlencoded</li>
</ul>
<p>后面会有详细的讲述</p>
<h2 id="HTTP响应消息"><a href="#HTTP响应消息" class="headerlink" title="HTTP响应消息"></a>HTTP响应消息</h2><p>下面是1个http响应消息的示例</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">HTTP/1.1</span> <span class="number">200</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">Date:</span> <span class="string">Thu,</span> <span class="number">19</span> <span class="string">Sep</span> <span class="number">2019 08:08:27 </span><span class="string">GMT</span></span><br><span class="line"><span class="attr">Server:</span> <span class="string">WSGIServer/0.2</span> <span class="string">CPython/3.7.3</span></span><br><span class="line"><span class="attr">Content-Type:</span> <span class="string">application/json</span></span><br><span class="line"><span class="attr">Content-Length:</span> <span class="number">37</span></span><br><span class="line"><span class="attr">X-Frame-Options:</span> <span class="string">SAMEORIGIN</span></span><br><span class="line"><span class="attr">Vary:</span> <span class="string">Cookie</span></span><br><span class="line">&#123;<span class="attr">&quot;ret&quot;:</span> <span class="number">0</span>, <span class="attr">&quot;retlist&quot;:</span> [], <span class="attr">&quot;total&quot;:</span> <span class="number">0</span>&#125;</span><br></pre></td></tr></table></figure>
<p>HTTP响应消息包含如下几个部分</p>
<h3 id="状态行-status-line"><a href="#状态行-status-line" class="headerlink" title="状态行 status line"></a>状态行 status line</h3><p>状态行在第一行，包含3个部分：</p>
<ul>
<li><p>协议版本</p>
<p>上面的示例中，就是 <code>HTTP/1.1</code></p>
</li>
<li><p>状态码</p>
<p>上面的示例中，就是 <code>200</code></p>
</li>
<li><p>描述状态的短语</p>
<p>上面的示例中，就是 <code>OK</code></p>
</li>
</ul>
<p>我们重点来看一下状态码，它表示了 服务端对客户端请求的处理结果 。</p>
<p>状态码用3位的数字来表示，第一位 的 数字代表 处理结果的 大体类型，常见的有如下几种：</p>
<p>• 2xx    通常 表示请求消息 没有问题，而且 服务器 也正确处理了</p>
<p>最常见的就是 200</p>
<p>• 3xx    这是重定向响应，常见的值是 301，302， 表示客户端的这个请求的url地址已经改变了， 需要 客户端 重新发起一个 请求 到另外的一个url。</p>
<p>• 4xx    表示客户端请求有错误， 常见的值有：</p>
<p><code>400 Bad Request</code> 表示客户端请求不符合接口要求，比如格式完全错误</p>
<p><code>401 Unauthorized</code> 表示客户端需要先认证才能发送次请求</p>
<p><code>403 Forbidden</code> 表示客户端没有权限要求服务器处理这样的请求， 比如普通用户请求删除别人账号等</p>
<p><code>404 Not Found</code> 表示客户端请求的url 不存在</p>
<p>• 5xx    表示服务端在处理请求中，发生了未知的错误。</p>
<p>通常是服务端的代码设计问题，或者是服务端子系统出了故障（比如数据库服务宕机了）</p>
<h3 id="响应头-response-headers"><a href="#响应头-response-headers" class="headerlink" title="响应头 response headers"></a>响应头 response headers</h3><p>响应头 是 响应状态行下面的 的内容，里面存放 一些 信息。 作用 和 格式 与请求头类似，不再赘述。</p>
<h3 id="消息体-message-body-1"><a href="#消息体-message-body-1" class="headerlink" title="消息体 message body"></a>消息体 message body</h3><p>有时候，http响应需要消息体。</p>
<p>同样， 如果 HTTP 响应 有 消息体， 协议规定 需要在 消息头和消息体 之间 插入一个空行， 隔开 它们。</p>
<p>比如，白月SMS系统 请求 列出 药品 信息，那么 药品 信息 就在HTTP响应 消息体中</p>
<p>再 比如，浏览器地址栏 输入 登录网址，浏览器 请求一个登录网页的内容，网站服务器，就在响应的消息体中存放登录网页的html内容。</p>
<p>和请求消息体一样，WEB API 响应消息体 通常也是某种格式的文本，常见的有：</p>
<ul>
<li>Json</li>
<li>Xml</li>
<li>www-form-urlencoded</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p><strong>POST请求</strong></p>
<p>POST请求相比GET请求要复杂一点，因为其需要加入请求Header和请求Body，以下是Pre-request Script在发送POST请求的案例：</p>
<ul>
<li>构造一个登录请求</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const loginRequest = &#123;</span><br><span class="line">	url: &#x27;http://115.28.108.130:5000/api/user/login/&#x27;,</span><br><span class="line">	method: &quot;POST&quot;,</span><br><span class="line">    body: &#123;</span><br><span class="line">        mode: &#x27;urlencoded&#x27;,  // 模式为表单url编码模式</span><br><span class="line">        urlencoded: &#x27;name=张三&amp;password=123456&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>发送请求</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pm.sendRequest(loginRequest, function (err, res) &#123;</span><br><span class="line">	console.log(err ? err : res.text());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>发送JSON格式请求与发送POST请求类似，以下采用了raw模式发送请求体。</p>
<ul>
<li>构造一个注册请求</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const regRequest = &#123;</span><br><span class="line">    url: &#x27;http://115.28.108.130:5000/api/user/reg/&#x27;,</span><br><span class="line">    method: &#x27;POST&#x27;,</span><br><span class="line">    header: &#x27;Content-Type: application/json&#x27;,  //注意要在Header中声明内容使用的类型</span><br><span class="line">    body: &#123;</span><br><span class="line">        mode: &#x27;raw&#x27;,  // 使用raw(原始)格式</span><br><span class="line">        raw: JSON.stringify(&#123; name: &#x27;小小&#x27;, password: &#x27;123456&#x27; &#125;) //要将JSON对象转为文本发送</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>因为HTTP请求都支持raw格式，我们只要能够获取请求的raw格式，便可采用raw模式发送任意类型的请求体了。</p>
<h2 id="接口数据用例"><a href="#接口数据用例" class="headerlink" title="接口数据用例"></a>接口数据用例</h2><h3 id="数据用例设计"><a href="#数据用例设计" class="headerlink" title="数据用例设计"></a>数据用例设计</h3><p>Postman支持的是csv文件作为数据用例，数据用例包含三大部分，分别为：用例标题（title），入参（grant_type，appid，secret），期望结果（expected）</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>title</strong></th>
<th><strong>grant_type</strong></th>
<th><strong>appid</strong></th>
<th><strong>secret</strong></th>
<th><strong>expected</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>正确的用例</td>
<td>client_credential</td>
<td>wx508a5cacbbfc1141</td>
<td>fa4fc7f17ddead12d7cdcd994e7d2543</td>
<td>7200</td>
</tr>
<tr>
<td>grant_type错误</td>
<td>client_credentia</td>
<td>wx508a5cacbbfc1141</td>
<td>fa4fc7f17ddead12d7cdcd994e7d2543</td>
<td>40002</td>
</tr>
<tr>
<td>appid错误</td>
<td>client_credential</td>
<td>wx508a5cacbbfc114</td>
<td>fa4fc7f17ddead12d7cdcd994e7d2543</td>
<td>40013</td>
</tr>
<tr>
<td>secret错误h</td>
<td>client_credential</td>
<td>wx508a5cacbbfc1141</td>
<td>fa4fc7f17ddead12d7cdcd994e7d254</td>
<td>40001</td>
</tr>
</tbody>
</table>
</div>
<p>我们可以根据黑盒用例设计方法如等价类、边界值、判定表、正交实验法对入参进行用例设计，得到各种不同的测试场景（取值组合）</p>
<h3 id="数据用例参数化"><a href="#数据用例参数化" class="headerlink" title="数据用例参数化"></a>数据用例参数化</h3><p>前面我们在csv文件中编写好了数据用例，且保证第一行为参数的名称。将请求中入参值依次进行替换，在Postman中参数的编写规格为两个花括号，如：</p>
<h3 id="设置迭代器"><a href="#设置迭代器" class="headerlink" title="设置迭代器"></a>设置迭代器</h3><p>要读取所有的测试用例，需要设置迭代器让其循环读取那些测试数据。Postman中设置迭代器需在Run中完成，请看【4.Runner执行测试】</p>
<h3 id="结果检查（断言）"><a href="#结果检查（断言）" class="headerlink" title="结果检查（断言）"></a>结果检查（断言）</h3><p>Postman的断言功能在Test模块中，比如要测试返回结果是否含有某一字符串，就需要在Test中编写相应的代码，Test中的代码使用的是JavaScript语法。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427104843664-452299200.png" alt="img"></p>
<h3 id="自带Tests函数"><a href="#自带Tests函数" class="headerlink" title="自带Tests函数"></a>自带Tests函数</h3><p>Postman提供了参考代码供我们选择即可，主要断言代码有如下几种：</p>
<p># 断言状态码是否为200，在断言中此种断言价值不高</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="title function_">test</span>(<span class="string">&quot;Status code is 200&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">	pm.<span class="property">response</span>.<span class="property">to</span>.<span class="property">have</span>.<span class="title function_">status</span>(<span class="number">200</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p># 断言响应文本中是否包含某个数据串，常用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="title function_">test</span>(<span class="string">&quot;Body matches string&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">	pm.<span class="title function_">expect</span>(pm.<span class="property">response</span>.<span class="title function_">text</span>()).<span class="property">to</span>.<span class="title function_">include</span>(<span class="string">&quot;string_you_want_to_search&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p># 使用JsonPath断言</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="title function_">test</span>(<span class="string">&quot;Your test name&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> jsonData = pm.<span class="property">response</span>.<span class="title function_">json</span>();</span><br><span class="line">    pm.<span class="title function_">expect</span>(jsonData.<span class="property">value</span>).<span class="property">to</span>.<span class="title function_">eql</span>(<span class="number">100</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p># 检查响应正文中是否包含某个子串</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="title function_">test</span>(<span class="string">&quot;Body is correct&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">	pm.<span class="property">response</span>.<span class="property">to</span>.<span class="property">have</span>.<span class="title function_">body</span>(<span class="string">&quot;response_body_string&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p># 响应信息包含列表中其中某一个</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="title function_">test</span>(<span class="string">&quot;Successful POST request&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">	pm.<span class="title function_">expect</span>(pm.<span class="property">response</span>.<span class="property">code</span>).<span class="property">to</span>.<span class="property">be</span>.<span class="title function_">oneOf</span>([<span class="number">201</span>,<span class="number">202</span>]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p># 将xml响应转为json</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonObject = <span class="title function_">xml2Json</span>(responseBody);</span><br></pre></td></tr></table></figure>
<h3 id="手工tests函数"><a href="#手工tests函数" class="headerlink" title="手工tests函数"></a>手工tests函数</h3><p>也可以使用断言并赋值的形式，相对而言，以下方式会更为简洁实用。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427104906873-1008787771.png" alt="img"></p>
<p>常见的断言代码有：</p>
<p># 检查response的body中是否包含字符串</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tests[<span class="string">&quot;Body matches string&quot;</span>] = responseBody.<span class="title function_">has</span>(<span class="string">&quot;string_you_want_to_search&quot;</span>);</span><br></pre></td></tr></table></figure>
<p># 检查JSON节点的值和节点元素的个数为5</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(responseBody).<span class="property">city</span>; <span class="comment">//把JSON字符串转化为对象</span></span><br><span class="line">tests[<span class="string">&quot;Your test name&quot;</span>] = data.<span class="property">value</span>===<span class="number">100</span>;</span><br><span class="line">tests[<span class="string">&quot;program&#x27;s lenght&quot;</span>] = data.<span class="property">programs</span>.<span class="property">length</span>===<span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<p># 验证Response time是否小于某个值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tests[<span class="string">&quot;Response time is less than 200ms&quot;</span>] = responseTime &lt; <span class="number">200</span>;</span><br></pre></td></tr></table></figure>
<h3 id="tests高级操作"><a href="#tests高级操作" class="headerlink" title="tests高级操作"></a>tests高级操作</h3><p>我们可以引用数据用例csv文档中的预期结果进行断言。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonData = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(responseBody) ;</span><br><span class="line"># data.<span class="property">expected</span> 为csv数据文件中的预期结</span><br><span class="line">tests[<span class="string">&quot;测试结果通过&quot;</span>] = jsonData.<span class="property">expires_in</span>===data.<span class="property">expected</span> ;</span><br></pre></td></tr></table></figure>
<p>在tests还可以使用判断语句进行断言，如下：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427104924703-1231663608.png" alt="img"></p>
<p>在Postman中断言的操作非常灵活，需要同学们多进行练习。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="title function_">test</span>(<span class="string">&quot;预期结果包含：长沙，实际结果为：&quot;</span>+result, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">if</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(responseBody).<span class="property">city</span>===<span class="string">&quot;长沙&quot;</span>)&#123;</span><br><span class="line">       pm.<span class="title function_">expect</span>(pm.<span class="property">response</span>.<span class="title function_">text</span>()).<span class="property">to</span>.<span class="title function_">include</span>(<span class="string">&quot;千里&quot;</span>);</span><br><span class="line">       pm.<span class="title function_">expect</span>(pm.<span class="property">response</span>.<span class="title function_">text</span>()).<span class="property">to</span>.<span class="title function_">include</span>(<span class="string">&quot;长沙&quot;</span>);</span><br><span class="line">   &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(responseBody).<span class="property">city</span>===<span class="string">&quot;Changsha&quot;</span>)&#123;</span><br><span class="line">       pm.<span class="title function_">expect</span>(pm.<span class="property">response</span>.<span class="title function_">text</span>()).<span class="property">to</span>.<span class="title function_">include</span>(<span class="string">&quot;千里&quot;</span>);</span><br><span class="line">       pm.<span class="title function_">expect</span>(pm.<span class="property">response</span>.<span class="title function_">text</span>()).<span class="property">to</span>.<span class="title function_">include</span>(<span class="string">&quot;Changsha&quot;</span>);</span><br><span class="line">   &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(responseBody).<span class="property">city</span>===<span class="string">&quot;長沙&quot;</span>)&#123;</span><br><span class="line">       pm.<span class="title function_">expect</span>(pm.<span class="property">response</span>.<span class="title function_">text</span>()).<span class="property">to</span>.<span class="title function_">include</span>(<span class="string">&quot;千里&quot;</span>);</span><br><span class="line">       pm.<span class="title function_">expect</span>(pm.<span class="property">response</span>.<span class="title function_">text</span>()).<span class="property">to</span>.<span class="title function_">include</span>(<span class="string">&quot;長沙&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Runner执行测试"><a href="#Runner执行测试" class="headerlink" title="Runner执行测试"></a>Runner执行测试</h2><h3 id="设置迭代器-1"><a href="#设置迭代器-1" class="headerlink" title="设置迭代器"></a>设置迭代器</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427105315770-383070439.png" alt="img"></p>
<p><strong>查看运行结果</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427105325462-1331927071.png" alt="img"></p>
<p><strong>保存接口配置</strong></p>
<p>待整个接口都调试完毕后，记得点击 Save 去保存接口信息：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427105019191-782729724.png" alt="img"></p>
<p>去保存当前 API 接口，然后需要填写相关的接口信息：</p>
<p>l Request Name: 请求的名字</p>
<p>我一般习惯用保存为 接口的最后的字段名，比如</p>
<p>l Request Description: 接口的描述</p>
<p>最好写上该接口的要实现的基本功能和相关注意事项</p>
<p>支持 Markdown 语法</p>
<p>Select a collection or folder to save: 选择要保存到哪个分组（或文件夹）</p>
<p>往往保存到某个 API 接口到所属的该项目名的分组</p>
<h3 id="Postman的参数"><a href="#Postman的参数" class="headerlink" title="Postman的参数"></a>Postman的参数</h3><p><strong>自动解析多个参数Param</strong></p>
<p>比如，对于一个 GET 的请求的 url 是： <code>https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=wx508a5cacbbfc1141&amp;secret=fa4fc7f17ddead12d7cdcd994e7d2543</code></p>
<p>对应着其实是?key=value形式中包含多个 Http 的 GET 的 query string=query parameters</p>
<p>Postman 可以自动帮我们解析出对应参数：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427105036649-11325508.png" alt="img"></p>
<p><strong>临时禁用参数</strong></p>
<p>在不删除某参数的情况下，如果想要暂时不传参数，可以方便的通过不勾选的方式去实现</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427105044712-1306494929.png" alt="img"></p>
<p><strong>批量编辑多个参数</strong></p>
<p>如果想要批量的编辑参数，可以点击右上角的Bulk Edit，去实现批量编辑。</p>
<p><strong>Postman发送POST请求详讲</strong></p>
<p>POST 请求不能像GET一样直接在浏览器输入就可以请求，需要借助工具来完成。</p>
<p><strong>发送key-value 的请求：</strong></p>
<p>以login 接口为例，在Body 中选取<strong>“form-data”</strong> 格式，输入所需的key-value, 选取对应的环境变量。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427105104041-1268949398.png" alt="img"></p>
<p><strong>发送json格式的请求：</strong></p>
<p>以add user 接口为例，在Body 中选取<strong>“raw”</strong> 格式，根据接口文档输入json 数据， 有需要应用环境变量的选取环境变量。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427105113788-2022830149.png" alt="img"></p>
<p><strong>发送文件的请求</strong></p>
<p>以file upload 接口为例，在Body 中选取<strong>“form-data”</strong> 格式，在key 里输入”file”，在右边的下拉里选取类型为”File”，点击”Choose Files” 就可以上传本地文件了。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427105125256-2121388460.png" alt="img"></p>
<h3 id="环境变量设置"><a href="#环境变量设置" class="headerlink" title="环境变量设置"></a>环境变量设置</h3><p><strong>设置环境变量的意义</strong></p>
<p>在测试 API 期间，往往存在多种环境，对应 IP 地址（或域名也不同）。比如：</p>
<p>Dev：<a target="_blank" rel="noopener" href="http://192.168.1.21/oa/index.jsp">http://192.168.1.21/oa/index.jsp</a></p>
<p>l 用于开发期间的线上的 Development 的测试环境</p>
<p>LocalTest：<a target="_blank" rel="noopener" href="http://192.168.1.42/oa/index.jsp">http://192.168.1.42/oa/index.jsp</a></p>
<p>l 用于开发期间配合后台开发人员的本地局域网内的本地环境，用于联合调试 API 接口</p>
<p>Product：<a target="_blank" rel="noopener" href="http://www.example.com/oa/index.jsp">http://www.example.com/oa/index.jsp</a></p>
<p>l 用于开发完成发布到生产环境</p>
<p>在测试API期间，往往需要修改API地址，这样效率会比较低且更换后的地址没法保存。</p>
<p><strong>环境变量设置</strong></p>
<p>在Postman的设置区有Environment 和 Global Variable，用于解决这个问题，实现不同环境的管理：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2020.cnblogs.com/blog/465934/202004/465934-20200427105146287-238101285.png" alt="img"></p>
<p>很明显，就可以用来实现不用手动修改 url 中的服务器地址，从而动态的实现，支持不同服务器环境:</p>
<p>l Production 生产环境</p>
<p>l Development 开发环境</p>
<p>l Local 本地局域网环境</p>
<p><em>环境变量可以使用在以下地方</em>：</p>
<p>l URL</p>
<p>l URL params</p>
<p>l Header values</p>
<p>l form-data/url-encoded values</p>
<p>l Raw body content</p>
<p><strong>注意：在你要使用的变量名上附上\</strong>**双花括号**<em>\</em>，一个请求只能应用一个环境变量。**</p>
<p><strong>使用代码设置环境变量</strong></p>
<p>我们可以在Pre-request Script和Test模块中进行环境变量设置。</p>
<p>—1.设置环境变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">postman.<span class="title function_">setEnvironmentVariable</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>—2.获取环境变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="property">environment</span>.<span class="title function_">get</span>(<span class="string">&quot;variable_key&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h3><p>全局变量（Global Variable）顾名思义是针对于所有脚本和所有环境将生效的变量，它的作用域大于环境变量。设置全局变量的方法与环境变量相似：</p>
<p>—1.设置全局变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="property">globals</span>.<span class="title function_">set</span>(<span class="string">&quot;variable_key&quot;</span>, <span class="string">&quot;variable_value&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>—2.获取全局变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="property">globals</span>.<span class="title function_">get</span>(<span class="string">&quot;variable_key&quot;</span>);</span><br></pre></td></tr></table></figure>
<h1 id="进价版"><a href="#进价版" class="headerlink" title="进价版"></a>进价版</h1><h2 id="requests"><a href="#requests" class="headerlink" title="requests"></a>requests</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a><strong>简介</strong></h3><p>Requests 请求是用 Python 语言编写， 基于 urllib，采用 Apache2 Licensed 开源协议的 HTTP 库。 它比 urllib 更加方便，可以节约我们大量的工作，完全满足 HTTP 测试需求。 Requests 的是以 PEP 20 的习语为中心开发的， 所以它比 urllib 更加 Python 智能化。 更重要的一点是它支持 Python3</p>
<p>安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install requests</span><br></pre></td></tr></table></figure>
<h3 id="常用参数"><a href="#常用参数" class="headerlink" title="常用参数"></a><strong>常用参数</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">method： 请求方式 get，或者 post，put，delete 等</span><br><span class="line">url 请求的: url 地址 接口文档标注的接口请求地址</span><br><span class="line">params：请求数据中的链接，常见的一个 get 请求，请求参数都是在 url 地址中</span><br><span class="line">data ：请求数据，参数 表单的数据格式</span><br><span class="line">json： 接口常见的数据请求格式</span><br><span class="line">headers：请求头信息，http 请求中，比如说编码方式等内容添加</span><br><span class="line">cookie：保存的用户登录信息，比如做一些充值功能，但是需要用户已经登录，需要 cookie 信息的请求信息传输</span><br><span class="line">file：接口中上传文件</span><br><span class="line">timeout ：超时处理 proxys 设置代理</span><br><span class="line">stream ：文件下载功能，通过请求方式，下载文件</span><br></pre></td></tr></table></figure>
<h3 id="响应内容"><a href="#响应内容" class="headerlink" title="响应内容"></a><strong>响应内容</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">r.encoding <span class="comment">#获取当前的编码</span></span><br><span class="line">r.encoding = <span class="string">&#x27;utf-8&#x27;</span> <span class="comment">#设置编码</span></span><br><span class="line">r.text <span class="comment">#以encoding解析返回内容。字符串方式的响应体，会自动根据响应头部的字符编码进行解码。</span></span><br><span class="line">r.cookies <span class="comment">#返回cookie</span></span><br><span class="line">r.headers <span class="comment">#以字典对象存储服务器响应头，但是这个字典比较特殊，字典键不区分大小写，若键不存在则返回None</span></span><br><span class="line">r.status_code <span class="comment">#响应状态码</span></span><br><span class="line">r.json() <span class="comment">#Requests中内置的JSON解码器，以json形式返回,前提返回的内容确保是json格式的，不然解析出错会抛异常</span></span><br><span class="line">r.content <span class="comment">#以字节形式（二进制）返回。字节方式的响应体，会自动为你解码 gzip 和 deflate 压缩。</span></span><br></pre></td></tr></table></figure>
<p><strong>实例</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&#x27;http://tcc.taobao.com/cc/json/mobile_tel_segment.htm?tel=xxxxxxxxxxx&#x27;</span></span><br><span class="line">r = requests.get(url=url)</span><br><span class="line"><span class="built_in">print</span> (r.text)</span><br><span class="line"></span><br><span class="line"><span class="comment">#返回数据</span></span><br><span class="line">__GetZoneResult_ = &#123;</span><br><span class="line">    mts:<span class="string">&#x27;1316375&#x27;</span>,</span><br><span class="line">    province:<span class="string">&#x27;广东&#x27;</span>,</span><br><span class="line">    catName:<span class="string">&#x27;中国联通&#x27;</span>,</span><br><span class="line">    telString:<span class="string">&#x27;XXXXXXXXXXX&#x27;</span>,</span><br><span class="line">    areaVid:<span class="string">&#x27;30517&#x27;</span>,</span><br><span class="line">    ispVid:<span class="string">&#x27;xxxxxxxxxxx&#x27;</span>,</span><br><span class="line">    carrier:<span class="string">&#x27;广东联通&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>把参数添加到params中</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&#x27;http://tcc.taobao.com/cc/json/mobile_tel_segment.htm&#x27;</span></span><br><span class="line">params=&#123;<span class="string">&#x27;tel&#x27;</span>:<span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line">r = requests.get(url=url,params=params)</span><br><span class="line"><span class="built_in">print</span> (r.text) <span class="comment">#打印接口请求返回的值</span></span><br></pre></td></tr></table></figure>
<p>Requests 中 post 请求</p>
<p><strong>From-data 数据格式的接口</strong></p>
<p>注册接口，<br>数据格式是 data 格式<br>url 地址：​<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=http%3A%2F%2F127.0.0.1%3A8000%2Fregister"> ​http://127.0.0.1:8000/register​</a>​请求方式：post<br>请求 请求参数：username password</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests </span><br><span class="line">url=<span class="string">&quot;http://127.0.0.1:8000/register&quot;</span> </span><br><span class="line"><span class="comment">#表单数据格式，参数 data ，数据都是字典去保存 </span></span><br><span class="line">data=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;liang001&quot;</span>, <span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span> &#125;</span><br><span class="line">r_reg=requests.post(url=url,data=data) </span><br><span class="line"><span class="built_in">print</span> (r_reg.text)</span><br></pre></td></tr></table></figure>
<p><strong>json 数据格式的接口</strong></p>
<p>登录接口，数据格式是 json 格式<br>url 地址：​​<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=http%3A%2F%2F127.0.0.1%3A8000%2Flogin"> ​http://127.0.0.1:8000/login​</a>​​请求方式：post 请求<br>请求参数：username，password</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests </span><br><span class="line">url=<span class="string">&quot;http://127.0.0.1:8000/login&quot;</span> </span><br><span class="line"><span class="comment">#表单数据格式，参数 data ，数据都是字典去保存 </span></span><br><span class="line">data=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;liang001&quot;</span>, <span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span> &#125;</span><br><span class="line">r_login=requests.post(url=url,json=data) </span><br><span class="line"><span class="built_in">print</span> (r_login.text)</span><br></pre></td></tr></table></figure>
<p>如果要用参数data传参的话，在请求头要声明参数格式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests </span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">url=<span class="string">&quot;http://127.0.0.1:8000/login&quot;</span> </span><br><span class="line">header=&#123;<span class="string">&#x27;content-type&#x27;</span>:<span class="string">&#x27;application/json&#x27;</span>&#125;</span><br><span class="line">data=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;liang001&quot;</span>, <span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span> &#125;</span><br><span class="line">r_login=requests.post(url=url,data=json.dumps(data)) </span><br><span class="line"><span class="built_in">print</span> (r_login.text)</span><br></pre></td></tr></table></figure>
<h3 id="定制头和cookie信息"><a href="#定制头和cookie信息" class="headerlink" title="定制头和cookie信息"></a>定制头和cookie信息</h3><p>在HTTP应用中Cookies和Header处理是非常普遍的事情，一般情况下用于记录用户的持久化信息和验证等功能，在运用requests库进行接口请求时，我们往往也会遇到需要带上请求头或者cookie的情况。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">header = &#123;<span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;my-app/0.0.1&#x27;</span><span class="string">&#x27;&#125;</span></span><br><span class="line"><span class="string">cookie = &#123;&#x27;</span>key<span class="string">&#x27;:&#x27;</span>value<span class="string">&#x27;&#125;</span></span><br><span class="line"><span class="string">r = requests.get/post(&#x27;</span>your url<span class="string">&#x27;,headers=header,cookies=cookie)</span></span><br></pre></td></tr></table></figure>
<p>登录后复制 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;<span class="string">&#x27;some&#x27;</span>: <span class="string">&#x27;data&#x27;</span>&#125;</span><br><span class="line">headers = &#123;<span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:22.0) Gecko/20100101 Firefox/22.0&#x27;</span>&#125;</span><br><span class="line"> </span><br><span class="line">r = requests.post(<span class="string">&#x27;https://api.github.com/some/endpoint&#x27;</span>, data=data, headers=headers)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>
<h3 id="响应状态码"><a href="#响应状态码" class="headerlink" title="响应状态码"></a><strong>响应状态码</strong></h3><p>使用requests方法后，会返回一个response对象，其存储了服务器响应的内容，如上实例中已经提到的 r.text、r.status_code……<br>获取文本方式的响应体实例：当你访问 r.text 之时，会使用其响应的文本编码进行自动解码，并且你可以修改其编码让 r.text 使用自定义的编码进行解码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r = requests.get(<span class="string">&#x27;http://www.itwhy.org&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text, <span class="string">&#x27;\n&#123;&#125;\n&#x27;</span>.<span class="built_in">format</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">79</span>), r.encoding)</span><br><span class="line">r.encoding = <span class="string">&#x27;GBK&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(r.text, <span class="string">&#x27;\n&#123;&#125;\n&#x27;</span>.<span class="built_in">format</span>(<span class="string">&#x27;*&#x27;</span>*<span class="number">79</span>), r.encoding)</span><br></pre></td></tr></table></figure>
<p>示例代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">&#x27;https://github.com/Ranxf&#x27;</span>)       <span class="comment"># 最基本的不带参数的get请求</span></span><br><span class="line"><span class="built_in">print</span>(r.status_code)                               <span class="comment"># 获取返回状态</span></span><br><span class="line">r1 = requests.get(url=<span class="string">&#x27;http://dict.baidu.com/s&#x27;</span>, params=&#123;<span class="string">&#x27;wd&#x27;</span>: <span class="string">&#x27;python&#x27;</span>&#125;)      <span class="comment"># 带参数的get请求</span></span><br><span class="line"><span class="built_in">print</span>(r1.url)</span><br><span class="line"><span class="built_in">print</span>(r1.text)        <span class="comment"># 打印解码后的返回数据</span></span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">bin</span>/python3<span class="number">.5</span> /home/rxf/python3_1000/<span class="number">1000</span>/python3_server/python3_requests/demo1.py</span><br><span class="line"><span class="number">200</span></span><br><span class="line">http://<span class="built_in">dict</span>.baidu.com/s?wd=python</span><br><span class="line">…………</span><br><span class="line"></span><br><span class="line">Process finished <span class="keyword">with</span> exit code </span><br></pre></td></tr></table></figure>
<p>登录后复制 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.status_code                      <span class="comment">#如果不是200，可以使用 r.raise_for_status() 抛出</span></span><br></pre></td></tr></table></figure>
<p><strong>响应</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.headers                                  <span class="comment">#返回字典类型,头信息</span></span><br><span class="line">r.requests.headers                         <span class="comment">#返回发送到服务器的头信息</span></span><br><span class="line">r.cookies                                  <span class="comment">#返回cookie</span></span><br><span class="line">r.history                                  <span class="comment">#返回重定向信息,当然可以在请求时加上allow_redirects = false 阻止重定向</span></span><br></pre></td></tr></table></figure>
<p><strong>超时</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r = requests.get(<span class="string">&#x27;url&#x27;</span>,timeout=<span class="number">1</span>)           <span class="comment">#设置秒数超时，仅对于连接有效</span></span><br></pre></td></tr></table></figure>
<p><strong>会话对象，能够跨请求保持某些参数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = requests.Session()  <span class="comment"># cookies或者session或者token保存于session对象中</span></span><br><span class="line">s.auth = (<span class="string">&#x27;auth&#x27;</span>,<span class="string">&#x27;passwd&#x27;</span>)</span><br><span class="line">s.headers = &#123;<span class="string">&#x27;key&#x27;</span>:<span class="string">&#x27;value&#x27;</span>&#125;</span><br><span class="line">r = s.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">r1 = s.get(<span class="string">&#x27;url1&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>代理</strong></p>
<p>登录后复制 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxies = &#123;<span class="string">&#x27;http&#x27;</span>:<span class="string">&#x27;ip1&#x27;</span>,<span class="string">&#x27;https&#x27;</span>:<span class="string">&#x27;ip2&#x27;</span>&#125;</span><br><span class="line">requests.get(<span class="string">&#x27;url&#x27;</span>,proxies=proxies)  <span class="comment"># 请求时，通过代理可设置抓包</span></span><br></pre></td></tr></table></figure>
<h3 id="https-请求处理"><a href="#https-请求处理" class="headerlink" title="https 请求处理"></a>https 请求处理</h3><p>当协议是 https 的协议的时候，有些系统，需要校验 https 证书，如果校验失败，可能会有警告提示等信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests </span><br><span class="line">url=<span class="string">&quot;https://www.ctrip.com/&quot;</span> </span><br><span class="line"><span class="comment">#解决方案 # 发送请求时候忽略证书，证书的参数 verify-用的比较多 r=requests.get(url=url,verify=False) #verify 参数默认为 True，值为 False 表示忽略证书 </span></span><br><span class="line"><span class="built_in">print</span> (r.text) </span><br><span class="line"><span class="comment">#第二种解决方案，verify 里面添加证书的路径 </span></span><br><span class="line">r=requests.get(url=url,verify=<span class="string">&#x27;证书的路径&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span> (r.text)</span><br></pre></td></tr></table></figure>
<h3 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h3><p>当需要到上传文件接口时候，我们需要 files 参数处理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;https://127.0.0.1:8000/UploadPhoto&#x27;</span>  </span><br><span class="line"><span class="comment">#filename 为 liang.jpg 文件</span></span><br><span class="line"><span class="comment">#open(&#x27;D:\\test_data\\liang.jpg&#x27;,&#x27;rb&#x27;) 打开本地的一个文件 </span></span><br><span class="line">files = &#123;<span class="string">&#x27;file&#x27;</span>:<span class="built_in">open</span>(<span class="string">&#x27;D:\\test_data\\liang.jpg&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)&#125;</span><br><span class="line">r=requests.post(url=url,files=files,verify=<span class="literal">False</span>) </span><br><span class="line"><span class="built_in">print</span> (r.text)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  上传文件（图片）</span></span><br><span class="line">url=<span class="string">&quot;https://www.imooc.com/user/postpic&quot;</span></span><br><span class="line">file = &#123;</span><br><span class="line">    <span class="string">&quot;fileField&quot;</span>:(<span class="string">&quot;fullimage.png&quot;</span>,<span class="built_in">open</span>(<span class="string">&quot;C:/Users/Admin/Pictures/Saved Pictures/fullimage.png&quot;</span>,<span class="string">&quot;rb&quot;</span>),<span class="string">&quot;image/png&quot;</span>),</span><br><span class="line">    <span class="string">&quot;type&quot;</span>:<span class="string">&quot;1&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">cookie = &#123; <span class="string">&quot;apsid&quot;</span>:<span class="string">&quot;U4ODM2MWI2MGZhZjk2ZGEyODEwODY2YWRmMzNjM2MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMTEzOTU1NzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADZkNDBhNWM5OTk2YzQ2MzJhMWJkMWU3NWFlZWZiZjdkDkmeZQAAAAA%3DYm&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url,files=file,cookies=cookie,verify=<span class="literal">False</span>).json()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h3 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h3><p><strong>一次性下载</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://www.xxxx/demo.zip&#x27;</span></span><br><span class="line">r = requests.get(url)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;filename.zip&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> code:</span><br><span class="line">    code.write(r.content)</span><br></pre></td></tr></table></figure>
<p><strong>大文件下载：</strong></p>
<p>如果文件比较大的话，那么下载下来的文件先放在内存中，内存还是比较有压力的。所以为了防止内存不够用的现象出现，我们要想办法把下载的文件分块写到磁盘中,需要用到request的参数stream</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://www.xxxx/demo.zip&#x27;</span></span><br><span class="line">r = requests.get(url, stream=<span class="literal">True</span>)  <span class="comment">##stream-true，限制文件的大小</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;filename.zip&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> code:</span><br><span class="line">    <span class="keyword">for</span> chunk <span class="keyword">in</span> r.iter_content(chunk_size=<span class="number">1024</span>):<span class="comment">#iter_content 循环去读取信息写入，chunk_size 文件大 小</span></span><br><span class="line">        <span class="keyword">if</span> chunk:</span><br><span class="line">            code.write(chunk) <span class="comment">#把循环读取的值，写入文件里面</span></span><br></pre></td></tr></table></figure>
<h3 id="timeout-参数"><a href="#timeout-参数" class="headerlink" title="timeout 参数"></a>timeout 参数</h3><p>1、python 的requests请求都可以使用timeout参数。<br>2、timeout参数可以传入一个简单的浮点数，它将请求的连接部分和读取部分设为相同的超时时间。<br>3、timeout参数也可以传入一个包含两个简单浮点数的元组，用来分别设置请求超时时间和读取超时时间。<br>4、参数值设为None或者不设置该参数为一直等待，知道请求成功或错误</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">&quot;http://127.0.0.1:8000/login&quot;</span></span><br><span class="line"><span class="comment"># 表单数据格式，参数 data ，数据都是字典去保存</span></span><br><span class="line">data = &#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>&#125;</span><br><span class="line">r_login = requests.post(url=url, json=data, timeout=<span class="number">0.5</span>)</span><br><span class="line"><span class="built_in">print</span>(r_login.text)</span><br></pre></td></tr></table></figure>
<h3 id="汇总："><a href="#汇总：" class="headerlink" title="汇总："></a>汇总：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HTTP请求类型</span></span><br><span class="line"><span class="comment"># get类型</span></span><br><span class="line">r = requests.get(<span class="string">&#x27;https://github.com/timeline.json&#x27;</span>)</span><br><span class="line"><span class="comment"># post类型</span></span><br><span class="line">r = requests.post(<span class="string">&quot;http://m.ctrip.com/post&quot;</span>)</span><br><span class="line"><span class="comment"># put类型</span></span><br><span class="line">r = requests.put(<span class="string">&quot;http://m.ctrip.com/put&quot;</span>)</span><br><span class="line"><span class="comment"># delete类型</span></span><br><span class="line">r = requests.delete(<span class="string">&quot;http://m.ctrip.com/delete&quot;</span>)</span><br><span class="line"><span class="comment"># head类型</span></span><br><span class="line">r = requests.head(<span class="string">&quot;http://m.ctrip.com/head&quot;</span>)</span><br><span class="line"><span class="comment"># options类型</span></span><br><span class="line">r = requests.options(<span class="string">&quot;http://m.ctrip.com/get&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取响应内容</span></span><br><span class="line"><span class="built_in">print</span>(r.content) <span class="comment">#以字节的方式去显示，中文显示为字符</span></span><br><span class="line"><span class="built_in">print</span>(r.text) <span class="comment">#以文本的方式去显示</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#URL传递参数</span></span><br><span class="line">payload = &#123;<span class="string">&#x27;keyword&#x27;</span>: <span class="string">&#x27;香港&#x27;</span>, <span class="string">&#x27;salecityid&#x27;</span>: <span class="string">&#x27;2&#x27;</span>&#125;</span><br><span class="line">r = requests.get(<span class="string">&quot;http://m.ctrip.com/webapp/tourvisa/visa_list&quot;</span>, params=payload) </span><br><span class="line"><span class="built_in">print</span>（r.url） <span class="comment">#示例为http://m.ctrip.com/webapp/tourvisa/visa_list?salecityid=2&amp;keyword=香港</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取/修改网页编码</span></span><br><span class="line">r = requests.get(<span class="string">&#x27;https://github.com/timeline.json&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> （r.encoding）</span><br><span class="line"></span><br><span class="line"><span class="comment">#json处理</span></span><br><span class="line">r = requests.get(<span class="string">&#x27;https://github.com/timeline.json&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>（r.json()） <span class="comment"># 需要先import json    </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定制请求头</span></span><br><span class="line">url = <span class="string">&#x27;http://m.ctrip.com&#x27;</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span> : <span class="string">&#x27;Mozilla/5.0 (Linux; Android 4.2.1; en-us; Nexus 4 Build/JOP40D) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.166 Mobile Safari/535.19&#x27;</span>&#125;</span><br><span class="line">r = requests.post(url, headers=headers)</span><br><span class="line"><span class="built_in">print</span> （r.request.headers)</span><br><span class="line"></span><br><span class="line"><span class="comment">#复杂post请求</span></span><br><span class="line">url = <span class="string">&#x27;http://m.ctrip.com&#x27;</span></span><br><span class="line">payload = &#123;<span class="string">&#x27;some&#x27;</span>: <span class="string">&#x27;data&#x27;</span>&#125;</span><br><span class="line">r = requests.post(url, data=json.dumps(payload)) <span class="comment">#如果传递的payload是string而不是dict，需要先调用dumps方法格式化一下</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># post多部分编码文件</span></span><br><span class="line">url = <span class="string">&#x27;http://m.ctrip.com&#x27;</span></span><br><span class="line">files = &#123;<span class="string">&#x27;file&#x27;</span>: <span class="built_in">open</span>(<span class="string">&#x27;report.xls&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)&#125;</span><br><span class="line">r = requests.post(url, files=files)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 响应状态码</span></span><br><span class="line">r = requests.get(<span class="string">&#x27;http://m.ctrip.com&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.status_code)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 响应头</span></span><br><span class="line">r = requests.get(<span class="string">&#x27;http://m.ctrip.com&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> (r.headers)</span><br><span class="line"><span class="built_in">print</span> (r.headers[<span class="string">&#x27;Content-Type&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> (r.headers.get(<span class="string">&#x27;content-type&#x27;</span>)) <span class="comment">#访问响应头部分内容的两种方式</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># Cookies</span></span><br><span class="line">url = <span class="string">&#x27;http://example.com/some/cookie/setting/url&#x27;</span></span><br><span class="line">r = requests.get(url)</span><br><span class="line">r.cookies[<span class="string">&#x27;example_cookie_name&#x27;</span>]    <span class="comment">#读取cookies</span></span><br><span class="line">    </span><br><span class="line">url = <span class="string">&#x27;http://m.ctrip.com/cookies&#x27;</span></span><br><span class="line">cookies = <span class="built_in">dict</span>(cookies_are=<span class="string">&#x27;working&#x27;</span>)</span><br><span class="line">r = requests.get(url, cookies=cookies) <span class="comment">#发送cookies</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置超时时间</span></span><br><span class="line">r = requests.get(<span class="string">&#x27;http://m.ctrip.com&#x27;</span>, timeout=<span class="number">0.001</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置访问代理</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">           <span class="string">&quot;http&quot;</span>: <span class="string">&quot;http://10.10.1.10:3128&quot;</span>,</span><br><span class="line">           <span class="string">&quot;https&quot;</span>: <span class="string">&quot;http://10.10.1.100:4444&quot;</span>,</span><br><span class="line">          &#125;</span><br><span class="line">r = requests.get(<span class="string">&#x27;http://m.ctrip.com&#x27;</span>, proxies=proxies)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#如果代理需要用户名和密码，则需要这样：</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: <span class="string">&quot;http://user:pass@10.10.1.10:3128/&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="GET请求"><a href="#GET请求" class="headerlink" title="GET请求"></a>GET请求</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、无参数实例</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">ret = requests.get(<span class="string">&#x27;https://github.com/timeline.json&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(ret.url)</span><br><span class="line"><span class="built_in">print</span>(ret.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2、有参数实例</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">payload = &#123;<span class="string">&#x27;key1&#x27;</span>: <span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>&#125;</span><br><span class="line">ret = requests.get(<span class="string">&quot;http://httpbin.org/get&quot;</span>, params=payload)</span><br><span class="line"><span class="built_in">print</span>(ret.url)</span><br><span class="line"><span class="built_in">print</span>(ret.text)</span><br></pre></td></tr></table></figure>
<h4 id="POST请求"><a href="#POST请求" class="headerlink" title="POST请求"></a>POST请求</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、基本POST实例</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">payload = &#123;<span class="string">&#x27;key1&#x27;</span>: <span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>&#125;</span><br><span class="line">ret = requests.post(<span class="string">&quot;http://httpbin.org/post&quot;</span>, data=payload)</span><br><span class="line"><span class="built_in">print</span>(ret.text)</span><br><span class="line"><span class="comment"># 2、发送请求头和数据实例</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">url = <span class="string">&#x27;https://api.github.com/some/endpoint&#x27;</span></span><br><span class="line">payload = &#123;<span class="string">&#x27;some&#x27;</span>: <span class="string">&#x27;data&#x27;</span>&#125;</span><br><span class="line">headers = &#123;<span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>&#125;</span><br><span class="line">ret = requests.post(url, data=json.dumps(payload), headers=headers)</span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(ret.text)</span><br><span class="line"><span class="built_in">print</span>(ret.cookies)</span><br></pre></td></tr></table></figure>
<h4 id="示例参数"><a href="#示例参数" class="headerlink" title="示例参数"></a>示例参数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">param_method_url</span>():</span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;get&#x27;, url=&#x27;http://127.0.0.1:8000/test/&#x27;)</span></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;post&#x27;, url=&#x27;http://127.0.0.1:8000/test/&#x27;)</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_param</span>():</span><br><span class="line">    <span class="comment"># - 可以是字典</span></span><br><span class="line">    <span class="comment"># - 可以是字符串</span></span><br><span class="line">    <span class="comment"># - 可以是字节（ascii编码以内）</span></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;get&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># params=&#123;&#x27;k1&#x27;: &#x27;v1&#x27;, &#x27;k2&#x27;: &#x27;水电费&#x27;&#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;get&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># params=&quot;k1=v1&amp;k2=水电费&amp;k3=v3&amp;k3=vv3&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;get&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># params=bytes(&quot;k1=v1&amp;k2=k2&amp;k3=v3&amp;k3=vv3&quot;, encoding=&#x27;utf8&#x27;))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 错误</span></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;get&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># params=bytes(&quot;k1=v1&amp;k2=水电费&amp;k3=v3&amp;k3=vv3&quot;, encoding=&#x27;utf8&#x27;))</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_data</span>():</span><br><span class="line">    <span class="comment"># 可以是字典</span></span><br><span class="line">    <span class="comment"># 可以是字符串</span></span><br><span class="line">    <span class="comment"># 可以是字节</span></span><br><span class="line">    <span class="comment"># 可以是文件对象</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;POST&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># data=&#123;&#x27;k1&#x27;: &#x27;v1&#x27;, &#x27;k2&#x27;: &#x27;水电费&#x27;&#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;POST&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># data=&quot;k1=v1; k2=v2; k3=v3; k3=v4&quot;</span></span><br><span class="line">    <span class="comment"># )</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;POST&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># data=&quot;k1=v1;k2=v2;k3=v3;k3=v4&quot;,</span></span><br><span class="line">    <span class="comment"># headers=&#123;&#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;&#125;</span></span><br><span class="line">    <span class="comment"># )</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;POST&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># data=open(&#x27;data_file.py&#x27;, mode=&#x27;r&#x27;, encoding=&#x27;utf-8&#x27;), # 文件内容是：k1=v1;k2=v2;k3=v3;k3=v4</span></span><br><span class="line">    <span class="comment"># headers=&#123;&#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;&#125;</span></span><br><span class="line">    <span class="comment"># )</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_json</span>():</span><br><span class="line">    <span class="comment"># 将json中对应的数据进行序列化成一个字符串，json.dumps(...)</span></span><br><span class="line">    <span class="comment"># 然后发送到服务器端的body中，并且Content-Type是 &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;</span></span><br><span class="line">    requests.request(method=<span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                     url=<span class="string">&#x27;http://127.0.0.1:8000/test/&#x27;</span>,</span><br><span class="line">                     json=&#123;<span class="string">&#x27;k1&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;水电费&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_headers</span>():</span><br><span class="line">    <span class="comment"># 发送请求头到服务器端</span></span><br><span class="line">    requests.request(method=<span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                     url=<span class="string">&#x27;http://127.0.0.1:8000/test/&#x27;</span>,</span><br><span class="line">                     json=&#123;<span class="string">&#x27;k1&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;水电费&#x27;</span>&#125;,</span><br><span class="line">                     headers=&#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;</span><br><span class="line">                     )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_cookies</span>():</span><br><span class="line">    <span class="comment"># 发送Cookie到服务器端</span></span><br><span class="line">    requests.request(method=<span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                     url=<span class="string">&#x27;http://127.0.0.1:8000/test/&#x27;</span>,</span><br><span class="line">                     data=&#123;<span class="string">&#x27;k1&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>&#125;,</span><br><span class="line">                     cookies=&#123;<span class="string">&#x27;cook1&#x27;</span>: <span class="string">&#x27;value1&#x27;</span>&#125;,</span><br><span class="line">                     )</span><br><span class="line">    <span class="comment"># 也可以使用CookieJar（字典形式就是在此基础上封装）</span></span><br><span class="line">    <span class="keyword">from</span> http.cookiejar <span class="keyword">import</span> CookieJar</span><br><span class="line">    <span class="keyword">from</span> http.cookiejar importobj = CookieJar()</span><br><span class="line">    obj.set_cookie(Cookie(version=<span class="number">0</span>, name=<span class="string">&#x27;c1&#x27;</span>, value=<span class="string">&#x27;v1&#x27;</span>, port=<span class="literal">None</span>, domain=<span class="string">&#x27;&#x27;</span>, path=<span class="string">&#x27;/&#x27;</span>, secure=<span class="literal">False</span>, expires=<span class="literal">None</span>,</span><br><span class="line">                          discard=<span class="literal">True</span>, comment=<span class="literal">None</span>, comment_url=<span class="literal">None</span>, rest=&#123;<span class="string">&#x27;HttpOnly&#x27;</span>: <span class="literal">None</span>&#125;, rfc2109=<span class="literal">False</span>,</span><br><span class="line">                          port_specified=<span class="literal">False</span>, domain_specified=<span class="literal">False</span>, domain_initial_dot=<span class="literal">False</span>, path_specified=<span class="literal">False</span>)</span><br><span class="line">                   )=<span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                     url=<span class="string">&#x27;http://127.0.0.1:8000/test/&#x27;</span>,</span><br><span class="line">                     data=&#123;<span class="string">&#x27;k1&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>&#125;,</span><br><span class="line">                     cookies=obj)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_files</span>():</span><br><span class="line">    <span class="comment"># 发送文件</span></span><br><span class="line">    <span class="comment"># file_dict = &#123;</span></span><br><span class="line">    <span class="comment"># &#x27;f1&#x27;: open(&#x27;readme&#x27;, &#x27;rb&#x27;)</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;POST&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># files=file_dict)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送文件，定制文件名</span></span><br><span class="line">    <span class="comment"># file_dict = &#123;</span></span><br><span class="line">    <span class="comment"># &#x27;f1&#x27;: (&#x27;test.txt&#x27;, open(&#x27;readme&#x27;, &#x27;rb&#x27;))</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;POST&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># files=file_dict)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送文件，定制文件名</span></span><br><span class="line">    <span class="comment"># file_dict = &#123;</span></span><br><span class="line">    <span class="comment"># &#x27;f1&#x27;: (&#x27;test.txt&#x27;, &quot;hahsfaksfa9kasdjflaksdjf&quot;)</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;POST&#x27;,</span></span><br><span class="line">    <span class="comment"># url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment"># files=file_dict)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送文件，定制文件名</span></span><br><span class="line">    <span class="comment"># file_dict = &#123;</span></span><br><span class="line">    <span class="comment">#     &#x27;f1&#x27;: (&#x27;test.txt&#x27;, &quot;hahsfaksfa9kasdjflaksdjf&quot;, &#x27;application/text&#x27;, &#123;&#x27;k1&#x27;: &#x27;0&#x27;&#125;)</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">    <span class="comment"># requests.request(method=&#x27;POST&#x27;,</span></span><br><span class="line">    <span class="comment">#                  url=&#x27;http://127.0.0.1:8000/test/&#x27;,</span></span><br><span class="line">    <span class="comment">#                  files=file_dict)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_auth</span>():</span><br><span class="line">    <span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth, HTTPDigestAuth</span><br><span class="line"></span><br><span class="line">    ret = requests.get(<span class="string">&#x27;https://api.github.com/user&#x27;</span>, auth=HTTPBasicAuth(<span class="string">&#x27;wupeiqi&#x27;</span>, <span class="string">&#x27;sdfasdfasdf&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(ret.text)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ret = requests.get(&#x27;http://192.168.1.1&#x27;,</span></span><br><span class="line">    <span class="comment"># auth=HTTPBasicAuth(&#x27;admin&#x27;, &#x27;admin&#x27;))</span></span><br><span class="line">    <span class="comment"># ret.encoding = &#x27;gbk&#x27;</span></span><br><span class="line">    <span class="comment"># print(ret.text)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ret = requests.get(&#x27;http://httpbin.org/digest-auth/auth/user/pass&#x27;, auth=HTTPDigestAuth(&#x27;user&#x27;, &#x27;pass&#x27;))</span></span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_timeout</span>():</span><br><span class="line">    <span class="comment"># ret = requests.get(&#x27;http://google.com/&#x27;, timeout=1)</span></span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ret = requests.get(&#x27;http://google.com/&#x27;, timeout=(5, 1))</span></span><br><span class="line">    <span class="comment"># print(ret)</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_allow_redirects</span>():</span><br><span class="line">    ret = requests.get(<span class="string">&#x27;http://127.0.0.1:8000/test/&#x27;</span>, allow_redirects=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(ret.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_proxies</span>():</span><br><span class="line">    <span class="comment"># proxies = &#123;</span></span><br><span class="line">    <span class="comment"># &quot;http&quot;: &quot;61.172.249.96:80&quot;,</span></span><br><span class="line">    <span class="comment"># &quot;https&quot;: &quot;http://61.185.219.126:3128&quot;,</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">    <span class="comment"># proxies = &#123;&#x27;http://10.20.1.128&#x27;: &#x27;http://10.10.1.10:5323&#x27;&#125;</span></span><br><span class="line">    <span class="comment"># ret = requests.get(&quot;http://www.proxy360.cn/Proxy&quot;, proxies=proxies)</span></span><br><span class="line">    <span class="comment"># print(ret.headers)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># from requests.auth import HTTPProxyAuth</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># proxyDict = &#123;</span></span><br><span class="line">    <span class="comment"># &#x27;http&#x27;: &#x27;77.75.105.165&#x27;,</span></span><br><span class="line">    <span class="comment"># &#x27;https&#x27;: &#x27;77.75.105.165&#x27;</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">    <span class="comment"># auth = HTTPProxyAuth(&#x27;username&#x27;, &#x27;mypassword&#x27;)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># r = requests.get(&quot;http://www.google.com&quot;, proxies=proxyDict, auth=auth)</span></span><br><span class="line">    <span class="comment"># print(r.text)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">param_stream</span>():</span><br><span class="line">    ret = requests.get(<span class="string">&#x27;http://127.0.0.1:8000/test/&#x27;</span>, stream=<span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(ret.content)</span><br><span class="line">    ret.close()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># from contextlib import closing</span></span><br><span class="line">    <span class="comment"># with closing(requests.get(&#x27;http://httpbin.org/get&#x27;, stream=True)) as r:</span></span><br><span class="line">    <span class="comment"># # 在此处理响应。</span></span><br><span class="line">    <span class="comment"># for i in r.iter_content():</span></span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">requests_session</span>():</span><br><span class="line">    <span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">    session = requests.Session()</span><br><span class="line"></span><br><span class="line">    <span class="comment">### 1、首先登陆任何页面，获取cookie</span></span><br><span class="line"></span><br><span class="line">    i1 = session.get(url=<span class="string">&quot;http://dig.chouti.com/help/service&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">### 2、用户登陆，携带上一次的cookie，后台对cookie中的 gpsd 进行授权</span></span><br><span class="line">    i2 = session.post(</span><br><span class="line">        url=<span class="string">&quot;http://dig.chouti.com/login&quot;</span>,</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;phone&#x27;</span>: <span class="string">&quot;8615131255089&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&quot;xxxxxx&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;oneMonth&#x27;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">    i3 = session.post(</span><br><span class="line">        url=<span class="string">&quot;http://dig.chouti.com/link/vote?linksId=8589623&quot;</span>,</span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(i3.text)</span><br></pre></td></tr></table></figure>
<h4 id="json请求："><a href="#json请求：" class="headerlink" title="json请求："></a>json请求：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">url_request</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; init &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    heard = &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>&#125;</span><br><span class="line">    payload = &#123;<span class="string">&#x27;CountryName&#x27;</span>: <span class="string">&#x27;中国&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;ProvinceName&#x27;</span>: <span class="string">&#x27;四川省&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;L1CityName&#x27;</span>: <span class="string">&#x27;chengdu&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;L2CityName&#x27;</span>: <span class="string">&#x27;yibing&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;TownName&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;Longitude&#x27;</span>: <span class="string">&#x27;107.33393&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;Latitude&#x27;</span>: <span class="string">&#x27;33.157131&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;Language&#x27;</span>: <span class="string">&#x27;CN&#x27;</span>&#125;</span><br><span class="line">    r = requests.post(<span class="string">&quot;http://www.xxxxxx.com/CityLocation/json/LBSLocateCity&quot;</span>, heards=heard, data=payload)</span><br><span class="line">    data = r.json()</span><br><span class="line">    <span class="keyword">if</span> r.status_code!=<span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;LBSLocateCity API Error&#x27;</span> + <span class="built_in">str</span>(r.status_code))</span><br><span class="line">    <span class="built_in">print</span>(data[<span class="string">&#x27;CityEntities&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;CityID&#x27;</span>])  <span class="comment"># 打印返回json中的某个key的value</span></span><br><span class="line">    <span class="built_in">print</span>(data[<span class="string">&#x27;ResponseStatus&#x27;</span>][<span class="string">&#x27;Ack&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(json.dump(data, indent=<span class="number">4</span>, sort_keys=<span class="literal">True</span>, ensure_ascii=<span class="literal">False</span>))  <span class="comment"># 树形打印json，ensure_ascii必须设为False否则中文会显示为unicode</span></span><br></pre></td></tr></table></figure>
<h4 id="Xml请求："><a href="#Xml请求：" class="headerlink" title="Xml请求："></a>Xml请求：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">url_request</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;init&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    heards = &#123;<span class="string">&#x27;Content-type&#x27;</span>: <span class="string">&#x27;text/xml&#x27;</span>&#125;</span><br><span class="line">    XML = <span class="string">&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;&lt;soap:Body&gt;&lt;Request xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;jme&gt;&lt;JobClassFullName&gt;WeChatJSTicket.JobWS.Job.JobRefreshTicket,WeChatJSTicket.JobWS&lt;/JobClassFullName&gt;&lt;Action&gt;RUN&lt;/Action&gt;&lt;Param&gt;1&lt;/Param&gt;&lt;HostIP&gt;127.0.0.1&lt;/HostIP&gt;&lt;JobInfo&gt;1&lt;/JobInfo&gt;&lt;NeedParallel&gt;false&lt;/NeedParallel&gt;&lt;/jme&gt;&lt;/Request&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;&#x27;</span></span><br><span class="line">    url = <span class="string">&#x27;http://jobws.push.mobile.xxxxxxxx.com/RefreshWeiXInTokenJob/RefreshService.asmx&#x27;</span></span><br><span class="line">    r = requests.post(url=url, heards=heards, data=XML)</span><br><span class="line">    data = r.text</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>
<h4 id="状态异常处理"><a href="#状态异常处理" class="headerlink" title="状态异常处理"></a>状态异常处理</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">URL = <span class="string">&#x27;http://ip.taobao.com/service/getIpInfo.php&#x27;</span>  <span class="comment"># 淘宝IP地址库API</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = requests.get(URL, params=&#123;<span class="string">&#x27;ip&#x27;</span>: <span class="string">&#x27;8.8.8.8&#x27;</span>&#125;, timeout=<span class="number">1</span>)</span><br><span class="line">    r.raise_for_status()  <span class="comment"># 如果响应状态码不是 200，就主动抛出异常</span></span><br><span class="line"><span class="keyword">except</span> requests.RequestException <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(e)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    result = r.json()</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(result), result, sep=<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="上传文件："><a href="#上传文件：" class="headerlink" title="上传文件："></a>上传文件：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1:8080/upload&#x27;</span></span><br><span class="line">files = &#123;<span class="string">&#x27;file&#x27;</span>: <span class="built_in">open</span>(<span class="string">&#x27;/home/rxf/test.jpg&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)&#125;</span><br><span class="line"><span class="comment">#files = &#123;&#x27;file&#x27;: (&#x27;report.jpg&#x27;, open(&#x27;/home/lyb/sjzl.mpg&#x27;, &#x27;rb&#x27;))&#125;     #显式的设置文件名</span></span><br><span class="line"> </span><br><span class="line">r = requests.post(url, files=files)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>
<p><strong>request更加方便的是，可以把字符串当作文件进行上传：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1:8080/upload&#x27;</span></span><br><span class="line">files = &#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">b&#x27;Hello Requests.&#x27;</span>)&#125;     <span class="comment">#必需显式的设置文件名</span></span><br><span class="line"> </span><br><span class="line">r = requests.post(url, files=files)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>
<h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><p>用md5进行加密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">imooc = <span class="string">&quot;imooc.com&quot;</span></span><br><span class="line"><span class="comment"># header 加密</span></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">data = <span class="built_in">str</span>(&#123;</span><br><span class="line">    <span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;11111&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line">md5.update(data.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">res1 = md5.hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解析:&quot;</span>,res1)</span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;m.imooc.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Pragma&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json, text/javascript, */*; q=0.01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;X-Requested-With&#x27;</span>: <span class="string">&#x27;XMLHttpRequest&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://m.imooc.com/&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;token&#x27;</span>: res1</span><br><span class="line">&#125;</span><br><span class="line">url = <span class="string">&#x27;https://m.imooc.com/api/search/searchword&#x27;</span></span><br><span class="line">response = requests.get(url, headers=header, verify=<span class="literal">False</span>)  <span class="comment"># 请尽量避免禁用 SSL 验证</span></span><br><span class="line"><span class="built_in">print</span>(response)  <span class="comment"># 输出响应文本</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    json_response = response.json()</span><br><span class="line">    <span class="built_in">print</span>(json.dumps(json_response, indent=<span class="number">4</span>, ensure_ascii=<span class="literal">False</span>))</span><br><span class="line"><span class="keyword">except</span> json.decoder.JSONDecodeError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;JSON 解码错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="身份验证："><a href="#身份验证：" class="headerlink" title="身份验证："></a>身份验证：</h4><p>基本身份认证(HTTP Basic Auth)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth</span><br><span class="line"> </span><br><span class="line">r = requests.get(<span class="string">&#x27;https://httpbin.org/hidden-basic-auth/user/passwd&#x27;</span>, auth=HTTPBasicAuth(<span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;passwd&#x27;</span>))</span><br><span class="line"><span class="comment"># r = requests.get(&#x27;https://httpbin.org/hidden-basic-auth/user/passwd&#x27;, auth=(&#x27;user&#x27;, &#x27;passwd&#x27;))    # 简写</span></span><br><span class="line"><span class="built_in">print</span>(r.json())</span><br></pre></td></tr></table></figure>
<p>另一种非常流行的HTTP身份认证形式是摘要式身份认证，Requests对它的支持也是开箱即可用的:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requests.get(URL, auth=HTTPDigestAuth(<span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;pass&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>Cookies与会话对象：</strong></p>
<p>如果某个响应中包含一些Cookie，你可以快速访问它们：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line">r = requests.get(<span class="string">&#x27;http://www.google.com.hk/&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.cookies[<span class="string">&#x27;NID&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">tuple</span>(r.cookies))</span><br></pre></td></tr></table></figure>
<p>要想发送你的cookies到服务器，可以使用 cookies 参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line">url = <span class="string">&#x27;http://httpbin.org/cookies&#x27;</span></span><br><span class="line">cookies = &#123;<span class="string">&#x27;testCookies_1&#x27;</span>: <span class="string">&#x27;Hello_Python3&#x27;</span>, <span class="string">&#x27;testCookies_2&#x27;</span>: <span class="string">&#x27;Hello_Requests&#x27;</span>&#125;</span><br><span class="line"><span class="comment"># 在Cookie Version 0中规定空格、方括号、圆括号、等于号、逗号、双引号、斜杠、问号、@，冒号，分号等特殊符号都不能作为Cookie的内容。</span></span><br><span class="line">r = requests.get(url, cookies=cookies)</span><br><span class="line"><span class="built_in">print</span>(r.json())</span><br></pre></td></tr></table></figure>
<p>会话对象让你能够跨请求保持某些参数，最方便的是在同一个Session实例发出的所有请求之间保持cookies，且这些都是自动处理的，甚是方便。<br>下面就来一个真正的实例，如下是快盘签到脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line">headers = &#123;<span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate, compress&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;en-us;q=0.5,en;q=0.3&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;max-age=0&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:22.0) Gecko/20100101 Firefox/22.0&#x27;</span>&#125;</span><br><span class="line"> </span><br><span class="line">s = requests.Session()</span><br><span class="line">s.headers.update(headers)</span><br><span class="line"><span class="comment"># s.auth = (&#x27;superuser&#x27;, &#x27;123&#x27;)</span></span><br><span class="line">s.get(<span class="string">&#x27;https://www.kuaipan.cn/account_login.htm&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">_URL = <span class="string">&#x27;http://www.kuaipan.cn/index.php&#x27;</span></span><br><span class="line">s.post(_URL, params=&#123;<span class="string">&#x27;ac&#x27;</span>:<span class="string">&#x27;account&#x27;</span>, <span class="string">&#x27;op&#x27;</span>:<span class="string">&#x27;login&#x27;</span>&#125;,</span><br><span class="line">       data=&#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;****@foxmail.com&#x27;</span>, <span class="string">&#x27;userpwd&#x27;</span>:<span class="string">&#x27;********&#x27;</span>, <span class="string">&#x27;isajax&#x27;</span>:<span class="string">&#x27;yes&#x27;</span>&#125;)</span><br><span class="line">r = s.get(_URL, params=&#123;<span class="string">&#x27;ac&#x27;</span>:<span class="string">&#x27;zone&#x27;</span>, <span class="string">&#x27;op&#x27;</span>:<span class="string">&#x27;taskdetail&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(r.json())</span><br><span class="line">s.get(_URL, params=&#123;<span class="string">&#x27;ac&#x27;</span>:<span class="string">&#x27;common&#x27;</span>, <span class="string">&#x27;op&#x27;</span>:<span class="string">&#x27;usersign&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>requests模块抓取网页源码并保存到文件示例：</strong></p>
<p>这是一个基本的文件保存操作，但这里有几个值得注意的问题：</p>
<p>1.安装requests包，命令行输入pip install requests即可自动安装。很多人推荐使用requests，自带的urllib.request也可以抓取网页源码</p>
<p>2.open方法encoding参数设为utf-8，否则保存的文件会出现乱码。</p>
<p>3.如果直接在cmd中输出抓取的内容，会提示各种编码错误，所以保存到文件查看。</p>
<p>4.with open方法是更好的写法，可以自动操作完毕后释放资源</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /urs/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;requests模块抓取网页源码并保存到文件示例&#x27;&#x27;&#x27;</span></span><br><span class="line">html = requests.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(html.text)</span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;读取一个txt文件，每次读取一行，并保存到另一个txt文件中的示例&#x27;&#x27;&#x27;</span></span><br><span class="line">ff = <span class="built_in">open</span>(<span class="string">&#x27;testt.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test.txt&#x27;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        ff.write(line)</span><br><span class="line">        ff.close()</span><br></pre></td></tr></table></figure>
<p>因为在命令行中打印每次读取一行的数据，中文会出现编码错误，所以每次读取一行并保存到另一个文件，这样来测试读取是否正常。（注意open的时候制定encoding编码方式）</p>
<h4 id="自动登陆"><a href="#自动登陆" class="headerlink" title="自动登陆"></a>自动登陆</h4><p><strong>抽屉新热榜：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># ############## 方式一 ##############</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># ## 1、首先登陆任何页面，获取cookie</span></span><br><span class="line"><span class="string">i1 = requests.get(url=&quot;http://dig.chouti.com/help/service&quot;)</span></span><br><span class="line"><span class="string">i1_cookies = i1.cookies.get_dict()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># ## 2、用户登陆，携带上一次的cookie，后台对cookie中的 gpsd 进行授权</span></span><br><span class="line"><span class="string">i2 = requests.post(</span></span><br><span class="line"><span class="string">    url=&quot;http://dig.chouti.com/login&quot;,</span></span><br><span class="line"><span class="string">    data=&#123;</span></span><br><span class="line"><span class="string">        &#x27;phone&#x27;: &quot;8615131255089&quot;,</span></span><br><span class="line"><span class="string">        &#x27;password&#x27;: &quot;xxooxxoo&quot;,</span></span><br><span class="line"><span class="string">        &#x27;oneMonth&#x27;: &quot;&quot;</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    cookies=i1_cookies</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># ## 3、点赞（只需要携带已经被授权的gpsd即可）</span></span><br><span class="line"><span class="string">gpsd = i1_cookies[&#x27;gpsd&#x27;]</span></span><br><span class="line"><span class="string">i3 = requests.post(</span></span><br><span class="line"><span class="string">    url=&quot;http://dig.chouti.com/link/vote?linksId=8589523&quot;,</span></span><br><span class="line"><span class="string">    cookies=&#123;&#x27;gpsd&#x27;: gpsd&#125;</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(i3.text)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># ############## 方式二 ##############</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">import requests</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">session = requests.Session()</span></span><br><span class="line"><span class="string">i1 = session.get(url=&quot;http://dig.chouti.com/help/service&quot;)</span></span><br><span class="line"><span class="string">i2 = session.post(</span></span><br><span class="line"><span class="string">    url=&quot;http://dig.chouti.com/login&quot;,</span></span><br><span class="line"><span class="string">    data=&#123;</span></span><br><span class="line"><span class="string">        &#x27;phone&#x27;: &quot;8615131255089&quot;,</span></span><br><span class="line"><span class="string">        &#x27;password&#x27;: &quot;xxooxxoo&quot;,</span></span><br><span class="line"><span class="string">        &#x27;oneMonth&#x27;: &quot;&quot;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">i3 = session.post(</span></span><br><span class="line"><span class="string">    url=&quot;http://dig.chouti.com/link/vote?linksId=8589523&quot;</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">print(i3.text)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>github：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="comment"># ############## 方式一 ##############</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 1. 访问登陆页面，获取 authenticity_token</span></span><br><span class="line"><span class="comment"># i1 = requests.get(&#x27;https://github.com/login&#x27;)</span></span><br><span class="line"><span class="comment"># soup1 = BeautifulSoup(i1.text, features=&#x27;lxml&#x27;)</span></span><br><span class="line"><span class="comment"># tag = soup1.find(name=&#x27;input&#x27;, attrs=&#123;&#x27;name&#x27;: &#x27;authenticity_token&#x27;&#125;)</span></span><br><span class="line"><span class="comment"># authenticity_token = tag.get(&#x27;value&#x27;)</span></span><br><span class="line"><span class="comment"># c1 = i1.cookies.get_dict()</span></span><br><span class="line"><span class="comment"># i1.close()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 1. 携带authenticity_token和用户名密码等信息，发送用户验证</span></span><br><span class="line"><span class="comment"># form_data = &#123;</span></span><br><span class="line"><span class="comment"># &quot;authenticity_token&quot;: authenticity_token,</span></span><br><span class="line"><span class="comment">#     &quot;utf8&quot;: &quot;&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;commit&quot;: &quot;Sign in&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;login&quot;: &quot;wupeiqi@live.com&quot;,</span></span><br><span class="line"><span class="comment">#     &#x27;password&#x27;: &#x27;xxoo&#x27;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># i2 = requests.post(&#x27;https://github.com/session&#x27;, data=form_data, cookies=c1)</span></span><br><span class="line"><span class="comment"># c2 = i2.cookies.get_dict()</span></span><br><span class="line"><span class="comment"># c1.update(c2)</span></span><br><span class="line"><span class="comment"># i3 = requests.get(&#x27;https://github.com/settings/repositories&#x27;, cookies=c1)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># soup3 = BeautifulSoup(i3.text, features=&#x27;lxml&#x27;)</span></span><br><span class="line"><span class="comment"># list_group = soup3.find(name=&#x27;div&#x27;, class_=&#x27;listgroup&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># from bs4.element import Tag</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># for child in list_group.children:</span></span><br><span class="line"><span class="comment">#     if isinstance(child, Tag):</span></span><br><span class="line"><span class="comment">#         project_tag = child.find(name=&#x27;a&#x27;, class_=&#x27;mr-1&#x27;)</span></span><br><span class="line"><span class="comment">#         size_tag = child.find(name=&#x27;small&#x27;)</span></span><br><span class="line"><span class="comment">#         temp = &quot;项目:%s(%s); 项目路径:%s&quot; % (project_tag.get(&#x27;href&#x27;), size_tag.string, project_tag.string, )</span></span><br><span class="line"><span class="comment">#         print(temp)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ############## 方式二 ##############</span></span><br><span class="line"><span class="comment"># session = requests.Session()</span></span><br><span class="line"><span class="comment"># # 1. 访问登陆页面，获取 authenticity_token</span></span><br><span class="line"><span class="comment"># i1 = session.get(&#x27;https://github.com/login&#x27;)</span></span><br><span class="line"><span class="comment"># soup1 = BeautifulSoup(i1.text, features=&#x27;lxml&#x27;)</span></span><br><span class="line"><span class="comment"># tag = soup1.find(name=&#x27;input&#x27;, attrs=&#123;&#x27;name&#x27;: &#x27;authenticity_token&#x27;&#125;)</span></span><br><span class="line"><span class="comment"># authenticity_token = tag.get(&#x27;value&#x27;)</span></span><br><span class="line"><span class="comment"># c1 = i1.cookies.get_dict()</span></span><br><span class="line"><span class="comment"># i1.close()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 1. 携带authenticity_token和用户名密码等信息，发送用户验证</span></span><br><span class="line"><span class="comment"># form_data = &#123;</span></span><br><span class="line"><span class="comment">#     &quot;authenticity_token&quot;: authenticity_token,</span></span><br><span class="line"><span class="comment">#     &quot;utf8&quot;: &quot;&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;commit&quot;: &quot;Sign in&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;login&quot;: &quot;wupeiqi@live.com&quot;,</span></span><br><span class="line"><span class="comment">#     &#x27;password&#x27;: &#x27;xxoo&#x27;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># i2 = session.post(&#x27;https://github.com/session&#x27;, data=form_data)</span></span><br><span class="line"><span class="comment"># c2 = i2.cookies.get_dict()</span></span><br><span class="line"><span class="comment"># c1.update(c2)</span></span><br><span class="line"><span class="comment"># i3 = session.get(&#x27;https://github.com/settings/repositories&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># soup3 = BeautifulSoup(i3.text, features=&#x27;lxml&#x27;)</span></span><br><span class="line"><span class="comment"># list_group = soup3.find(name=&#x27;div&#x27;, class_=&#x27;listgroup&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># from bs4.element import Tag</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># for child in list_group.children:</span></span><br><span class="line"><span class="comment">#     if isinstance(child, Tag):</span></span><br><span class="line"><span class="comment">#         project_tag = child.find(name=&#x27;a&#x27;, class_=&#x27;mr-1&#x27;)</span></span><br><span class="line"><span class="comment">#         size_tag = child.find(name=&#x27;small&#x27;)</span></span><br><span class="line"><span class="comment">#         temp = &quot;项目:%s(%s); 项目路径:%s&quot; % (project_tag.get(&#x27;href&#x27;), size_tag.string, project_tag.string, )</span></span><br><span class="line"><span class="comment">#         print(temp)</span></span><br></pre></td></tr></table></figure>
<p><strong>知乎：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line"></span><br><span class="line">i1 = session.get(</span><br><span class="line">    url=<span class="string">&#x27;https://www.zhihu.com/#signin&#x27;</span>,</span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.98 Safari/537.36&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">soup1 = BeautifulSoup(i1.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">xsrf_tag = soup1.find(name=<span class="string">&#x27;input&#x27;</span>, attrs=&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;_xsrf&#x27;</span>&#125;)</span><br><span class="line">xsrf = xsrf_tag.get(<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line"></span><br><span class="line">current_time = time.time()</span><br><span class="line">i2 = session.get(</span><br><span class="line">    url=<span class="string">&#x27;https://www.zhihu.com/captcha.gif&#x27;</span>,</span><br><span class="line">    params=&#123;<span class="string">&#x27;r&#x27;</span>: current_time, <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;login&#x27;</span>&#125;,</span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.98 Safari/537.36&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;zhihu.gif&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(i2.content)</span><br><span class="line"></span><br><span class="line">captcha = <span class="built_in">input</span>(<span class="string">&#x27;请打开zhihu.gif文件，查看并输入验证码：&#x27;</span>)</span><br><span class="line">form_data = &#123;</span><br><span class="line">    <span class="string">&quot;_xsrf&quot;</span>: xsrf,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;xxooxxoo&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;captcha&quot;</span>: <span class="string">&#x27;captcha&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;email&#x27;</span>: <span class="string">&#x27;424662508@qq.com&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">i3 = session.post(</span><br><span class="line">    url=<span class="string">&#x27;https://www.zhihu.com/login/email&#x27;</span>,</span><br><span class="line">    data=form_data,</span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.98 Safari/537.36&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">i4 = session.get(</span><br><span class="line">    url=<span class="string">&#x27;https://www.zhihu.com/settings/profile&#x27;</span>,</span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.98 Safari/537.36&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">soup4 = BeautifulSoup(i4.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">tag = soup4.find(<span class="built_in">id</span>=<span class="string">&#x27;rename-section&#x27;</span>)</span><br><span class="line">nick_name = tag.find(<span class="string">&#x27;span&#x27;</span>,class_=<span class="string">&#x27;name&#x27;</span>).string</span><br><span class="line"><span class="built_in">print</span>(nick_name)</span><br></pre></td></tr></table></figure>
<p><strong>博客园：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">js_encrypt</span>(<span class="params">text</span>):</span><br><span class="line">    b64der = <span class="string">&#x27;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCp0wHYbg/NOPO3nzMD3dndwS0MccuMeXCHgVlGOoYyFwLdS24Im2e7YyhB0wrUsyYf0/nhzCzBK8ZC9eCWqd0aHbdgOQT6CuFQBMjbyGYvlVYU2ZP7kG9Ft6YV6oc9ambuO7nPZh+bvXH0zDKfi02prknrScAKC0XhadTHT3Al0QIDAQAB&#x27;</span></span><br><span class="line">    der = base64.standard_b64decode(b64der)</span><br><span class="line"></span><br><span class="line">    pk = rsa.PublicKey.load_pkcs1_openssl_der(der)</span><br><span class="line">    v1 = rsa.encrypt(<span class="built_in">bytes</span>(text, <span class="string">&#x27;utf8&#x27;</span>), pk)</span><br><span class="line">    value = base64.encodebytes(v1).replace(<span class="string">b&#x27;\n&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">    value = value.decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line"></span><br><span class="line">i1 = session.get(<span class="string">&#x27;https://passport.s.com/user/signin&#x27;</span>)</span><br><span class="line">rep = re.<span class="built_in">compile</span>(<span class="string">&quot;&#x27;VerificationToken&#x27;: &#x27;(.*)&#x27;&quot;</span>)</span><br><span class="line">v = re.search(rep, i1.text)</span><br><span class="line">verification_token = v.group(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">form_data = &#123;</span><br><span class="line">    <span class="string">&#x27;input1&#x27;</span>: js_encrypt(<span class="string">&#x27;wptawy&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;input2&#x27;</span>: js_encrypt(<span class="string">&#x27;asdfasdf&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;remember&#x27;</span>: <span class="literal">False</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">i2 = session.post(url=<span class="string">&#x27;https://passport.s.com/user/signin&#x27;</span>,</span><br><span class="line">                  data=json.dumps(form_data),</span><br><span class="line">                  headers=&#123;</span><br><span class="line">                      <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json; charset=UTF-8&#x27;</span>,</span><br><span class="line">                      <span class="string">&#x27;X-Requested-With&#x27;</span>: <span class="string">&#x27;XMLHttpRequest&#x27;</span>,</span><br><span class="line">                      <span class="string">&#x27;VerificationToken&#x27;</span>: verification_token&#125;</span><br><span class="line">                  )</span><br><span class="line"></span><br><span class="line">i3 = session.get(url=<span class="string">&#x27;https://i.s.com/EditDiary.aspx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(i3.text)</span><br></pre></td></tr></table></figure>
<p><strong>拉勾网：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一步：访问登陆页,拿到X_Anti_Forge_Token，X_Anti_Forge_Code</span></span><br><span class="line"><span class="comment"># 1、请求url:https://passport.lagou.com/login/login.html</span></span><br><span class="line"><span class="comment"># 2、请求方法:GET</span></span><br><span class="line"><span class="comment"># 3、请求头:</span></span><br><span class="line"><span class="comment">#    User-agent</span></span><br><span class="line">r1 = requests.get(<span class="string">&#x27;https://passport.lagou.com/login/login.html&#x27;</span>,</span><br><span class="line">                 headers=&#123;</span><br><span class="line">                     <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36&#x27;</span>,</span><br><span class="line">                 &#125;,</span><br><span class="line">                 )</span><br><span class="line"></span><br><span class="line">X_Anti_Forge_Token = re.findall(<span class="string">&quot;X_Anti_Forge_Token = &#x27;(.*?)&#x27;&quot;</span>, r1.text, re.S)[<span class="number">0</span>]</span><br><span class="line">X_Anti_Forge_Code = re.findall(<span class="string">&quot;X_Anti_Forge_Code = &#x27;(.*?)&#x27;&quot;</span>, r1.text, re.S)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(X_Anti_Forge_Token, X_Anti_Forge_Code)</span><br><span class="line"><span class="comment"># print(r1.cookies.get_dict())</span></span><br><span class="line"><span class="comment"># 第二步：登陆</span></span><br><span class="line"><span class="comment"># 1、请求url:https://passport.lagou.com/login/login.json</span></span><br><span class="line"><span class="comment"># 2、请求方法:POST</span></span><br><span class="line"><span class="comment"># 3、请求头:</span></span><br><span class="line"><span class="comment">#    cookie</span></span><br><span class="line"><span class="comment">#    User-agent</span></span><br><span class="line"><span class="comment">#    Referer:https://passport.lagou.com/login/login.html</span></span><br><span class="line"><span class="comment">#    X-Anit-Forge-Code:53165984</span></span><br><span class="line"><span class="comment">#    X-Anit-Forge-Token:3b6a2f62-80f0-428b-8efb-ef72fc100d78</span></span><br><span class="line"><span class="comment">#    X-Requested-With:XMLHttpRequest</span></span><br><span class="line"><span class="comment"># 4、请求体：</span></span><br><span class="line"><span class="comment"># isValidate:true</span></span><br><span class="line"><span class="comment"># username:15131252215</span></span><br><span class="line"><span class="comment"># password:ab18d270d7126ea65915c50288c22c0d</span></span><br><span class="line"><span class="comment"># request_form_verifyCode:&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># submit:&#x27;&#x27;</span></span><br><span class="line">r2 = requests.post(</span><br><span class="line">    <span class="string">&#x27;https://passport.lagou.com/login/login.json&#x27;</span>,</span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://passport.lagou.com/login/login.html&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;X-Anit-Forge-Code&#x27;</span>: X_Anti_Forge_Code,</span><br><span class="line">        <span class="string">&#x27;X-Anit-Forge-Token&#x27;</span>: X_Anti_Forge_Token,</span><br><span class="line">        <span class="string">&#x27;X-Requested-With&#x27;</span>: <span class="string">&#x27;XMLHttpRequest&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="string">&quot;isValidate&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;15131255089&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;ab18d270d7126ea65915c50288c22c0d&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;request_form_verifyCode&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;submit&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    cookies=r1.cookies.get_dict()</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(r2.text)</span><br></pre></td></tr></table></figure>
<h2 id="Flask"><a href="#Flask" class="headerlink" title="Flask"></a>Flask</h2><p>Flask是一个轻量级的Web应用框架，基于Python编写，其核心思想是保持简洁，灵活性和易于扩展。Flask提供了基本的Web开发工具和应用程序的结构，但同时也允许开发者自由选择其他库和工具来扩展其功能。Flask的设计目标是使开发者能够快速构建具有基本功能的Web应用程序。在日常生活中我们需要将模型打包为api接口，这里需要借助一些web框架，最常用的就是flask框架。</p>
<p>作为测试人员，在工作或者学习的过程中，有时会遇到没有可以调用的现成的接口，导致我们的代码没法调试跑通的情况。</p>
<p>这时，我们使用python中的web框架<code>Flask</code>就可以很方便的编写简单的接口，用于调用或调试。在之前的<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lfr0123/tag/pytest/">pytest系列文章</a>中，已经使用过Flask编写接口用于代码调试。相比于python的另一个web框架Django，Flask编写接口要方便简单很多。</p>
<p><strong>下面是一些Flask框架的主要特点：</strong></p>
<ul>
<li>轻量级：Flask是一个轻量级的框架，其代码库非常小，并且不需要依赖大量的外部库和工具，因此可以轻松地安装和部署。</li>
<li>灵活性：Flask允许开发者自由选择其他库和工具来扩展其功能，这使得开发者可以根据自己的需求进行灵活的配置。</li>
<li>易于扩展：Flask提供了简单易用的扩展接口，开发者可以使用这些接口来添加新功能或定制框架的行为。</li>
<li>Web服务器支持：Flask支持多种Web服务器，如内置的开发服务器、Gunicorn和uWSGI等。</li>
<li>RESTful支持：Flask提供了内置的RESTful路由，使得开发RESTful API变得非常容易。</li>
<li>Jinja2模板引擎：Flask集成了Jinja2模板引擎，开发者可以使用模板来构建灵活的Web应用程序。</li>
<li>Flask-WTF表单：Flask提供了Flask-WTF扩展，使得表单处理变得简单而直观。</li>
<li>内置的调试器：Flask提供了内置的调试器，使得开发者可以轻松地调试和排除错误。</li>
<li>序列化与反序列化：Flask提供了内置的序列化和反序列化功能，使得开发RESTful API变得更加容易。</li>
</ul>
<p><em>总的来说，Flask是一个非常适合快速构建小型Web应用程序的框架。它提供了基本的Web开发工具和应用程序的结构，同时也支持灵活的扩展和定制。如果您需要快速构建一个小型的Web应用程序，Flask是一个非常好的选择。</em></p>
<p><strong>安装</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install flask</span><br><span class="line">验证是否安装成功或查看版本命令：pip show flask</span><br></pre></td></tr></table></figure>
<h3 id="get请求"><a href="#get请求" class="headerlink" title="get请求"></a>get请求</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Home</span>():</span><br><span class="line">    data = json.dumps(&#123;</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;Hello World&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/passport/user/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Login</span>():</span><br><span class="line">    username = request.args.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">    password = request.args.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> username <span class="keyword">and</span> password:</span><br><span class="line">        data = json.dumps(&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: password,</span><br><span class="line">            <span class="string">&#x27;code&#x27;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span>:<span class="string">&#x27;Hello World!&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;info&#x27;</span>:<span class="string">&#x27;www.baidu.com&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = json.dumps(&#123;</span><br><span class="line">            <span class="string">&quot;message&quot;</span>:<span class="string">&quot;username or password ???&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>
<h3 id="post请求"><a href="#post请求" class="headerlink" title="post请求"></a>post请求</h3><p>以下是使用 Flask 框架封装接口的示例代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># methods: 指定请求方式</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/process&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_data</span>():</span><br><span class="line">	<span class="comment"># 请求方式为post时，可以使用 request.get_json()接收到JSON数据</span></span><br><span class="line">    data = request.get_json()  <span class="comment"># 获取 POST 请求中的 JSON 数据</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 处理数据</span></span><br><span class="line">    <span class="comment"># 调用do_something_with_data函数来处理接收到的数据。</span></span><br><span class="line">    processed_data = do_something_with_data(data)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求方得到处理后的数据</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(processed_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>
<p><strong>代码改进</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加异常检测代码</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># methods: 指定请求方式</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/process&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_data</span>():</span><br><span class="line">	<span class="comment"># 请求方式为post时，可以使用 request.get_json()接收到JSON数据</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = request.get_json()</span><br><span class="line">        <span class="comment"># 如果得到的data是字符串格式，则需要用json.loads来变换成python格式，看个人需求</span></span><br><span class="line">        <span class="comment"># data = json.loads(data)</span></span><br><span class="line">        <span class="built_in">print</span>(data)<span class="comment"># 获取 POST 请求中的 JSON 数据</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;请求数据失败&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 处理数据</span></span><br><span class="line">    <span class="comment"># 调用do_something_with_data函数来处理接收到的数据。</span></span><br><span class="line">    <span class="comment"># 判断是否接收到数据</span></span><br><span class="line">	<span class="keyword">if</span> data:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            processed_data= do_something_with_data(data)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;处理数据失败&#x27;</span>&#125;), <span class="number">666</span></span><br><span class="line">    <span class="comment"># 返回的数据格式看请求方的要求了，也有可能需要json处理后的数据，即jsonify(processed_data)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(processed_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>
<p><strong>实例：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Home</span>():</span><br><span class="line">    data = json.dumps(&#123;</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;Hello World&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Hello World!&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;info&#x27;</span>: <span class="string">&#x27;www.baidu.com&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/passport/user/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Login</span>():</span><br><span class="line">    request_method = request.method</span><br><span class="line">    <span class="keyword">if</span> request_method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        username = request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password = request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        data = json.dumps(&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: password,</span><br><span class="line">            <span class="string">&#x27;code&#x27;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span>:<span class="string">&#x27;Hello World!&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;info&#x27;</span>:<span class="string">&#x27;www.baidu.com&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = json.dumps(&#123;</span><br><span class="line">            <span class="string">&quot;message&quot;</span>:<span class="string">&quot;username or password ???&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>
<h2 id="Mock"><a href="#Mock" class="headerlink" title="Mock"></a>Mock</h2><h3 id="Moco框架"><a href="#Moco框架" class="headerlink" title="Moco框架"></a>Moco框架</h3><p>Moco框架是Mock概念中的一种实现。<br>Moco框架是一个简单搭建模拟服务器的程序库/工具，这个基于 Java 开发的开源项目。<br>Moco框架已经在 Github 上获得了不少的关注，该项目的简介是这样描述自己的：</p>
<ul>
<li>Moco 是一个简单搭建 stub 的框架，主要用于测试和集成。</li>
<li>这个框架的开发灵感来自 Mock 框架，如 <code>Mockito</code>和 <code>Playframework</code>。</li>
</ul>
<p>为什么要开发这个框架？</p>
<ul>
<li>用于基于HTTP协议的集成：<code>web service</code>、<code>REST</code>等，在我们的项目开发中被广泛应用。</li>
<li>以前，我们每次都要往<code>Jetty</code>或<code>Tomcat</code>等应用服务器上部署一个新的 WAR。</li>
<li>大家都知道，开发部署一个 WAR 的过程是很枯燥的，即使在嵌入式服务器上也是如此。而且，每次我们做一点改动，整个 WAR 都要重新组装。</li>
<li>Moco框架的出现，正是为了解决这些问题。开发团队只要根据自己的需要进行相应的配置，就会很方便得到一个模拟服务器。</li>
<li>而且，由于 Moco框架本身的灵活性，其用途已经不再局限于最初的集成测试。<br>比如：<br>Moco 可以用于移动开发；<br>模拟尚未开发的服务；<br>Moco 还可以用于前端开发，模拟一个完整的 Web 服务器等等。</li>
</ul>
<p><strong>作用</strong></p>
<p>一般接口文档编写完成后，测试人员需要提前进行接口测试用例的编写，而这时接口开发工作可能还没完成。<br>如果要等到开发人员完成接口的开发，再进行测试用例的编写，这样会降低测试开发的效率。<br>这时如果测试人员使用Moco框架搭建一个模拟服务器，就可以根据接口文档，自己模拟出接口的调用并返回结果。<br>在用例设计完成后，即使接口开发工作还未完成，也可以立即进行接口测试用例的执行。并且在这个过程中可以修改、补充测试用例。<br>在接口开发完成以后，只需要简单的切换服务器地址，就可以测试所有的开发人员实现的接口了。这样可以节省很多的测试时间，减少项目开发的周期。<br>Moco框架支持HTTP协议，采用热部署，修改配置后，立刻生效，无需重启服务。<br>Moco框架接口测试中的作用：方法隔离，服务解耦。即可并行又可驱动。</p>
<p>Moco框架的启动</p>
<ol>
<li>条件：<br>因为Moco框架工具是一个jar包，所以需要Java环境才能启动。<br>即：配置好Java环境。</li>
<li>启动：<br>把Moco框架Jar包和Json文件放入同一个文件夹中，<br>命令行终端里进入到Json文件所在的目录，执行启用命令，如下：<br><code>java -jar ./moco-runner-0.11.0-standalone.jar http -p 12306 -c foo.json</code>即可。<br>说明：<br><code>./moco-runner-0.11.0-standalone.jar</code>为Moco工具所在目录。<br><code>http</code>：表示服务器协议，<code>server type: http, https, socket</code> 。<br><code>-p</code>：表示端口号。<br><code>-c</code>：表示一个json文件。接口所有的信息都配置在该json文件中。</li>
</ol>
<p>提示：Moco工具路径和json文件路径都可以写相对路径和绝对路径。</p>
<p>当需要调用接口来编写测试用例的时候，此时该接口并没有被实现，这个时候我们就可以用Mock框架来模拟一个接口出来。<br>使用Mock模拟接口以下功能：</p>
<ul>
<li>拦截服务：<code>http</code>，<code>https</code>。</li>
<li>请求方式：GET，POST。</li>
<li>模拟请求地址：URL。</li>
<li>模拟参数：包括<code>header</code>和<code>cookie</code>的数据。</li>
<li>模拟响应结果。</li>
<li>支持重定向。</li>
</ul>
<p><strong>Json文件的配置属性说明：</strong><br>像我们上面练习过的Json文件配置，所有的数据值是固定的，<br>如：<code>description</code>、<code>request</code>、<code>response</code>、<code>redirectTo</code>等这些都是固定的，不能修改，修改可能连Moco服务都启动不来。<br>还有<code>request</code>的属性值，如：<code>uri</code>、<code>method</code>、<code>cookies</code>、<code>headers</code>，也是必须这样写的。<br>还有GET请求传递参数用<code>queries</code>属性，POST请求传递参数用<code>forms</code>和<code>json</code>属性都可以。（PUT,DELETE请求同Post请求。）<br><strong>Moco框架原理：</strong><br>就是把所有接口的数据，包括发送请求的所有数据和返回结果的所有数据，以Json数据格式进行编写。<br>把这些数据放入Moco框架提供的HTTP或者HTTPS的服务上，就实现了接口数据的模拟。<br>在使用的时候，我们只要按照json文件中接口配置的信息进行请求即可，如果调用接口传递的数据和Json文件中接口编写要接收的数据不一致，则无法请求成功。</p>
<p>（1）Moco框架第一个练习<br>编写一个Json文件，接口所有的信息都配置在该json文件中。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;第一个Moco框架例子。&quot;</span>,  <span class="comment"># 描述：增加接口的可读性</span></span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/demo&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello Moco ！&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]    </span><br></pre></td></tr></table></figure>
<p>在cmd命令行或者PyCharm的命令行终端执行启动命令。</p>
<ul>
<li>进入json文件的所在目录。</li>
<li>执行命令：<code>java -jar ./moco-runner-0.12.0-standalone.jar http -p 12306 -c test.json</code></li>
</ul>
<p>Moco服务启动后，我们可以使用Requests库请求接口，也可以用浏览器接口。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.导入requests库</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 2.明确请求地址</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:12306/api/moco/demo&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 3.发送请求</span></span><br><span class="line">response = requests.get(url=url)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>
<p><strong>搭建mock服务端代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">impor</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,json</span><br><span class="line"><span class="comment">#实例化一个web服务对象</span></span><br><span class="line">app=Flask(__name__)</span><br><span class="line"><span class="comment">#创建一个方法来处理请求</span></span><br><span class="line"><span class="comment">#定义一个路由--访问服务的根目录就可以得到结果</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;h1&gt;hello flask&lt;/h1&gt;&#x27;</span></span><br><span class="line"><span class="comment">#构造一个接受post请求的响应</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/post&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_post</span>():</span><br><span class="line">    <span class="comment">#处理接口发送过来的两个参数，将两个参数合并成一个字符串返回</span></span><br><span class="line">    d1=request.form[<span class="string">&#x27;d1&#x27;</span>]</span><br><span class="line">    d2=request.form[<span class="string">&#x27;d2&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> d1+d2</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment">#运行服务，并确定服务运行的IP和端口</span></span><br><span class="line">    app.run(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="string">&#x27;9090&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>客户端代码：</p>
<p>import requests</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">body=&#123;</span><br><span class="line">    <span class="string">&#x27;d1&#x27;</span>:<span class="string">&#x27;hi&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d2&#x27;</span>:<span class="string">&#x27;falsk12312312&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">resp=requests.post(<span class="string">&#x27;http://127.0.0.1:9090/post&#x27;</span>,data=body)</span><br><span class="line"><span class="built_in">print</span>(resp.text)</span><br></pre></td></tr></table></figure>
<h4 id="get请求-1"><a href="#get请求-1" class="headerlink" title="get请求"></a>get请求</h4><p><strong>没有参数的get请求</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;模拟一个没有参数的get请求。&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/get/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;get&quot;</span>  <span class="comment"># 这里添加了要给method属性</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello get request !&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><strong>有参数的get请求</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;模拟一个没有参数的get请求。&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/get/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;get&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello get request !&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;模拟一个带参数的get请求。&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/get/param/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;get&quot;</span>,</span><br><span class="line">      <span class="string">&quot;queries&quot;</span>: &#123;      <span class="comment"># get请求参数的选项，queries固定属性。</span></span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;xiaoming&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: <span class="string">&quot;18&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello xiaoming !&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>说明：请求地址为：<code>http://127.0.0.1:12306/api/moco/get/param/demo?name=xiaoming&amp;age=18</code></p>
<h4 id="post请求-1"><a href="#post请求-1" class="headerlink" title="post请求"></a>post请求</h4><p><strong>没有参数的post请求</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;模拟一个不带数据的post请求。&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/post/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;post&quot;</span>    </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello post request !&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>提示：POST请求就不能用浏览器进行查看了。只能用Request库或者JMeter，Postman等进行查看。（能进行接口调用的工具都可以）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.导入requests库</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 2.明确请求地址</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:12306/api/moco/post/demo&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 3.发送请求</span></span><br><span class="line">response = requests.post(url=url)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>
<p><strong>有参数的post请求</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;模拟一个带数据post请求。&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/post/param/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">      <span class="string">&quot;forms&quot;</span>: &#123;      <span class="comment"># post请求带参数，参数要添加到forms属性中。</span></span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;xiaoming&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: <span class="string">&quot;18&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello post xiaoming !&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>调用接口查看结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.导入requests库</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 2.明确请求地址</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:12306/api/moco/post/param/demo&quot;</span></span><br><span class="line"> </span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;xiaoming&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="string">&quot;18&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 3.发送请求</span></span><br><span class="line">response = requests.post(url=url, data=data)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>
<h4 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h4><p>使用的是<code>request</code>中的<code>cookies</code>属性。</p>
<p><strong>get请求</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;模拟一个带cookie的get请求。&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/get/cookies/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;get&quot;</span>,</span><br><span class="line">      <span class="string">&quot;cookies&quot;</span>: &#123;          <span class="comment"># 这里添加cookies参数</span></span><br><span class="line">        <span class="string">&quot;login&quot;</span>: <span class="string">&quot;true&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello get cookies !&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>调用接口查看结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.导入requests库</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 2.明确请求地址</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:12306/api/moco/get/cookies/demo&quot;</span></span><br><span class="line"> </span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="string">&quot;login&quot;</span>: <span class="string">&quot;true&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 3.发送请求</span></span><br><span class="line">response = requests.get(url=url, cookies=cookies)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>
<p><strong>post请求</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;模拟一个带cookie的post请求。&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/post/cookies/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">      <span class="string">&quot;cookies&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;login&quot;</span>: <span class="string">&quot;true&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;json&quot;</span>: &#123;     <span class="comment"># post请求的参数也可以用json格式的数据进行传输</span></span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;xiaoming&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: <span class="string">&quot;18&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;status&quot;</span>: <span class="number">201</span>,</span><br><span class="line">      <span class="string">&quot;json&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello post cookies !&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>调用接口查看结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.导入requests库</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 2.明确请求地址</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:12306/api/moco/post/cookies/demo&quot;</span></span><br><span class="line"> </span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="string">&quot;login&quot;</span>: <span class="string">&quot;true&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">json = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;xiaoming&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="string">&quot;18&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 3.发送请求</span></span><br><span class="line">response = requests.post(url=url, json=json ,cookies=cookies)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>
<h4 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h4><p>使用的是<code>request</code>中的<code>headers</code>属性。<br><code>Header</code>是添加请求头信息，关于请求头信息get请求和post请求都是一样的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;模拟一个带Header的post请求。&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/post/headers/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">      <span class="string">&quot;headers&quot;</span>: &#123;      <span class="comment"># 添加请求头信息</span></span><br><span class="line">        <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;json&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;xiaoming&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: <span class="string">&quot;18&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;status&quot;</span>: <span class="number">201</span>,</span><br><span class="line">      <span class="string">&quot;json&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello get Headers !&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>调用接口查看结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.导入requests库</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 2.明确请求地址</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:12306/api/moco/post/headers/demo&quot;</span></span><br><span class="line"> </span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">json = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;xiaoming&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="string">&quot;18&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 3.发送请求</span></span><br><span class="line">response = requests.post(url=url, json=json, headers=headers)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>
<h4 id="Moco模拟重定向"><a href="#Moco模拟重定向" class="headerlink" title="Moco模拟重定向"></a>Moco模拟重定向</h4><p>重定向使用的是和<code>request</code>同级的<code>redirectTo</code>属性。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;重定向到百度&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/redirect/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;get&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;redirectTo&quot;</span>: <span class="string">&quot;http://www.baidu.com&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;重定向到自己的接口&quot;</span>,</span><br><span class="line">    <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;uri&quot;</span>: <span class="string">&quot;/api/moco/redirect/new/demo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;method&quot;</span>: <span class="string">&quot;get&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;redirectTo&quot;</span>: <span class="string">&quot;http://www.baidu.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;response&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;text&quot;</span>: <span class="string">&quot;hello redirectTo !&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a><strong>读取文件</strong></h2><p>1.python使用自带的configparser模块用来读取配置文件，配置文件可以为.conf或.ini结尾</p>
<p>在使用前需要先安装该模块，使用pip安装即可</p>
<p>2.新建一个名为a.conf的配置文件</p>
<p>a) 配置文件中包含一个或多个 section， 每个 section 有自己的 option；</p>
<p>b) section 用 [sect_name] 表示，每个option是一个键值对，使用分隔符 = 或 : 隔开；</p>
<p>c) 在 option 分隔符两端的空格会被忽略掉</p>
<p>d) 配置文件使用 # 和 ; 注释</p>
<p>下面给出一个配置文件的例子。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文件路径的配置</span></span><br><span class="line">[file path]   <span class="comment"># 区域名，即section</span></span><br><span class="line"><span class="comment"># 测试用例excel文件的路径</span></span><br><span class="line">cases_path = D:\\cases.xlsx   <span class="comment"># 选项 option</span></span><br><span class="line">log_path = result.txt[excel]actual_col = 6result_col = <span class="number">7</span></span><br></pre></td></tr></table></figure>
<p>3.导入ConfigParser模块，创建配置解析器对象并读取配置文件名</p>
<p>from configparser import ConfigParser</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.创建配置解析器对象</span></span><br><span class="line">config = ConfigParser()</span><br><span class="line"><span class="comment"># 2.读取配置文件名</span></span><br><span class="line">config.read(<span class="string">&#x27;a.conf&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>4.读操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法一，第一个参数为区域名，第二个参数为选项名</span></span><br><span class="line">cases_path = config[<span class="string">&#x27;file path&#x27;</span>][<span class="string">&#x27;cases_path&#x27;</span>]</span><br><span class="line"><span class="comment"># 方法二</span></span><br><span class="line">cases_path = config.get(<span class="string">&#x27;file path&#x27;</span>, <span class="string">&#x27;cases_path&#x27;</span>)</span><br><span class="line"><span class="comment"># 方法三# 通过getint方法得到的结果值是int类型</span></span><br><span class="line"><span class="comment"># 同样也有getboolean，getfloat方法</span></span><br><span class="line">actual_col = config.getint(<span class="string">&#x27;excel&#x27;</span>, <span class="string">&#x27;actual_col&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<p># 使用getboolean去读取值，只能读取如下的数据，如果是非0和1，也会报错<br># 1 yes on true True得到的结果为True<br># 0 no off false False得到的结果为False</p>
<p>5.写操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> configparser <span class="keyword">import</span> ConfigParser</span><br><span class="line"><span class="comment"># 1.创建配置解析器对象</span></span><br><span class="line">config = ConfigParsr()</span><br><span class="line"><span class="comment"># 2.将需要写入配置文件中的数据组合</span></span><br><span class="line"><span class="comment"># 方法一</span></span><br><span class="line">config[<span class="string">&#x27;file path&#x27;</span>] = &#123;<span class="string">&#x27;cases_path&#x27;</span>: <span class="string">&#x27;D:\\cases.xlsx&#x27;</span>, <span class="string">&#x27;log_path&#x27;</span>: <span class="string">&#x27;result.txt&#x27;</span>&#125;</span><br><span class="line">config[<span class="string">&#x27;msg&#x27;</span>] = &#123;<span class="string">&#x27;success_result&#x27;</span>: <span class="string">&#x27;Pass&#x27;</span>, <span class="string">&#x27;fail_result&#x27;</span>: <span class="string">&#x27;Fail&#x27;</span>&#125;</span><br><span class="line"><span class="comment"># 方法二</span></span><br><span class="line"><span class="comment"># 可以使用嵌套字典的字典来创建配置文件</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;file path&#x27;</span>: &#123;<span class="string">&#x27;cases_path&#x27;</span>: <span class="string">&#x27;D:\\cases.xlsx&#x27;</span>, <span class="string">&#x27;log_path&#x27;</span>: <span class="string">&#x27;result.txt&#x27;</span>&#125;,</span><br><span class="line">    <span class="string">&#x27;msg&#x27;</span>: &#123;<span class="string">&#x27;success_result&#x27;</span>: <span class="string">&#x27;Pass&#x27;</span>, <span class="string">&#x27;fail_result&#x27;</span>: <span class="string">&#x27;Fail&#x27;</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> data:</span><br><span class="line">    config[key] = data[key]</span><br><span class="line"><span class="comment"># 3.保存到文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;b.conf&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    config.write</span><br></pre></td></tr></table></figure>
<h3 id="excel"><a href="#excel" class="headerlink" title="excel"></a>excel</h3><p>安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install openpyxl</span><br></pre></td></tr></table></figure>
<h3 id=""><a href="#" class="headerlink" title=" "></a> </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf8</span></span><br><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HandleExcel</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load_excel</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 拼接文件路径</span></span><br><span class="line">        file_path = os.path.join(<span class="string">&quot;..&quot;</span>, <span class="string">&quot;ReadFile&quot;</span>, <span class="string">&quot;read_test.xlsx&quot;</span>)</span><br><span class="line">        <span class="comment"># 加载 Excel 文件</span></span><br><span class="line">        open_excel = openpyxl.load_workbook(file_path)</span><br><span class="line">        <span class="keyword">return</span> open_excel</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_sheet_data</span>(<span class="params">self, index=<span class="literal">None</span></span>):</span><br><span class="line">        sheetnames = self.load_excel().sheetnames</span><br><span class="line">        <span class="keyword">if</span> index <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            index = <span class="number">0</span></span><br><span class="line">        data = self.load_excel()[sheetnames[index]]</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_all_values</span>(<span class="params">self</span>):</span><br><span class="line">        sheet_data = self.get_sheet_data()</span><br><span class="line">        all_values = []</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> sheet_data.iter_rows(values_only=<span class="literal">True</span>):</span><br><span class="line">            all_values.append(<span class="built_in">list</span>(row))</span><br><span class="line">        <span class="comment"># json格式</span></span><br><span class="line">        <span class="comment"># for row in all_values:</span></span><br><span class="line">        <span class="comment">#     print(row)</span></span><br><span class="line">        <span class="keyword">return</span> all_values</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_cell_value</span>(<span class="params">self, row, cols</span>):</span><br><span class="line">        <span class="comment"># 获取指定单元格的值</span></span><br><span class="line">        data = self.get_sheet_data().cell(row=row, column=cols).value</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_rows</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 获取行数</span></span><br><span class="line">        row = self.get_sheet_data().max_row</span><br><span class="line">        <span class="keyword">return</span> row</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_rows_value</span>(<span class="params">self, row</span>):</span><br><span class="line">        row_list = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self.get_sheet_data()[row]:</span><br><span class="line">            <span class="comment"># 将每个单元格的值添加到列表中</span></span><br><span class="line">            row_list.append(i.value)</span><br><span class="line">        <span class="keyword">return</span> row_list</span><br><span class="line">excel_data = HandleExcel()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    handle = HandleExcel()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;全部获取&quot;</span>,handle.get_all_values())</span><br><span class="line">    <span class="comment"># 输出第三行的数据</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;获取值&quot;</span>,handle.get_rows_value(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<h3 id="ini"><a href="#ini" class="headerlink" title="ini"></a>ini</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HandleIni</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load_ini</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 加载 server.ini 文件</span></span><br><span class="line">        file_path = os.path.join(<span class="string">&quot;..&quot;</span>, <span class="string">&quot;ReadFile&quot;</span>, <span class="string">&quot;server.ini&quot;</span>)</span><br><span class="line">        cf = configparser.ConfigParser()</span><br><span class="line">        cf.read(file_path, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> cf</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_all_values</span>(<span class="params">self</span>):</span><br><span class="line">        cf = self.load_ini()</span><br><span class="line">        all_values = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> section <span class="keyword">in</span> cf.sections():</span><br><span class="line">            all_values[section] = <span class="built_in">dict</span>(cf[section])</span><br><span class="line">        <span class="keyword">return</span> all_values</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">print_all_values</span>(<span class="params">self</span>):</span><br><span class="line">        all_values = self.get_all_values()</span><br><span class="line">        <span class="keyword">for</span> section, values <span class="keyword">in</span> all_values.items():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;section&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> key, value <span class="keyword">in</span> values.items():</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;key&#125;</span> = <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_value</span>(<span class="params">self, key, node=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">if</span> node == <span class="literal">None</span>:</span><br><span class="line">            node = <span class="string">&#x27;server&#x27;</span></span><br><span class="line">        cf = self.load_ini()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 获取指定节点和键对应的值</span></span><br><span class="line">            data = cf.get(node, key)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;没有获取到值&quot;</span>)</span><br><span class="line">            data = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line">handle_ini = HandleIni()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    hit = HandleIni()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;获取全部&quot;</span>,hit.print_all_values())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;获取值&quot;</span>,hit.get_value(<span class="string">&quot;host&quot;</span>))</span><br></pre></td></tr></table></figure>
<h3 id="json"><a href="#json" class="headerlink" title="json"></a>json</h3><p>读取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">base_path = os.getcwd()</span><br><span class="line">sys.path.append(base_path)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_json</span>(<span class="params">file_name=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="comment"># 检查 file_name 是否为 None，如果是，则使用默认文件路径</span></span><br><span class="line">    <span class="keyword">if</span> file_name <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        file_path = os.path.join(<span class="string">&quot;..&quot;</span>, <span class="string">&quot;ReadFile&quot;</span>, <span class="string">&quot;code_json.json&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        file_path = os.path.join(base_path, file_name)</span><br><span class="line">    <span class="comment"># 打开 JSON 文件并加载数据</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = json.load(f)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_value</span>(<span class="params">key, file_name=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="comment"># 获取 JSON 数据</span></span><br><span class="line">    data = handle_json(file_name)</span><br><span class="line">    <span class="comment"># 返回指定键对应的值</span></span><br><span class="line">    <span class="keyword">return</span> data.get(key)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 示例用法</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;全部读取：&quot;</span>,handle_json())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;读取值：&quot;</span>,json_value(<span class="string">&quot;api3/getbanneradvertver2&quot;</span>))</span><br></pre></td></tr></table></figure>
<h2 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h2><h3 id="json-1"><a href="#json-1" class="headerlink" title="json"></a>json</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">base_path = os.getcwd()</span><br><span class="line">sys.path.append(base_path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_value</span>(<span class="params">data, cookie_key</span>):</span><br><span class="line">    <span class="comment"># 构建文件路径</span></span><br><span class="line">    file_path = os.path.join(<span class="string">&quot;..&quot;</span>, <span class="string">&quot;ReadFile&quot;</span>, <span class="string">&quot;cookie.json&quot;</span>)</span><br><span class="line">    <span class="comment"># 以只读模式打开文件，并读取已有数据</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        existing_data = json.load(f)</span><br><span class="line">    <span class="comment"># 将给定数据添加到已有数据中</span></span><br><span class="line">    existing_data[cookie_key] = data</span><br><span class="line">    <span class="comment"># 以写入模式打开文件，并将更新后的数据写回文件</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(existing_data, f, indent=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;jee&quot;</span>: <span class="string">&quot;123456789&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    write_value(data, <span class="string">&#x27;123&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;写入完成&quot;</span>)</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>接口测试</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://www.fixbox.top/2024/01/22/2-8-%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/">https://www.fixbox.top/2024/01/22/2-8-接口测试/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>Fylasd</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2024-01-22</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2024-01-22</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/">接口测试</a></div><div class="post_share"><div class="social-share" data-image="https://img2.baidu.com/it/u=3725066843,1857864369&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/22/2-9-%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" title="性能测试"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">性能测试</div></div></a></div><div class="next-post pull-right"><a href="/2024/01/22/1-10-vue%E5%AE%9E%E6%88%98%E5%B0%8F%E7%9F%A5%E8%AF%86%E7%82%B9/" title="vue实战小知识点"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">vue实战小知识点</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2.baidu.com/it/u=3725066843,1857864369&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Fylasd</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/"><i class="fab fa-github"></i><span>前往小家</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到博客空间</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%89%88"><span class="toc-text">基础版</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E5%8D%8F%E8%AE%AE%E7%AE%80%E4%BB%8B"><span class="toc-text">HTTP协议简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF"><span class="toc-text">HTTP请求消息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E8%A1%8C-request-line"><span class="toc-text">请求行 request line</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%B4-request-headers"><span class="toc-text">请求头 request headers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E4%BD%93-message-body"><span class="toc-text">消息体 message body</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E5%93%8D%E5%BA%94%E6%B6%88%E6%81%AF"><span class="toc-text">HTTP响应消息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E8%A1%8C-status-line"><span class="toc-text">状态行 status line</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%A4%B4-response-headers"><span class="toc-text">响应头 response headers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E4%BD%93-message-body-1"><span class="toc-text">消息体 message body</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E6%95%B0%E6%8D%AE%E7%94%A8%E4%BE%8B"><span class="toc-text">接口数据用例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%94%A8%E4%BE%8B%E8%AE%BE%E8%AE%A1"><span class="toc-text">数据用例设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%94%A8%E4%BE%8B%E5%8F%82%E6%95%B0%E5%8C%96"><span class="toc-text">数据用例参数化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="toc-text">设置迭代器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E6%A3%80%E6%9F%A5%EF%BC%88%E6%96%AD%E8%A8%80%EF%BC%89"><span class="toc-text">结果检查（断言）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%B8%A6Tests%E5%87%BD%E6%95%B0"><span class="toc-text">自带Tests函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%B7%A5tests%E5%87%BD%E6%95%B0"><span class="toc-text">手工tests函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tests%E9%AB%98%E7%BA%A7%E6%93%8D%E4%BD%9C"><span class="toc-text">tests高级操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Runner%E6%89%A7%E8%A1%8C%E6%B5%8B%E8%AF%95"><span class="toc-text">Runner执行测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%BF%AD%E4%BB%A3%E5%99%A8-1"><span class="toc-text">设置迭代器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Postman%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-text">Postman的参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E8%AE%BE%E7%BD%AE"><span class="toc-text">环境变量设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-text">全局变量</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E4%BB%B7%E7%89%88"><span class="toc-text">进价版</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#requests"><span class="toc-text">requests</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-text">常用参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%86%85%E5%AE%B9"><span class="toc-text">响应内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E5%88%B6%E5%A4%B4%E5%92%8Ccookie%E4%BF%A1%E6%81%AF"><span class="toc-text">定制头和cookie信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E7%8A%B6%E6%80%81%E7%A0%81"><span class="toc-text">响应状态码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#https-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86"><span class="toc-text">https 请求处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">文件上传</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-text">文件下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#timeout-%E5%8F%82%E6%95%B0"><span class="toc-text">timeout 参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%87%E6%80%BB%EF%BC%9A"><span class="toc-text">汇总：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#GET%E8%AF%B7%E6%B1%82"><span class="toc-text">GET请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#POST%E8%AF%B7%E6%B1%82"><span class="toc-text">POST请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E5%8F%82%E6%95%B0"><span class="toc-text">示例参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#json%E8%AF%B7%E6%B1%82%EF%BC%9A"><span class="toc-text">json请求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Xml%E8%AF%B7%E6%B1%82%EF%BC%9A"><span class="toc-text">Xml请求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-text">状态异常处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-text">上传文件：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86"><span class="toc-text">加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%EF%BC%9A"><span class="toc-text">身份验证：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%99%BB%E9%99%86"><span class="toc-text">自动登陆</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flask"><span class="toc-text">Flask</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#get%E8%AF%B7%E6%B1%82"><span class="toc-text">get请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#post%E8%AF%B7%E6%B1%82"><span class="toc-text">post请求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mock"><span class="toc-text">Mock</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Moco%E6%A1%86%E6%9E%B6"><span class="toc-text">Moco框架</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#get%E8%AF%B7%E6%B1%82-1"><span class="toc-text">get请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#post%E8%AF%B7%E6%B1%82-1"><span class="toc-text">post请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookies"><span class="toc-text">Cookies</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header"><span class="toc-text">Header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Moco%E6%A8%A1%E6%8B%9F%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-text">Moco模拟重定向</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-text">读取文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#excel"><span class="toc-text">excel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text"> </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ini"><span class="toc-text">ini</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#json"><span class="toc-text">json</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="toc-text">写入文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#json-1"><span class="toc-text">json</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By Fylasd</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="/js/tw_cn.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script async src="https://npm.elemecdn.com/tzy-blog/lib/js/other/sakura.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://www.fixbox.top/categories/Linux/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📒 Linux (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.fixbox.top/categories/SQL数据库/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📒 SQL数据库 (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.fixbox.top/categories/Python/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📒 Python (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="https://www.fixbox.top/categories" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(50% - 5px);background: #f2f2f2;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: #104E8B}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'true';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站采用多线部署，主线路托管于Vercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="本站采用多线部署，备用线路托管于4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '1s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '2');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":90,"height":180},"mobile":{"show":false},"log":false});</script></body></html>