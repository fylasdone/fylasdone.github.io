<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>web自动化 | 冯XX</title><meta name="author" content="Fylasd"><meta name="copyright" content="Fylasd"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="web自动化测试的工具 现在主流的web测试工具我们常用的就是selenium的那一套工具包括  浏览器一般选择chrome 浏览器对应的driver(chromedriver) Python Selenium库  web自动化测试的环境安装  浏览器安装 下载浏览器下一步按照就好了 chromedriver 下载 可以到 npmmirror.com&#x2F; https:&#x2F;&#x2F;registry.npmmi">
<meta property="og:type" content="article">
<meta property="og:title" content="web自动化">
<meta property="og:url" content="https://www.fixbox.top/2024/01/22/3-5-Web%E8%87%AA%E5%8A%A8%E5%8C%96/index.html">
<meta property="og:site_name" content="冯XX">
<meta property="og:description" content="web自动化测试的工具 现在主流的web测试工具我们常用的就是selenium的那一套工具包括  浏览器一般选择chrome 浏览器对应的driver(chromedriver) Python Selenium库  web自动化测试的环境安装  浏览器安装 下载浏览器下一步按照就好了 chromedriver 下载 可以到 npmmirror.com&#x2F; https:&#x2F;&#x2F;registry.npmmi">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img2.baidu.com/it/u=3725066843,1857864369&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500">
<meta property="article:published_time" content="2024-01-22T07:03:45.175Z">
<meta property="article:modified_time" content="2024-01-22T07:09:12.228Z">
<meta property="article:author" content="Fylasd">
<meta property="article:tag" content="web自动化">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img2.baidu.com/it/u=3725066843,1857864369&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"><link rel="shortcut icon" href="https://img1.baidu.com/it/u=2559221203,2316879426&fm=253&fmt=auto&app=138&f=PNG?w=400&h=400"><link rel="canonical" href="https://www.fixbox.top/2024/01/22/3-5-Web%E8%87%AA%E5%8A%A8%E5%8C%96/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'web自动化',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-22 15:09:12'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><div id="myscoll"></div><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2.baidu.com/it/u=3725066843,1857864369&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="冯XX"><span class="site-name">冯XX</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">web自动化</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-01-22T07:03:45.175Z" title="发表于 2024-01-22 15:03:45">2024-01-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-22T07:09:12.228Z" title="更新于 2024-01-22 15:09:12">2024-01-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/">软件测试</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">11k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>45分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="web自动化"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><strong>web自动化测试的工具</strong></p>
<p>现在主流的web测试工具我们常用的就是selenium的那一套工具包括</p>
<ul>
<li>浏览器一般选择chrome</li>
<li>浏览器对应的driver(chromedriver)</li>
<li>Python</li>
<li>Selenium库</li>
</ul>
<p><strong>web自动化测试的环境安装</strong></p>
<ul>
<li>浏览器安装 下载浏览器下一步按照就好了</li>
<li>chromedriver 下载 可以到 <a target="_blank" rel="noopener" href="https://npmmirror.com/?login=from_csdn">npmmirror.com/</a></li>
<li><a target="_blank" rel="noopener" href="https://registry.npmmirror.com/binary.html?path=chromedriver/">https://registry.npmmirror.com/binary.html?path=chromedriver/</a>      低版本</li>
<li>​      高版本</li>
<li>注：找到和自己浏览器版本适配的driver版本   注：浏览器点击右上角‘…’—&gt;帮助—&gt;关于Google Chrome—&gt;可以看到浏览器的版本，根据当前浏览器的版本下载</li>
</ul>
<p>Selenium提供了一个webdriver_manager库，可以帮助自动下载和更新Chrome浏览器的驱动程序chromedriver.exe。您可以按照以下步骤操作：</p>
<ol>
<li><p>安装webdriver_manager库。可以在命令行或终端中运行以下命令进行安装：</p>
</li>
<li><p>```<br>pip install webdriver_manager</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在Selenium Python脚本中，导入webdriver_manager并使用ChromeDriverManager类来创建ChromeDriver实例。这样，如果您的Chrome浏览器版本发生变化，webdriver_manager将自动下载合适的chromedriver版本，并使用它来运行测试。</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">from selenium import webdriver</span><br><span class="line">from webdriver_manager.chrome import ChromeDriverManager</span><br><span class="line"># 创建ChromeDriver实例</span><br><span class="line">driver = webdriver.Chrome(executable_path=ChromeDriverManager().install())</span><br><span class="line"># 在浏览器中打开网页</span><br><span class="line">driver.get(&#x27;https://www.baidu.com/&#x27;)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="安装selenium包"><a href="#安装selenium包" class="headerlink" title="安装selenium包"></a><strong>安装selenium包</strong></h3><p>Selenium WebDriver是一个第三方模块，并不是Python的标准模块，所以在导入这个模块之前，还需要将这个第三方模块安装到Python的目录中，这样才能使用import或者from…import语句进行导入。</p>
<p>安装最新版本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium</span><br></pre></td></tr></table></figure>
<p>安装指定版本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium==版本号</span><br></pre></td></tr></table></figure>
<p>卸载selenium</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip uninstall selenium</span><br></pre></td></tr></table></figure>
<p><strong>web自动化测试脚本编写的基本步骤</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br></pre></td></tr></table></figure>
<p> <strong>创建驱动浏览器对象并启动浏览器</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">浏览器驱动对象 = webdriver.Firefox()</span><br><span class="line">浏览器驱动对象 = webdriver.Chrome()</span><br><span class="line">浏览器驱动对象 = webdriver.Edge()</span><br></pre></td></tr></table></figure>
<p><strong>编写自动化执行步骤</strong></p>
<p><strong>打开网页：</strong></p>
<blockquote>
<p>浏览器驱动对象.get(“网页链接”)</p>
</blockquote>
<p><strong>浏览器窗口最大化：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.maxmimize()</span><br></pre></td></tr></table></figure>
<p><strong>关闭驱动对象</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">浏览器驱动对象.quit()</span><br></pre></td></tr></table></figure>
<p><strong>刷新窗口</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.refresh() *# 刷新*</span><br></pre></td></tr></table></figure>
<p><strong>使用 JavaScript 中的 <code>window.scrollTo()</code> 方法来实现滚动</strong></p>
<p>滚动到底部：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.execute_script(&quot;window.scrollTo(0, 0);&quot;)</span><br></pre></td></tr></table></figure>
<p>滚动到页面中间：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.execute_script(f&quot;window.scrollTo(0, &#123;middle&#125;);&quot;)</span><br></pre></td></tr></table></figure>
<p>滚动到页面顶部：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.execute_script(&quot;window.scrollTo(0, document.body.scrollHeight);&quot;)</span><br></pre></td></tr></table></figure>
<p>缓慢滚动到底部：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取页面高度</span></span><br><span class="line">height = driver.execute_script(<span class="string">&quot;return document.body.scrollHeight&quot;</span>)</span><br><span class="line"><span class="comment"># 模拟缓慢下滑操作</span></span><br><span class="line">scroll_speed = <span class="number">500</span>  <span class="comment"># 每次滚动的距离</span></span><br><span class="line">interval = <span class="number">0.01</span>  <span class="comment"># 每次滚动之间的时间间隔</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 缓慢滚动</span></span><br><span class="line">    driver.execute_script(<span class="string">f&quot;window.scrollBy(0, <span class="subst">&#123;scroll_speed&#125;</span>);&quot;</span>)</span><br><span class="line">    time.sleep(interval)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 到达页面底部时退出循环</span></span><br><span class="line">    new_height = driver.execute_script(<span class="string">&quot;return document.body.scrollHeight&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> new_height == height:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    height = new_height</span><br></pre></td></tr></table></figure>
<h3 id="八大元素"><a href="#八大元素" class="headerlink" title="八大元素"></a>八大元素</h3><ol>
<li><strong>id</strong></li>
<li><strong>name</strong></li>
<li><strong>class_name</strong>（使用元素的class属性）</li>
<li><strong>xpath</strong>（基于文件路径）</li>
<li><strong>css</strong>（元素选择器定位）</li>
<li><strong>tag_name</strong>（元素的标签名称<input …/>）</li>
<li><strong>link_text</strong>（定位超链接，a标签）</li>
<li><strong>partail_link_text</strong>（定位超链接，a标签 模糊）</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">汇总：</span><br><span class="line">1.基于元素属性特有定有定位：id/name/class_name</span><br><span class="line">2. 基于元素标签名称定位：tag_name</span><br><span class="line">3. 定位超链接文本：link_text/partail_link_text</span><br><span class="line">4. 基于元素路径定位：xpath</span><br><span class="line">5. 基于选择器：css</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;底层代码&quot;&quot;&quot;</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line"></span><br><span class="line">    ID = &quot;id&quot;</span><br><span class="line">    XPATH = &quot;xpath&quot;</span><br><span class="line">    LINK_TEXT = &quot;link text&quot;</span><br><span class="line">    PARTIAL_LINK_TEXT = &quot;partial link text&quot;</span><br><span class="line">    NAME = &quot;name&quot;</span><br><span class="line">    TAG_NAME = &quot;tag name&quot;</span><br><span class="line">    CLASS_NAME = &quot;class name&quot;</span><br><span class="line">    CSS_SELECTOR = &quot;css selector&quot;</span><br></pre></td></tr></table></figure>
<h4 id="1、id"><a href="#1、id" class="headerlink" title="1、id"></a>1、id</h4><p>HTML规定id属性在HTML文档中必须是唯一的<br>driver.find_element(By.ID, “id名”).send_keys(“输入内容”)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line"><span class="comment"># 窗口最大化</span></span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.com/&quot;</span>)</span><br><span class="line">driver.find_element(By.ID, <span class="string">&quot;kw&quot;</span>).send_keys(<span class="string">&quot;输入的内容&quot;</span>)</span><br><span class="line">driver.find_element(By.ID, <span class="string">&quot;su&quot;</span>).click()</span><br><span class="line">sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h4 id="2、name"><a href="#2、name" class="headerlink" title="2、name"></a>2、name</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element(By.NAME, <span class="string">&quot;wd&quot;</span>).send_keys(<span class="string">&quot;输入的内容&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 只获取属性的第一个元素</span></span><br><span class="line">driver.find_element(By.NAME, <span class="string">&#x27;wd&#x27;</span>).send_keys(<span class="string">&quot;软件测试老白&quot;</span>)</span><br><span class="line"><span class="comment"># 获取属性的所有元素</span></span><br><span class="line">driver.find_elements(By.NAME, <span class="string">&#x27;wd&#x27;</span>)[<span class="number">0</span>].send_keys(<span class="string">&quot;软件测试老白&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="3、class-name"><a href="#3、class-name" class="headerlink" title="3、class_name"></a>3、class_name</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element(By.CLASS_NAME,<span class="string">&quot;login-top&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line"><span class="comment"># 窗口最大化</span></span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(<span class="string">&quot;https://www.bilibili.com/&quot;</span>)</span><br><span class="line"><span class="comment"># 只获取class属性的第一个元素</span></span><br><span class="line"><span class="comment"># driver.find_element(By.CLASS_NAME,&#x27;nav-search-input&#x27;).send_keys(&quot;2024新年快乐&quot;)</span></span><br><span class="line"><span class="comment"># driver.find_element(By.CLASS_NAME,&#x27;channel-link&#x27;).click()</span></span><br><span class="line"><span class="comment"># 获取class属性的所有元素</span></span><br><span class="line"><span class="comment"># driver.find_elements(By.CLASS_NAME,&#x27;channel-link&#x27;)[4].click()</span></span><br><span class="line"><span class="comment"># for ele in driver.find_elements(By.CLASS_NAME,&#x27;channel-link&#x27;):</span></span><br><span class="line"><span class="comment">#     print(ele.text)</span></span><br><span class="line"><span class="comment"># 错误用法</span></span><br><span class="line">driver.find_element(By.CLASS_NAME,<span class="string">&#x27;icon-bg icon-bg__channel&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h4 id="4、tag-name"><a href="#4、tag-name" class="headerlink" title="4、tag_name"></a>4、tag_name</h4><p>通过标签名来定位，一般很少使用<br>如果页面中存在多个相同的标签名，默认返回第一个</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element(By.TAG_NAME,<span class="string">&quot;input&quot;</span>).send_keys(<span class="string">&quot;admin&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="5、link-text"><a href="#5、link-text" class="headerlink" title="5、link_text"></a>5、link_text</h4><p>精确匹配超链接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element(By.LINK_TEXT,<span class="string">&quot;新闻&quot;</span>).click()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">driver.find_element(By.LINK_TEXT, <span class="string">&#x27;新闻&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<h4 id="6、partail-link-text"><a href="#6、partail-link-text" class="headerlink" title="6、partail_link_text"></a>6、partail_link_text</h4><p>模糊匹配超链接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">driver.find_element(By.PARTIAL_LINK_TEXT, <span class="string">&#x27;闻&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<h4 id="7、xpath"><a href="#7、xpath" class="headerlink" title="7、xpath"></a>7、xpath</h4><p>如果要定位的元素没有id、name、class属性，该如何进行定位？<br>——使用xpath。</p>
<p>xPath是XML Path的简称，是一门在XML文档中查找元素信息的语言<br>XML是一种标记语言。<br>● 本质是一种查询语言<br>●支持逻辑运算、函数<br>● 实现非常强大的功能<br>● 可以用于APP自动化测试</p>
<p>依赖于元素的路径：<br>● 绝对路径：/开头是绝对路径<br>● 相对路径：//开头是相对路径</p>
<p>Xpath可以通过相对路径与绝对路径去定位元素，绝对路径从 HTML 根节点开始算，相对路径从任意节点开始。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>说明</th>
<th>举例</th>
</tr>
</thead>
<tbody>
<tr>
<td>从根节点开始选取(绝对路径)</td>
<td>/html/div/</td>
</tr>
<tr>
<td>从任意节点开始选取(相对路径)</td>
<td>//div，列举出所有div标签</td>
</tr>
<tr>
<td>选取当前节点的父节点</td>
<td>//input/.. 会选取 input 的父节点</td>
</tr>
<tr>
<td>选取属性，或者根据属性选取</td>
<td></td>
</tr>
<tr>
<td>使用id属性定位</td>
<td>//div[@id=’id_value’]</td>
</tr>
<tr>
<td>使用class属性定位</td>
<td>//a[@class=”mnav”]</td>
</tr>
<tr>
<td>使用name属性定位</td>
<td>//div[@name=’wd’]</td>
</tr>
<tr>
<td>多个属性定位</td>
<td>//input[@name=”wd” and @class=”s_ipt”]</td>
</tr>
<tr>
<td>第n个元素，使用index定位</td>
<td>//div[@id=”s-top-left”]/a[3]</td>
</tr>
<tr>
<td>最后一个元素</td>
<td>//a[@class=”mnav”] [last()]</td>
</tr>
<tr>
<td>属性包含某字段</td>
<td>//div[contains(@title,’text’)]</td>
</tr>
<tr>
<td>属性以某字段开头</td>
<td>//div[starts-with(@title,’text’)]</td>
</tr>
<tr>
<td>属性以某字段结尾</td>
<td>//div[ends-with(@title,’text’)]</td>
</tr>
<tr>
<td>文本包含</td>
<td>//a[contains(text(),”网盘”)]</td>
</tr>
<tr>
<td>文本等于</td>
<td>//span[text() = “菜单”]</td>
</tr>
<tr>
<td>同级弟弟元素</td>
<td>//div[@id==’id’]/following-sibling::div</td>
</tr>
<tr>
<td>同级哥哥元素</td>
<td>//div[@id==’id’]/preceding-sibling::div</td>
</tr>
</tbody>
</table>
</div>
<p>●使用绝对路径，一般不推荐绝对路径，因为写起来太麻烦了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 定位百度首页的新闻</span></span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;/html/body/div/div/div[3]/a&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>下面使用相对路径定位<br>●使用id属性定位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//input[@id=&quot;kw&quot;]&#x27;</span>).send_keys(<span class="string">&quot;软件测试老白&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>●使用class属性定位</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(&#x27;https://www.baidu.com&#x27;)</span><br><span class="line"># class中间有空格，需要全部写上</span><br><span class="line">driver.find_element(By.XPATH, &#x27;//a[@class=&quot;mnav c-font-normal c-color-t&quot;]&#x27;)</span><br></pre></td></tr></table></figure>
<p>●根据name属性定位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//input[@name=&quot;wd&quot;]&#x27;</span>).send_keys(<span class="string">&quot;软件测试老白&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>●由子元素定位父元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 定位输入框的父元素</span></span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//input[@id=&quot;kw&quot;]/..&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>●多个属性组合定位 支持and or</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//input[@name=&quot;wd&quot; and @class=&quot;s_ipt&quot;]&#x27;</span>).send_keys(<span class="string">&quot;软件测试老白&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>●多组数据使用下标定位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 定位百度首页地图</span></span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//div[@id=&quot;s-top-left&quot;]/a[3]&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>●根据文本内容定位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 定位百度首页网盘</span></span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//a[contains(text(),&quot;网盘&quot;)]&#x27;</span>) </span><br></pre></td></tr></table></figure>
<p>●其它定位方式，轴定位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 最后一个子元素,last()</span></span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//a[@class=&quot;mnav c-font-normal c-color-t&quot;][last()]&#x27;</span>) </span><br><span class="line">动态ID</span><br><span class="line">https://element.eleme.cn/<span class="comment">#/zh-CN/component/cascader</span></span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//span[text() = &quot;默认 click 触发子菜单&quot;]/following-sibling::div/div/input&#x27;</span>) </span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1、相对路径+索引定位   //form/span/input</span></span><br><span class="line">driver.find_element(By.XPATH,<span class="string">&quot;//form/span/input&quot;</span>).send_keys(<span class="string">&quot;输入的内容&quot;</span>)</span><br><span class="line"></span><br><span class="line"> <span class="comment">#2、相对路径+属性定位   //input[@autocomplete=&#x27;off&#x27;]</span></span><br><span class="line">driver.find_element(By.XPATH,<span class="string">&quot;//input[@autocomplete=&#x27;off&#x27;]&quot;</span>).send_keys(<span class="string">&quot;输入的内容&quot;</span>)</span><br><span class="line"></span><br><span class="line"> <span class="comment">#3、相对路径+通配符定位  *复制xpath不是万能的，经常会报错</span></span><br><span class="line">driver.find_element(By.XPATH,<span class="string">&quot;//*[@autocomplete=&#x27;off&#x27;]&quot;</span>).send_keys(<span class="string">&quot;输入的内容&quot;</span>)</span><br><span class="line">driver.find_element(By.XPATH,<span class="string">&quot;//*[@*=&#x27;off&#x27;]&quot;</span>).send_keys(<span class="string">&quot;输入的内容&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#4、相对路径+部分属性值定位	input[starts-with(@autocomplete,&#x27;of&#x27;)]</span></span><br><span class="line">driver.find_element(	<span class="comment"># auto属性以of开头：starts-with</span></span><br><span class="line">    By.XPATH,<span class="string">&quot;//input[starts-with(@autocomplete,&#x27;of&#x27;)]&quot;</span></span><br><span class="line">).send_keys(<span class="string">&quot;输入的内容&quot;</span>)</span><br><span class="line">	</span><br><span class="line">driver.find_element(	<span class="comment"># auto属性从第二个字符开始截取，为ff的：substring</span></span><br><span class="line">    By.XPATH,<span class="string">&quot;//input[substring(@autocomplete,2)=&#x27;ff&#x27;]&quot;</span></span><br><span class="line">).send_keys(<span class="string">&quot;输入的内容&quot;</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element(	<span class="comment"># auto属性包含字符of：contains</span></span><br><span class="line">    By.XPATH,<span class="string">&quot;//input[contains(@autocomplete,&#x27;of&#x27;)]&quot;</span></span><br><span class="line">).send_keys(<span class="string">&quot;输入的内容&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5、相对路径+文本定位</span></span><br><span class="line">value = driver.find_element(</span><br><span class="line">    By.XPATH,<span class="string">&quot;//span[text()=&#x27;按图片搜索&#x27;]&quot;</span></span><br><span class="line">).get_attribute(<span class="string">&#x27;class&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>1、XPATH的语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">语法：表示层级+属性</span><br><span class="line">/（开头）表示根路径</span><br><span class="line">/html/body/div</span><br><span class="line">//（任意层级）（包括下级、下级的下级…）</span><br><span class="line">//div</span><br><span class="line">@属性</span><br><span class="line">‘//a[@target=“_top”]’</span><br><span class="line">/（中间）表示下一级</span><br><span class="line">‘//p//input’</span><br><span class="line">.表示本级</span><br><span class="line">…表示上一级</span><br></pre></td></tr></table></figure>
<p><strong>2、 XPATH的函数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">函数是XPATH另一个魅力，常用的函数：</span><br><span class="line">● text：获取元素内的文本</span><br><span class="line">● contains：任意位置包含匹配</span><br><span class="line">● starts-with：开头</span><br><span class="line">● substring：截取</span><br><span class="line">$x(“//a[text=(vivoX5MAX L 移动4G 八核超薄大屏5.5双卡)]”)</span><br><span class="line">$x(“//a[contains( text=(),‘vivo’) ]”)</span><br><span class="line">$x(“//a[start-with( text=(),‘vivo’) ]”)</span><br><span class="line">$x(“//a[substring(@name,2)=‘vi’ ]”)</span><br></pre></td></tr></table></figure>
<h4 id="8、css"><a href="#8、css" class="headerlink" title="8、css"></a>8、css</h4><p><strong>1. id选择器</strong></p>
<ul>
<li>前提：元素必须有id属性</li>
<li>语法：#id 如：#password</li>
</ul>
<p><strong>2. class选择器</strong></p>
<ul>
<li>前提：元素必须是有class属性</li>
<li>语法：.class 如：.telA</li>
</ul>
<p><strong>3. 元素选择器</strong></p>
<ul>
<li>语法：element 如：input</li>
</ul>
<p><strong>4. 属性选择器</strong></p>
<ul>
<li>语法：[属性名=属性值]</li>
</ul>
<p><strong>5. 层级选择器</strong></p>
<ul>
<li>语法：<br>p&gt;input<br>p input</li>
<li>提示：<br>大于号和空格的区别，大于号必须为子元素，空格则不用</li>
</ul>
<p><strong>6. 【css延伸】</strong></p>
<p>input[type^=‘p’] type属性以p字母开头的元素<br>input[type$=‘d’] type属性以d字母结束的元素<br>input[type*=‘w’] type属性包含w字母的元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.使用css id选择器 定位用户名 输入admin</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;#userA&quot;</span>).send_keys(<span class="string">&quot;admin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.使用css 属性选择器 定位密码框 输入123456</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;[name=&#x27;passwordA&#x27;]&quot;</span>).send_keys(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.使用css class选择器 定位电话号码 输入18611112222</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;.telA&quot;</span>).send_keys(<span class="string">&quot;18611112222&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.使用css 元素选择器 定位span标签获取文本值</span></span><br><span class="line">span = driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;span&quot;</span>).text</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;获取的span标签文本值为：&quot;</span>,span)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.使用层级选择器 定位email 输入123@qq.com</span></span><br><span class="line">driver.find_element(</span><br><span class="line">    By.CSS_SELECTOR,<span class="string">&quot;p&gt;input[placeholder=&#x27;电子邮箱A&#x27;]&quot;</span></span><br><span class="line">).send_keys(<span class="string">&quot;123@qq.com&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>XPATH和CSS类似功能对比</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>定位方式</th>
<th>XPath</th>
<th>CSS</th>
</tr>
</thead>
<tbody>
<tr>
<td>元素名</td>
<td>//input</td>
<td>input</td>
</tr>
<tr>
<td>id</td>
<td>//input[@id=‘userA’]</td>
<td>@userA</td>
</tr>
<tr>
<td>class</td>
<td>//*[@class=‘telA’]</td>
<td>.telA</td>
</tr>
<tr>
<td>属性</td>
<td>1.//*[text()==“xxx”] 2.//input[starts-with(@attribute,‘xxx’)] 3.//input[contains(@attribute,‘xxx’)]</td>
<td>1.input[type^=‘p’] 2.input[type$=‘d’ 3.input[type*=‘w’]</td>
</tr>
</tbody>
</table>
</div>
<p>通过css_selector定位，By.CSS_SELECTOR </p>
<p>当一个元素无法直接定位，也就是没有id，name等确定标识，这个时候我们需要考虑使用css selector定位器。</p>
<p>它是一种通过CSS样式选择器来定位元素的方法</p>
<p>CSS常用汇总</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>选择器</th>
<th>格式</th>
<th>示例</th>
<th>示例说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>标签选择器</td>
<td>html标签</td>
<td>input</td>
<td>选择所有<input>元素</td>
</tr>
<tr>
<td>ID选择器</td>
<td>#id属性值</td>
<td>#kw</td>
<td>选择所有id=’kw’的元素</td>
</tr>
<tr>
<td>类选择器</td>
<td>.class属性值</td>
<td>.nav-search-input</td>
<td>选择所有class=’nav-search-input’的元素</td>
</tr>
<tr>
<td>属性选择器1</td>
<td>[属性名]</td>
<td>[name=”wd”]</td>
<td>选择所有name等于”wd”的元素</td>
</tr>
<tr>
<td>组合选择器</td>
<td>标签加属性描述</td>
<td>input.s_ipt</td>
<td>选择所有class=’_ipt’的<input>元素</td>
</tr>
<tr>
<td>父子关系</td>
<td>元素1&gt;元素2</td>
<td>div&gt;a</td>
<td>选择所有父级是<div>的<a>元素</td>
</tr>
<tr>
<td>后代关系</td>
<td>元素1 元素2</td>
<td>div a</td>
<td>选择<div>中的所有<a>元素</td>
</tr>
<tr>
<td>第一子元素</td>
<td>:first-child</td>
<td>a:first-child</td>
<td>选择所有<a>元素且该元素是其父级的第一个元素</td>
</tr>
<tr>
<td>最后一个元素</td>
<td>:last-child</td>
<td>a:last-child</td>
<td>选择所有<a>元素且该元素是其父级的最后一个元素</td>
</tr>
<tr>
<td>顺序选择器</td>
<td>:nth-child(n)</td>
<td>a:nth-child(2)</td>
<td>选择所有<a>元素且该元素是其父级的第二个子元素</td>
</tr>
</tbody>
</table>
</div>
<p>●使用id属性定位，id前面要加#号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#kw&#x27;</span>).send_keys(<span class="string">&quot;软件测试老白&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>●通过class属性定位，class前面要加.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.bilibili.com&#x27;</span>)</span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;.nav-search-input&#x27;</span>).send_keys(<span class="string">&#x27;软件测试老白&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>●根据name属性定位，属性值为[name=”wd”]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;[name=&quot;wd&quot;]&#x27;</span>).send_keys(<span class="string">&quot;软件测试老白&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>●根据标签属性定位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;a[href=&quot;http://image.baidu.com/&quot;]&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 模糊匹配-包含</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;a[href*=&quot;image.baidu.com&quot;]&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 模糊匹配-匹配开头</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;a[href^=&quot;http://image.baidu&quot;]&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 模糊匹配-匹配结尾</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;a[href$=&quot;image.baidu.com/&quot;]&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<p>●组合定位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># input+name</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;input[name=&quot;wd&quot;]&#x27;</span>).send_keys(<span class="string">&quot;软件测试老白&quot;</span>)</span><br><span class="line"><span class="comment"># input+class</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;input.s_ipt&#x27;</span>).send_keys(<span class="string">&quot;软件测试老白&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>●定位子元素<br>一般根据最近一个id属性往下找，可以根据class或者标签。<br>#s-top-left &gt; a<br>:nth-child(3)代表第几个子元素，下标从1开始</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 百度首页新闻，以下三种方式皆可</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;div.s-top-left-new.s-isindex-wrap a&#x27;</span> ) <span class="comment"># 根据class</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;div#s-top-left a&#x27;</span>) <span class="comment"># 根据id</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#s-top-left a&#x27;</span>) <span class="comment"># 简写</span></span><br><span class="line"><span class="comment"># 百度首页地图，以下2种方式皆可</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#s-top-left a:nth-child(3)&#x27;</span>) </span><br><span class="line">driver.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;#s-top-left a&#x27;</span>)[<span class="number">2</span>] </span><br><span class="line"></span><br><span class="line"><span class="comment"># a:first-child 第一个标签</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#s-top-left a:first-child&#x27;</span>)</span><br><span class="line"><span class="comment"># a:last-child 最后一个标签</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#s-top-left a:last-child&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>当然 css selector选择器不止这些用法，还有这里只列举了一些重要的用法，当页面元素过多时，我们一般都会直接通过浏览器的复制功能。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># step1:导入Selenium WebDriver模块</span><br><span class="line">from selenium import webdriver</span><br><span class="line">import time</span><br><span class="line">for i in range(1,10):</span><br><span class="line">#step2: 创建驱动浏览器对象并启动浏览器</span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">#step3: 编写自动化执行步骤</span><br><span class="line">driver.maxmimize()</span><br><span class="line">driver.get(&quot;https://www.baidu.com&quot;)</span><br><span class="line">#清空文本框</span><br><span class="line">driver.find_element_by_xpath(&quot;//input[@id=&#x27;su&#x27;]&quot;).clear()</span><br><span class="line"># 输入内容     </span><br><span class="line">driver.find_element_by_xpath(&quot;//input[@id=&#x27;su&#x27;]&quot;).send_keys(&quot;百度一下&quot;)</span><br><span class="line"># 点击</span><br><span class="line">driver.find_element_by_xpath(&quot;//input[@name=&#x27;ss&#x27;]&quot;).click()</span><br><span class="line">time.sleep(5)</span><br><span class="line"># step4: 关闭驱动对象</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>
<p><strong>针对海盗商城的登录功能进行自动化测试</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.select <span class="keyword">import</span> Select</span><br><span class="line"><span class="comment"># 1、登录</span></span><br><span class="line">chrome = webdriver.Chrome()</span><br><span class="line">chrome.implicitly_wait(<span class="number">10</span>)  <span class="comment"># 由于页面稳定性较差，所以添加了一个隐式等待</span></span><br><span class="line">chrome.maximize_window()  <span class="comment"># 窗口最大化</span></span><br><span class="line">chrome.get(<span class="string">&#x27;http://129.211.129.101:9007/index.php?m=user&amp;c=public&amp;a=login&#x27;</span>)</span><br><span class="line"><span class="comment"># chrome.find_element_by_id(&#x27;username&#x27;).send_keys(&#x27;XieChuang&#x27;) 该命令的输入方式已经过期</span></span><br><span class="line">chrome.find_element(By.ID, <span class="string">&#x27;username&#x27;</span>).send_keys(<span class="string">&#x27;XieChuang&#x27;</span>)</span><br><span class="line">chrome.find_element(By.ID, <span class="string">&#x27;password&#x27;</span>).send_keys(<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line"><span class="comment"># chrome.find_element_by_class_name(&#x27;login_btn fl&#x27;).click() # 登录的类名是复合类名，不能同时使用，fl只是一个左对齐的作用</span></span><br><span class="line">chrome.find_element(By.CLASS_NAME, <span class="string">&#x27;login_btn&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 2、点击&#x27;进入商城购物&#x27;</span></span><br><span class="line"><span class="comment"># 登录成功后不是立马进行页面的，所以此处添加一个时间等待</span></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># 第三种元素定位方式，linktext</span></span><br><span class="line">chrome.find_element(By.LINK_TEXT, <span class="string">&#x27;进入商城购物&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 3、搜索&#x27;iphone&#x27;</span></span><br><span class="line">chrome.find_element(By.NAME, <span class="string">&#x27;keyword&#x27;</span>).send_keys(<span class="string">&#x27;小米6&#x27;</span>)</span><br><span class="line">chrome.find_element(By.CLASS_NAME, <span class="string">&#x27;btn1&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 4、点击商品图片</span></span><br><span class="line">chrome.find_element(By.XPATH, <span class="string">&#x27;/html/body/div[3]/div[2]/div[3]/div[2]/div[1]/a/img&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 5、窗口切换</span></span><br><span class="line"><span class="comment"># 1、找到新窗口的名字</span></span><br><span class="line">new_window = chrome.window_handles[-<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 2、切换到新窗口</span></span><br><span class="line">chrome.switch_to.window(new_window)</span><br><span class="line"><span class="comment"># 6、把选择的商品加入购物车</span></span><br><span class="line">chrome.find_element(By.ID, <span class="string">&#x27;joinCarButton&#x27;</span>).click()  <span class="comment"># 此时由于跳转了新窗口，所以无法进行操作</span></span><br><span class="line"><span class="comment"># 7、去购物车结算</span></span><br><span class="line">chrome.find_element(By.CLASS_NAME, <span class="string">&#x27;other_join&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 8、点击结算 css selector 定位方式:在两个class之前需要加.</span></span><br><span class="line">chrome.find_element(By.CSS_SELECTOR, <span class="string">&#x27;.shopCar_btn_03.fl&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 9、添加新地址</span></span><br><span class="line">chrome.find_element(By.CLASS_NAME, <span class="string">&#x27;add-address&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 10、填写收货人信息</span></span><br><span class="line">chrome.find_element(By.NAME, <span class="string">&#x27;address[address_name]&#x27;</span>).send_keys(<span class="string">&#x27;XC&#x27;</span>)</span><br><span class="line">chrome.find_element(By.NAME, <span class="string">&#x27;address[mobile]&#x27;</span>).send_keys(<span class="string">&#x27;15910100202&#x27;</span>)</span><br><span class="line"><span class="comment"># 11、选择地区的下拉框</span></span><br><span class="line">sheng=chrome.find_element(By.ID,<span class="string">&#x27;add-new-area-select&#x27;</span>)<span class="comment"># 将省这个下拉框进行实例化</span></span><br><span class="line">Select(sheng).select_by_visible_text(<span class="string">&#x27;北京市&#x27;</span>)<span class="comment"># 将实例化的下拉框进行类型强制转换成Select型，再使用下拉框的属性进行选择</span></span><br><span class="line"><span class="comment"># 12、选择收货地区--市 由于下拉框中的ID是动态变化的，且class name又是同名的，所以使用find_elements来找到相同class name，再使用标签名来组合</span></span><br><span class="line">shi=chrome.find_elements(By.CLASS_NAME,<span class="string">&#x27;add-new-area-select&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">Select(shi).select_by_visible_text(<span class="string">&#x27;北京市&#x27;</span>)</span><br><span class="line">qu=chrome.find_elements(By.TAG_NAME,<span class="string">&#x27;select&#x27;</span>)[<span class="number">2</span>] <span class="comment"># 使用标签名来定位</span></span><br><span class="line">Select(qu).select_by_visible_text(<span class="string">&#x27;海淀区&#x27;</span>)</span><br><span class="line">chrome.find_element(By.NAME, <span class="string">&#x27;address[address]&#x27;</span>).send_keys(<span class="string">&#x27;迈行大厦&#x27;</span>)</span><br><span class="line">chrome.find_element(By.NAME, <span class="string">&#x27;address[zipcode]&#x27;</span>).send_keys(<span class="string">&#x27;100000&#x27;</span>)</span><br><span class="line">chrome.find_element(By.CLASS_NAME,<span class="string">&#x27;aui_state_highlight&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<p>元素定位最佳顺序<br>1.ID（唯一标识）：如果元素具有唯一的ID属性，优先使用ID进行定位，因为它是最快和最可靠的定位方式。<br>2.CSS选择器：如果元素没有唯一的ID，可以考虑使用CSS选择器进行定位。CSS选择器具有灵活的语法，并且在性能上通常比XPath更高效。<br>3.类名（class）：如果元素没有唯一的ID或合适的CSS选择器，可以使用元素的类名进行定位。尽量选择具有明确含义的类名，并避免选择过于通用的类名。<br>4.Name属性：如果元素具有唯一的name属性，可以使用name属性进行定位。但要注意，name属性并不是所有元素都具有的，所以不是一种通用的定位方式。<br>5.XPath：如果前面的方式都无法定位元素，可以使用XPath进行定位。XPath提供了强大的定位功能，但在性能上相对较低，因为XPath需要遍历整个文档，直到找到匹配的元素。暂无性能对比数据，我觉得好用就用，及时行乐。<br>6.标签名（TagName）：如果元素无法使用上述方式进行定位，可以考虑使用标签名进行定位。但要注意，标签名定位方式通常会返回多个匹配的元素，需要结合其他条件来缩小范围。</p>
<h3 id="框"><a href="#框" class="headerlink" title="框"></a>框</h3><h4 id="单选框"><a href="#单选框" class="headerlink" title="单选框"></a>单选框</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element(By.XPATH,<span class="string">&#x27;//span[text()=&quot;Android&quot;]&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<h4 id="多选框"><a href="#多选框" class="headerlink" title="多选框"></a>多选框</h4><p>例子：选中 香蕉 苹果 西瓜：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element(By.XPATH,<span class="string">&#x27;//span[text()=&quot;香蕉&quot;]&#x27;</span>).click()</span><br><span class="line">driver.find_element(By.XPATH,<span class="string">&#x27;//span[text()=&quot;苹果&quot;]&#x27;</span>).click()</span><br><span class="line">driver.find_element(By.XPATH,<span class="string">&#x27;//span[text()=&quot;西瓜&quot;]&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<h4 id="下拉框"><a href="#下拉框" class="headerlink" title="下拉框"></a>下拉框</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select=Select(driver.find_element(By.ID, <span class="string">&#x27;s2&#x27;</span>))</span><br><span class="line">select.select_by_index(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h4 id="弹性框"><a href="#弹性框" class="headerlink" title="弹性框"></a>弹性框</h4><p><strong>确定弹窗</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#点击按钮弹出窗</span></span><br><span class="line">driver.find_element(By.NAME,<span class="string">&#x27;b1&#x27;</span>).click()</span><br><span class="line"><span class="comment">#使用alert.text获取弹框的文字</span></span><br><span class="line"><span class="built_in">print</span>(driver.switch_to.alert.text)</span><br><span class="line"><span class="comment">#点击确定</span></span><br><span class="line">driver.switch_to.alert.accept()</span><br></pre></td></tr></table></figure>
<p><strong>确定取消</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#点击按钮弹出窗</span></span><br><span class="line">driver.find_element(By.NAME,<span class="string">&#x27;b1&#x27;</span>).click()</span><br><span class="line"><span class="comment">#使用alert.text获取弹框的文字</span></span><br><span class="line"><span class="built_in">print</span>(driver.switch_to.alert.text)</span><br><span class="line"><span class="comment">#点击确定</span></span><br><span class="line">driver.switch_to.alert.accept()</span><br><span class="line"><span class="comment">#点击取消</span></span><br><span class="line">driver.switch_to.alert.dismiss()</span><br></pre></td></tr></table></figure>
<p><strong>输入确定</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#点击按钮弹出窗</span></span><br><span class="line">driver.find_element(By.NAME,<span class="string">&#x27;b1&#x27;</span>).click()</span><br><span class="line"><span class="comment">#弹性框输入文字</span></span><br><span class="line">driver.switch_to.alert.send_key(<span class="string">&quot;123&quot;</span>)</span><br><span class="line"><span class="comment">#点击确定</span></span><br><span class="line">driver.switch_to.alert.accept()</span><br></pre></td></tr></table></figure>
<h4 id="iframe框"><a href="#iframe框" class="headerlink" title="iframe框"></a>iframe框</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 找到 iframe 元素</span></span><br><span class="line">iframe_element = driver.find_element_by_css_selector(<span class="string">&quot;iframe-selector&quot;</span>)</span><br><span class="line"><span class="comment"># 切换到 iframe 上下文</span></span><br><span class="line">driver.switch_to.frame(iframe_element)</span><br><span class="line"><span class="comment"># 切回默认上下文</span></span><br><span class="line">driver.switch_to.default_content()</span><br></pre></td></tr></table></figure>
<p>如果在 iframe 上下文中完成了操作，想要切回到默认的上下文，可以使用 <code>switch_to.default_content</code> 方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换到第一个 iframe 上下文</span></span><br><span class="line">driver.switch_to.frame(<span class="number">0</span>)	</span><br><span class="line"><span class="comment"># 在第一个 iframe 上下文中执行操作</span></span><br><span class="line"><span class="comment"># 切回默认上下文</span></span><br><span class="line">driver.switch_to.default_content()</span><br><span class="line"><span class="comment"># 切换到第二个 iframe 上下文</span></span><br><span class="line">driver.switch_to.frame(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 在第二个 iframe 上下文中执行操作</span></span><br><span class="line"><span class="comment"># 切回默认上下文</span></span><br><span class="line">driver.switch_to.default_content()</span><br></pre></td></tr></table></figure>
<p>切换iframe的方法为：driver.switch_to.frame()，frame()中参数可以为id，name或者index，也可以为iframe元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">&#x27;https://sahitest.com/demo/iframesTest.htm&#x27;</span>)</span><br><span class="line">driver.find_element(By.ID,<span class="string">&#x27;checkRecord&#x27;</span>).clear()</span><br><span class="line">driver.find_element(By.ID,<span class="string">&#x27;checkRecord&#x27;</span>).send_keys(<span class="string">&quot;6666&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 切换至第—个iframe</span></span><br><span class="line">driver.switch_to.frame(<span class="number">0</span>)</span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;open-self&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<p>编写本地代码，实现frame带id和name。</p>
<p>复制 sahitest 的iframe源码，src更改为哗哩哗哩网址。设置第一个iframe，id为iframe1，name为iframe_name </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开本地的html文件，前面要加fiLe：//</span></span><br><span class="line">driver.get(<span class="string">&quot;file:///Users/tester/Documents/web自动化测试/WebAutoTest/HTML/iframe_1.html&quot;</span>)</span><br><span class="line">driver.find_element(By.ID,<span class="string">&quot;checkRecord&quot;</span>).clear()</span><br><span class="line">driver.find_element(By.ID, <span class="string">&quot;checkRecord&quot;</span>).send_keys(<span class="string">&quot;666&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># 用下标driver.switch_to.frame(1)</span></span><br><span class="line">driver.find_element(By.ID,<span class="string">&#x27;open-self&#x27;</span>).click()</span><br><span class="line"><span class="comment">#用name# </span></span><br><span class="line">driver.switch_to.frame(<span class="string">&quot;iframe_name&quot;</span>)</span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//span[text()=&quot;番剧&quot;]&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<p>最后是根据定位iframe元素进行切换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">&#x27;https://sahitest.com/demo/iframesTest.htm&#x27;</span>)</span><br><span class="line">driver.find_element(By.ID,<span class="string">&#x27;checkRecord&#x27;</span>).clear()</span><br><span class="line">driver.find_element(By.ID,<span class="string">&#x27;checkRecord&#x27;</span>).send_keys(<span class="string">&quot;6666&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 先定位到iframe，在switch_to到指定元素</span></span><br><span class="line">ele = driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;div#another iframe&#x27;</span>)</span><br><span class="line">driver.switch_to.frame(ele)</span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;open-self&#x27;</span>).click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入iframe</span></span><br><span class="line">ele = driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;body &gt; iframe&quot;</span>)</span><br><span class="line">driver.switch_to.frame(ele)</span><br><span class="line"><span class="comment"># 退出iframe，切换到上一级</span></span><br><span class="line">driver.switch_to.parent_frame()</span><br><span class="line"><span class="comment"># 切换到主界面</span></span><br><span class="line">driver.switch_to.default_content()</span><br></pre></td></tr></table></figure>
<h4 id="级联日期选择器"><a href="#级联日期选择器" class="headerlink" title="级联日期选择器"></a>级联日期选择器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element(By.XPATH,<span class="string">&#x27;//input[@class=&quot;ivu-input ivu-input-default&quot;]&#x27;</span>).click()</span><br><span class="line">driver.find_element(By.XPATH,<span class="string">&#x27;//Li[contains(text(),&quot;北京&quot;)]&#x27;</span>).click()</span><br><span class="line">driver.find_element(By.XPATH,<span class="string">&#x27;//Li[contains(text(),&quot;王府井&quot;)]&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><h4 id="上传"><a href="#上传" class="headerlink" title="上传"></a>上传</h4><p>不推荐此方法—-绝对路径（使用较少）:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取input文件上传元素</span></span><br><span class="line">upload = driver.find_element(By.ID, <span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">upload.send_keys(<span class="string">r&quot;/Users/tester/Documents/web自动化测试/WebAutoTest/file/Logo.jpg&quot;</span>)</span><br><span class="line">driver.find_element(By.NAME, <span class="string">&#x27;submit&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<p>推荐此方法—-相对路径（使用较多）:</p>
<p>项目目录下建立—-utils文件包：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_logo_path</span>():</span><br><span class="line">    path = os.path.join(os.path.dirname(os.path.dirname(os.path.realpath(__file__))),<span class="string">&quot;file&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> path</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> utils.get_filepath <span class="keyword">import</span> get_logo_path</span><br><span class="line"></span><br><span class="line">path = get_logo_path()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取input文件上传元素</span></span><br><span class="line">upload = driver.find_element(By.ID, <span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">upload.send_keys(<span class="string">r&quot;&#123;&#125;&quot;</span>.<span class="built_in">format</span>(path))</span><br><span class="line">driver.find_element(By.NAME, <span class="string">&#x27;submit&#x27;</span>).click()</span><br></pre></td></tr></table></figure>
<h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p>项目目录下建立—-utils文件包：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download_file_path</span>():</span><br><span class="line">    path = os.path.join(os.path.dirname(os.path.dirname(os.path.realpath(__file__))),<span class="string">&quot;file&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> path</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> utils.get_filepath <span class="keyword">import</span> download_file_path</span><br><span class="line"></span><br><span class="line">path = download_file_path() + <span class="string">&quot;/LATEST_RELEASE&quot;</span></span><br><span class="line"><span class="keyword">if</span> os.path.exists(path):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;文件存在&quot;</span>)</span><br><span class="line">    os.remove(path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;文件已删除&quot;</span>)</span><br><span class="line"></span><br><span class="line">chromeOptions = webdriver.Chromeoptions()</span><br><span class="line">prefs = &#123;<span class="string">&quot;download.default_directory&quot;</span>: <span class="string">&quot;&#123;&#125;&quot;</span>.<span class="built_in">format</span>(download_file_path())&#125;</span><br><span class="line">chromeOptions.add_experimental_option(<span class="string">&quot;prefs&quot;</span>, prefs)</span><br><span class="line">driver = webdriver.Chrome(chromeOptions)</span><br><span class="line"></span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;/html/body/table/tbody/tr[156]/td[2]/a&#x27;</span>).click()</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><h4 id="验证码"><a href="#验证码" class="headerlink" title="验证码"></a>验证码</h4><p>一、验证码在自动化测试过程中如何处理</p>
<p>1、找开发屏蔽或测试跳过</p>
<p>2、找开发置为默认或万能码</p>
<p>3、使用cookie跳过，使用抓包工具或代码保存</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#访问xxxx网站</span></span><br><span class="line">driver.get(<span class="string">&quot;http://www.xxxx.cn/&quot;</span>)</span><br><span class="line"><span class="comment">#将用户名密码写入浏览器cookie</span></span><br><span class="line">driver.add_cookie(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;Login_UserNumber&#x27;</span>, <span class="string">&#x27;value&#x27;</span>:<span class="string">&#x27;username&#x27;</span>&#125;)</span><br><span class="line">driver.add_cookie(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;Login_Passwd&#x27;</span>, <span class="string">&#x27;value&#x27;</span>:<span class="string">&#x27;password&#x27;</span>&#125;)</span><br><span class="line"><span class="comment">#再次访问xxxx网站，将会自动登录</span></span><br><span class="line">driver.get(<span class="string">&quot;http://www.xxxx.cn/&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>4、使用pytesserac和Pillow实现验证码识别</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">使用pytesseract模块和pillow模块解决安装</span><br><span class="line">pytesseract模块</span><br><span class="line">pip3 install pytesseract</span><br><span class="line">安装Pillow</span><br><span class="line">pip3 install pillow</span><br></pre></td></tr></table></figure>
<p>2.网站验证码解决思路</p>
<ul>
<li><p>截屏整个页面</p>
</li>
<li><p>获得验证码坐标数据</p>
</li>
<li><p>根据坐标数据抠图</p>
</li>
<li><p>使用pytesseract模块进行验证</p>
</li>
</ul>
<p>可以使用pytesseract 模块和 PIL 模块解决不太复杂的验证码问题，实现步骤如下：</p>
<ul>
<li>安装pytesseract模块 pip install pytesseract</li>
<li>安装 PIL 模块 pip install pil</li>
</ul>
<p><strong>使用第三方的API来实现</strong></p>
<p>对于复杂的验证码，我们可以使用第三方的API来实现，本节我们将使用一个名为：万维易源的APl来解决验证码问题，网址是：<a target="_blank" rel="noopener" href="https://www.showapi.com/">https://www.showapi.com/</a></p>
<p>识别验证码的地址是：<a target="_blank" rel="noopener" href="https://www.showapi.com/api/lookPoint">https://www.showapi.com/api/lookPoint</a></p>
<p>ddddocr是Python第三方库，识别度高达99%</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple ddddocr</span><br></pre></td></tr></table></figure>
<h4 id="等待"><a href="#等待" class="headerlink" title="等待"></a>等待</h4><p>Selenium 三种等待方式在UI自动化测试中，必然会遇到环境不稳定，网络慢的情况，这时如果不做任何处理的话，代码会由于没有找到元素而报错。另外，一种情况就是页面使用ajax 异步加载机制。这时我们就要用到wait，而在 Selenium 中，我们可以用到一共三种等待，每一种等待都有自已的优点或缺点。</p>
<p><strong>time.sleep（固定等待）</strong></p>
<p>​     在开发自动化框架过程中，最忌讳使用python 自带模块的time 的sleep 方式进行等待，虽然可以自定义等待时间，但当网络条件良好时，依旧按照预设定的时间继续等待，导致整个项目的自动化时间无限延长，不建议使用。</p>
<p>(注：脚本调试过程时，还是可以使用的，方便快捷)</p>
<p><strong>implicitly_wait（隐式等待）</strong></p>
<p>​     隐式等待实际是设置了一个最长等待时间，如果在规定时间内网页加载完成，则执行下一步，否则一直等到时间结束，然后执行下一步。这样的隐式等待会有个坑，我们都知道 JavaScript一般都是放在我们的 body的最后进行加载，实际这是页面上的元素都已经加载完毕，我们却还在等待全部页面加载结束。</p>
<p>（注：隐式等待对整个driver周期都起作用，在最开始设置一次就可以了。不要当作固定等待使用，到哪都来一下隐式等待。）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test_wait</span>(<span class="params">self</span>):</span><br><span class="line">	self.drive.implicitly_wait(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<p><strong>WebDriverWait（显式等待）(推荐)</strong></p>
<p>​      WebDriverWait是selenium提供得到显示等待模块引入路径：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.support.wait <span class="keyword">import</span> WebDriverWait</span><br></pre></td></tr></table></figure>
<p><strong>WebDriverWait参数</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">#</th>
<th style="text-align:center">参数</th>
<th style="text-align:center">参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">driver</td>
<td style="text-align:center">传入WebDriver实例</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">timeout</td>
<td style="text-align:center">超时时间，等待的最长时间</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">poll_frequency</td>
<td style="text-align:center">调用until或unti_not中的方法的间隔时间，默认是o.5秒</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">ignored_exceptions</td>
<td style="text-align:center">忽略的异常</td>
</tr>
</tbody>
</table>
</div>
<p>这个模块中，一共只有两种方法 until与until_not。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">#</th>
<th style="text-align:center">参数</th>
<th style="text-align:center">参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">method</td>
<td style="text-align:center">在等待期间，每隔一段时间调用这个传入的方法，直到返回值不是False</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">message</td>
<td style="text-align:center">如果超时，抛出TimeoutException，将message传入异常</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.support import expected_conditions as EC</span><br><span class="line"></span><br><span class="line">def test_wait(self):</span><br><span class="line">	# WebDriverWait(self.drive,2)</span><br><span class="line">	wait = WebDriverWait(self.drive,2)</span><br><span class="line">	wait.until(EC.title_is(&#x27;百度一下&#x27;))</span><br><span class="line">	</span><br><span class="line">if __name__ = &#x27;__main__&#x27;:</span><br><span class="line">	case.test_wait()</span><br></pre></td></tr></table></figure>
<h4 id="鼠标键盘"><a href="#鼠标键盘" class="headerlink" title="鼠标键盘"></a><strong>鼠标键盘</strong></h4><p>Selenium中的鼠标和键盘事件被封装在ActionChains类中，正确的使用方法是：ActionChains(driver).click(btn).perform（）</p>
<p>下面列出ActionChains中常用方法：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">#</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">方法描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">click(on_element=None)</td>
<td style="text-align:center">单击鼠标左键</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">click_and_hold(on_element=None)</td>
<td style="text-align:center">点击鼠标左键，不松开</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">context_click(on_element=None)</td>
<td style="text-align:center">点击鼠标右键</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">double_click(on_element=None)</td>
<td style="text-align:center">双击鼠标左键</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">drag_and_drop(source,target)</td>
<td style="text-align:center">拖拽到某个元素然后松开</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">drag_and_drop_by_offset(source,xoffset,yoffset)</td>
<td style="text-align:center">拖拽到某个坐标然后松开</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">key_down(value,element=None)</td>
<td style="text-align:center">按下某个键盘上的键</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">key_up(value,element=None)</td>
<td style="text-align:center">松开某个键</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">move_by_offset(xoffset,yoffset)</td>
<td style="text-align:center">鼠标从当前位置移动到某个坐标</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">move_to_element(to_element)</td>
<td style="text-align:center">鼠标移动到某个元素</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">move_to_element_with_offset(to_element,xoffset, yoffset)</td>
<td style="text-align:center">移动到距某个元素（左上角坐标）多离的位置</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">perform()</td>
<td style="text-align:center">执行链中的所有动作</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:center">release(on_element=None)</td>
<td style="text-align:center">在某个元素位置松开鼠标左键</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">send_keys(*keys_to_send)</td>
<td style="text-align:center">发送某个键到当前焦点的元素</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center">send_keys_to_element(element,*keys_to_send)</td>
<td style="text-align:center">发送某个键到指定元素</td>
</tr>
</tbody>
</table>
</div>
<p>例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">btn = driver.find_element_by_xpath(<span class="string">&quot;/html/body/form/input[3]&quot;</span>)</span><br><span class="line"><span class="comment"># 鼠标单击</span></span><br><span class="line">ActionChains(driver).click(on_element=btn).perform()</span><br><span class="line">btn = driver.find_element_by_xpath(<span class="string">&quot;/html/body/form/input[2]&quot;</span>)</span><br><span class="line"><span class="comment"># 鼠标双击</span></span><br><span class="line">ActionChains(driver).double_click(btn).perform()</span><br><span class="line">btn = driver.find_element_by_xpath(<span class="string">&quot;/html/body/form/input[4]&quot;</span>)</span><br><span class="line"><span class="comment"># 点击鼠标右键</span></span><br><span class="line">ActionChains(driver).context_click(btn).perform()</span><br><span class="line"><span class="comment">#拖拽元素到指定位置</span></span><br><span class="line">ele4 = driver.find_element_by_css_selector(<span class="string">&quot;//*[@id=&#x27;conar&#x27;]/div/div/div/table/tbody[1]/tr[1]/td[1]/span/a&quot;</span>)</span><br><span class="line">target = driver.find_element_by_css_selector(<span class="string">&#x27;#kw&#x27;</span>)</span><br><span class="line">ActionChains(driver).drag_and_drop(ele4,target).perform()</span><br><span class="line"><span class="comment">#在元素上按下鼠标左键并释放</span></span><br><span class="line">ele5 = driver.find_element_by_css_selector(<span class="string">&#x27;#kw&#x27;</span>)</span><br><span class="line">ActionChains(driver).click_and_hold(ele5).release().perform()</span><br></pre></td></tr></table></figure>
<p><strong>键盘事件</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">kw = driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>)</span><br><span class="line">kw.send_keys(<span class="string">&quot;selenium&quot;</span>)</span><br><span class="line"><span class="comment"># 全选</span></span><br><span class="line">kw.send_keys(Keys.CONTROL, <span class="string">&quot;a&quot;</span>)</span><br><span class="line"><span class="comment"># 复制</span></span><br><span class="line">kw.send_keys(Keys.CONTROL, <span class="string">&quot;c&quot;</span>)</span><br><span class="line"><span class="comment"># 剪切</span></span><br><span class="line">kw.send_keys(Keys.CONTROL, <span class="string">&quot;x&quot;</span>)</span><br><span class="line"><span class="comment"># 粘贴</span></span><br><span class="line">kw.send_keys(Keys.CONTROL, <span class="string">&quot;v&quot;</span>)</span><br><span class="line"><span class="comment"># 删除键</span></span><br><span class="line">kw.send_keys(Keys.DELETE)</span><br><span class="line"><span class="comment"># 回车键</span></span><br><span class="line">kw.send_keys(Keys.ENTER)</span><br><span class="line"><span class="comment"># 后退键</span></span><br><span class="line">kw.send_keys(Keys.BACKSPACE)</span><br><span class="line"><span class="comment"># tab 键</span></span><br><span class="line">kw.send_keys(Keys.TAB)</span><br><span class="line"><span class="comment"># 刷新</span></span><br><span class="line">kw.send_keys(Keys.F5)</span><br></pre></td></tr></table></figure>
<h4 id="滚动条"><a href="#滚动条" class="headerlink" title="滚动条"></a>滚动条</h4><p><strong>Selenium 执行 JavaScript 脚本</strong></p>
<p>在web自动化，经常会遇到页面显示内容太多的时候，页面就会出现滚动条，一般有两种方式进行下拉，一种是直接下拉到底部/顶部/中部，或者直接给定元素，直接下拉到指定元素的位置。</p>
<p>WebDriver有两个方法来执行JavaScript，分别是：</p>
<ul>
<li><p>execute_seript 同步执行</p>
</li>
<li><p>execute_async_script 异步执行</p>
</li>
</ul>
<p>通过 JavaScript 通常可以实现页面滚动，下面通过实例来演示一下他们的用法：</p>
<p>两种方式，都是通过selenium框架，执行js代码的方式来实现，只是传递的js代码不一样:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.driver.execute_script(js)</span><br></pre></td></tr></table></figure>
<p>第一种：自定义直接下拉到顶部或底部，根据需要进行选择</p>
<p>滚动到底部：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.scrollTo(<span class="number">0</span>, document.body.scrollHeight);</span><br><span class="line">self.driver.execute_script(<span class="string">&quot;window.scrollTo(0, document.body.scrollHeight);&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>滚动到页面中间：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pywindow.scrollTo(<span class="number">0</span>, document.body.scrollHeight/<span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<p>滚动到页面顶部：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.scrollTo(<span class="number">0</span>, document.body.scrollHeight/document.body.scrollHeight);</span><br><span class="line">self.driver.execute_script(<span class="string">&quot;window.scrollTo(0, 0);&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>指定位置的下滑或上滑：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定向下滑动500像素</span></span><br><span class="line">self.driver.execute_script(<span class="string">&quot;window.scrollBy(0, 500);&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定向上滑动500像素</span></span><br><span class="line">self.driver.execute_script(<span class="string">&quot;window.scrollBy(0, -500);&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定向下滑动到指定元素位置</span></span><br><span class="line">target_element = self.driver.find_element_by_id(<span class="string">&quot;target-element-id&quot;</span>)</span><br><span class="line">self.driver.execute_script(<span class="string">&quot;arguments[0].scrollIntoView();&quot;</span>, target_element)</span><br></pre></td></tr></table></figure>
<p>实现逐渐下滑而没有停顿的效果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入所需模块</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义执行 JavaScript 的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scroll_to_bottom</span>(<span class="params">driver</span>):</span><br><span class="line">    <span class="comment"># 获取页面高度</span></span><br><span class="line">    page_height = driver.execute_script(<span class="string">&quot;return document.body.scrollHeight&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 定义滚动函数</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">scroll</span>():</span><br><span class="line">        <span class="comment"># 获取当前滚动位置</span></span><br><span class="line">        current_scroll = driver.execute_script(<span class="string">&quot;return window.pageYOffset&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算下一帧的滚动位置</span></span><br><span class="line">        next_scroll = current_scroll + <span class="number">10</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 如果未滚动到页面底部，则继续滚动</span></span><br><span class="line">        <span class="keyword">if</span> next_scroll &lt; page_height:</span><br><span class="line">            driver.execute_script(<span class="string">f&quot;window.scrollTo(0, <span class="subst">&#123;next_scroll&#125;</span>);&quot;</span>)</span><br><span class="line">            driver.execute_script(<span class="string">&quot;window.requestAnimationFrame(arguments[0]);&quot;</span>, scroll)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 执行首帧滚动</span></span><br><span class="line">    driver.execute_script(<span class="string">&quot;window.requestAnimationFrame(arguments[0]);&quot;</span>, scroll)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 等待一段时间，确保滚动完成</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test2</span>(<span class="params">self</span>):</span><br><span class="line">	js=<span class="string">&#x27;return document.title&#x27;</span></span><br><span class="line">	title = self.driver.execute_script(js)</span><br><span class="line">	<span class="built_in">print</span>(title)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test3</span>(<span class="params">self</span>):</span><br><span class="line">	js=<span class="string">&#x27;var q = document.getElementById(&quot;kw&quot;);q.style.border=&quot;2px solid red&quot;</span></span><br><span class="line"><span class="string">	self.driver.execute_script(js)</span></span><br><span class="line"><span class="string">	</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">wait_for_window</span>(<span class="params">self, timeout=<span class="number">2</span></span>):</span><br><span class="line">    time.sleep(<span class="built_in">round</span>(timeout / <span class="number">1000</span>))</span><br><span class="line">    wh_now = self.driver.window_handles</span><br><span class="line">    wh_then = self.<span class="built_in">vars</span>[<span class="string">&quot;window_handles&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(wh_now) &gt; <span class="built_in">len</span>(wh_then):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">set</span>(wh_now).difference(<span class="built_in">set</span>(wh_then)).pop()</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 下滑页面底部</span></span><br><span class="line">self.driver.execute_script(<span class="string">&quot;window.scrollTo(0, document.body.scrollHeight);&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">scroll_to</span>(<span class="params">self, <span class="built_in">type</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    移动浏览器的滚动条，滚动屏幕到百分比的位置</span></span><br><span class="line"><span class="string">    目前分为移动到末尾、移动到中间、移动到顶部。以及每次移动1/5，这种只能使用于浏览器的滚动条不在body里面，若有修改过滚动条的属性，无法进行下滑</span></span><br><span class="line"><span class="string">    :param type:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;end&#x27;</span>:</span><br><span class="line">        <span class="comment"># 移动到末尾</span></span><br><span class="line">        js = <span class="string">&quot;window.scrollTo(0, document.body.scrollHeight);&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;middle&#x27;</span>:</span><br><span class="line">        <span class="comment"># 移动到中间</span></span><br><span class="line">        js = <span class="string">&quot;window.scrollTo(0, document.body.scrollHeight/2);&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;top&#x27;</span>:</span><br><span class="line">        <span class="comment"># 移动到顶部</span></span><br><span class="line">        js = <span class="string">&quot;window.scrollTo(0, document.body.scrollHeight/document.body.scrollHeight);&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 暂时设置移动 1/5</span></span><br><span class="line">        js = <span class="string">&quot;window.scrollTo(0, document.body.scrollHeight/5);&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        self.driver.execute_script(js)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        mylog.exception(<span class="string">&quot;scroll_to_移动屏幕到&#123;0&#125;失败，请检查&#123;1&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">type</span>, e))</span><br><span class="line">        self.save_imgs(model=<span class="built_in">type</span>)</span><br><span class="line">        <span class="keyword">raise</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 Chrome 浏览器实例</span></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开目标网页</span></span><br><span class="line">driver.get(<span class="string">&quot;https://example.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取需要滚动的元素</span></span><br><span class="line">target_element = driver.find_element_by_css_selector(<span class="string">&quot;#target-element&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个 ActionChains 对象</span></span><br><span class="line">actions = ActionChains(driver)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 ActionChains 执行缓动下滑操作</span></span><br><span class="line">actions.move_to_element(target_element).perform()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭浏览器</span></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>
<h4 id="屏幕截屏"><a href="#屏幕截屏" class="headerlink" title="屏幕截屏"></a>屏幕截屏</h4><p><strong>Selenium屏幕截图</strong></p>
<p>WebDriver内置了一些在测试中捕获屏幕并保存的方法：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">#</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">方法描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">save_screenshot(filename)</td>
<td style="text-align:center">获取当前屏幕截图并保存为指定文件，filename指指定保存的路径或者图片的文件名</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">get_screenshot_as_base64()</td>
<td style="text-align:center">获取当前屏幕截图base65编码字符串</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">get_screenshot_as_file(fimename)</td>
<td style="text-align:center">获取当前的屏幕截图，使用完整的路径</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">get_screenshot_as_png()</td>
<td style="text-align:center">获取当前屏幕截图的二进制文件数据</td>
</tr>
</tbody>
</table>
</div>
<p>全屏截图：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">driver.save_screenshot(<span class="string">&#x27;screenshot.png&#x27;</span>)</span><br><span class="line"><span class="comment"># 截取屏幕截图并保存为文件</span></span><br><span class="line">driver.get_screenshot_as_file(<span class="string">&quot;screenshot.png&quot;</span>)</span><br><span class="line"><span class="comment"># 截取屏幕截图并保存为时间命名文件</span></span><br><span class="line">st=strftime(<span class="string">&quot;%Y-%m-%d-%H-%M-%S&quot;</span>,localtime(time()))</span><br><span class="line">fime_name = st+<span class="string">&#x27;.png&#x27;</span></span><br><span class="line">self.driver.save_screenshot(fime_name)</span><br><span class="line"><span class="comment"># 保存屏幕截图到目录下</span></span><br><span class="line">path = os.path.abspath(<span class="string">&#x27;scrennshot&#x27;</span>)</span><br><span class="line">file_path = path+<span class="string">&#x27;/&#x27;</span>+fime_name</span><br><span class="line">self.driver.get_screenshot_as_file(file_path)</span><br></pre></td></tr></table></figure>
<p>获取当前屏幕截图base65编码字符串：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取当前屏幕截图的 Base64 编码字符串</span></span><br><span class="line">screenshot_base64 = driver.get_screenshot_as_base64()</span><br></pre></td></tr></table></figure>
<p>获取当前屏幕截图的二进制文件数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取当前屏幕截图的二进制文件数据</span></span><br><span class="line">screenshot_data = driver.get_screenshot_as_png()</span><br></pre></td></tr></table></figure>
<p>屏幕截图示例（代码肯定会报错的哈，这里是为了演示测试失败时，自动截图的功能（比如有的时候弹出不应该有的警告或者错误信息什么的，就可以截图保留记录)）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoSuchElementException</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Login</span>(unittest.TestCase):</span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUpClass</span>(<span class="params">cls</span>):</span><br><span class="line">        cls.driver = webdriver.Chrome()</span><br><span class="line">        cls.driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">        cls.driver.maximize_window()</span><br><span class="line">       cls.driver.get(<span class="string">&quot;https://www.cnblogs.com/&quot;</span>)</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">test_login</span>(<span class="params">self</span>):</span><br><span class="line">       <span class="keyword">try</span>:</span><br><span class="line">           login_area = self.driver.find_element_by_css_selector(<span class="string">&#x27;#login_area&#x27;</span>)</span><br><span class="line">           register = login_area.find_element_by_link_text(<span class="string">&#x27;注册111&#x27;</span>)</span><br><span class="line">           register.click()</span><br><span class="line">       <span class="keyword">except</span> NoSuchElementException:</span><br><span class="line">           <span class="comment">#找不到元素时，截图</span></span><br><span class="line">           self.driver.save_screenshot(<span class="string">&#x27;image/test_login/test_login_area.png&#x27;</span>)</span><br><span class="line">           <span class="keyword">raise</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">   @classmethod</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">tearDownClass</span>(<span class="params">cls</span>):</span><br><span class="line">       cls.driver.quit()</span><br></pre></td></tr></table></figure>
<h4 id="PyAutoGUI"><a href="#PyAutoGUI" class="headerlink" title="PyAutoGUI"></a>PyAutoGUI</h4><p><code>PyAutoGUI</code>是一种跨平台的GUI自动化工具，它接管了鼠标、键盘使用权，基本上是完全仿照人的操作。</p>
<p><strong>PyAutoGUI的主要功能</strong></p>
<ul>
<li>鼠标操作：PyAutoGUI可以模拟鼠标移动、点击、拖拽等操作，可以控制鼠标的位置和点击的坐标。</li>
<li>键盘操作：PyAutoGUI可以模拟键盘按键和组合键的操作，如按下和释放按键、输入文本等。</li>
<li>屏幕操作：PyAutoGUI可以获取屏幕的大小、截屏、查找指定图像的位置等。</li>
<li>延时控制：PyAutoGUI可以控制鼠标和键盘操作的延时，以确保操作的正确性和稳定性。</li>
</ul>
<p>1.<code>pyautogui</code>：官方文档</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://pyautogui.readthedocs.org/</span><br></pre></td></tr></table></figure>
<p>2.安装安装pyautogui</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip install pyautogui</span><br><span class="line">python.exe -m pip install --upgrade pip</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>GUI 控制功能</strong></p>
<p>​    控制鼠标键盘使用的模块为：<strong>pyautogui</strong>，这个模块操作起鼠标键盘的时候，非常的迅速，而且如果该模块控制了鼠标后，程序比较难关闭，这时我们有两个方法专门针对以上的情况：</p>
<p><strong>自动防故障功能</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.FAILSAFE =<span class="literal">False</span></span><br></pre></td></tr></table></figure>
<p>默认这项功能为True, 这项功能意味着：当鼠标的指针在屏幕的最坐上方，程序会报错；目的是为了防止程序无法停止；</p>
<p><strong>停顿功能</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.PAUSE = <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>意味着所有<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=pyautogui&amp;spm=1001.2101.3001.7020">pyautogui</a>的指令都要暂停一秒；其他指令不会停顿；这样做，可以防止键盘鼠标操作太快；</p>
<p><strong>鼠标操作</strong></p>
<p><strong>控制鼠标移动</strong></p>
<p><strong>获得屏幕分辨率</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 返回所用显示器的分辨率； </span></span><br><span class="line"><span class="comment"># 输出：Size(width=1920, height=1080)</span></span><br><span class="line"><span class="built_in">print</span>(pyautogui.size())</span><br><span class="line">width,height = pyautogui.size()</span><br><span class="line"><span class="built_in">print</span>(width,height)  </span><br><span class="line"><span class="comment"># 1920 1080</span></span><br></pre></td></tr></table></figure>
<p><strong>移动鼠标</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.moveTo(<span class="number">100</span>,<span class="number">300</span>,duration=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 按方向移动，左右正负值对应右左，上下正负值对应下上</span></span><br><span class="line"><span class="comment"># moveRel()：这是PyAutoGUI库中的一个函数，用于模拟相对于当前鼠标位置的移动操作。</span></span><br><span class="line"><span class="comment"># 第一个参数是左右移动像素值，第二个是上下，向右移动100px，向下移动500px, 这个过程持续 1 秒钟；</span></span><br><span class="line">pyautogui.moveRel(<span class="number">100</span>,<span class="number">500</span>,duration=<span class="number">1</span>)   </span><br></pre></td></tr></table></figure>
<p><strong>获取鼠标位置</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(pyautogui.position())   </span><br><span class="line"><span class="comment"># 得到当前鼠标位置；输出：Point(x=200, y=800)</span></span><br></pre></td></tr></table></figure>
<p><strong>控制鼠标点击</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 点击鼠标</span></span><br><span class="line">pyautogui.click(<span class="number">10</span>,<span class="number">10</span>)   <span class="comment"># 鼠标点击指定位置，默认左键</span></span><br><span class="line">pyautogui.click(<span class="number">10</span>,<span class="number">10</span>,button=<span class="string">&#x27;left&#x27;</span>)  <span class="comment"># 单击左键</span></span><br><span class="line">pyautogui.click(<span class="number">1000</span>,<span class="number">300</span>,button=<span class="string">&#x27;right&#x27;</span>)  <span class="comment"># 单击右键</span></span><br><span class="line">pyautogui.click(<span class="number">1000</span>,<span class="number">300</span>,button=<span class="string">&#x27;middle&#x27;</span>)  <span class="comment"># 单击中间</span></span><br><span class="line"><span class="comment"># 双击鼠标</span></span><br><span class="line">pyautogui.doubleClick(<span class="number">10</span>,<span class="number">10</span>)  <span class="comment"># 指定位置，双击左键</span></span><br><span class="line">pyautogui.rightClick(<span class="number">10</span>,<span class="number">10</span>)   <span class="comment"># 指定位置，双击右键</span></span><br><span class="line">pyautogui.middleClick(<span class="number">10</span>,<span class="number">10</span>)  <span class="comment"># 指定位置，双击中键</span></span><br><span class="line"><span class="comment"># 点击 &amp; 释放</span></span><br><span class="line">pyautogui.mouseDown()   <span class="comment"># 鼠标按下</span></span><br><span class="line">pyautogui.mouseUp()    <span class="comment"># 鼠标释放</span></span><br></pre></td></tr></table></figure>
<p><strong>控制鼠标拖动</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拖动到指定位置</span></span><br><span class="line">pyautogui.dragTo(<span class="number">100</span>,<span class="number">300</span>,duration=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>将鼠标拖动到指定的坐标；duration 的作用是设置移动时间，所有的gui函数都有这个参数，而且都是可选参数；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按方向拖动</span></span><br><span class="line"><span class="comment"># 向右拖动100px，向下拖动500px, 这个过程持续 1 秒钟；</span></span><br><span class="line">pyautogui.dragRel(<span class="number">100</span>,<span class="number">500</span>,duration=<span class="number">4</span>)   <span class="comment"># 第一个参数是左右移动像素值，第二个是上下，</span></span><br></pre></td></tr></table></figure>
<p><strong>控制鼠标滚动</strong></p>
<p>控制鼠标滚动的函数是scroll()， 传入一个整数的参数，说明向上或向下滚动多少个单位；单位根据操作系统不同而不同；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 向上滚动300个单位；</span></span><br><span class="line">pyautogui.scroll(<span class="number">300</span>)</span><br></pre></td></tr></table></figure>
<p><strong>屏幕处理</strong></p>
<p><strong>获取屏幕截图</strong></p>
<p>我们控制鼠标的操作，不能盲目的进行，所以我们需要监控屏幕上的内容，从而决定要不要进行对应的操作， pyautogui 提供了一个方法screenshot()，可以返回一个Pillow的image对象；<br>这里有三个常用函数：</p>
<ul>
<li><strong>im = pyautogui.screenshot()</strong>：返回屏幕的截图，是一个Pillow的image对象</li>
<li><strong>im.getpixel((500, 500))</strong>：返回im对象上，（500，500）这一点像素的颜色，是一个RGB元组</li>
<li><strong>pyautogui.pixelMatchesColor(500,500,(12,120,400))</strong> ：是一个对比函数，对比的是屏幕上（500，500）这一点像素的颜色，与所给的元素是否相同；</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 保存屏幕截图；</span></span><br><span class="line">im = pyautogui.screenshot()</span><br><span class="line">im.save(<span class="string">&#x27;屏幕截图.png&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>识别图像</strong></p>
<p>首先，我们需要先获得一个屏幕快照，例如我们想要点赞，我们就先把大拇指的图片保存下来；然后使用函数：locateOnScreen(‘zan.png’) ，如果可以找到图片，则返回图片的位置，如：Box(left=25, top=703, width=22, height=22)；如果找不到图片，则返回None;如果，屏幕上有多处图片可以匹配，则需要使用locateAllOnScreen(‘zan.png’) ，如果匹配到多个值，则返回一个list，参考如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line">pyautogui.PAUSE = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 图像识别（一个）</span></span><br><span class="line">btm = pyautogui.locateOnScreen(<span class="string">&#x27;zan.png&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(btm)  <span class="comment"># Box(left=1280, top=344, width=22, height=22)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 图像识别（多个）</span></span><br><span class="line">btm = pyautogui.locateAllOnScreen(<span class="string">&#x27;zan.png&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(btm))  <span class="comment"># [Box(left=1280, top=344, width=22, height=22), Box(left=25, top=594, width=22, height=22)]</span></span><br></pre></td></tr></table></figure>
<p><strong>pyautogui.center((left, top, width, height))</strong> 返回指定位置的中心点；这样，我们就可以再配合鼠标操作点击找到图片的中心；</p>
<p><strong>键盘输入</strong></p>
<p><strong>键盘输入函数</strong></p>
<ul>
<li><strong>pyautogui.keyDown()</strong> ： 模拟按键按下；</li>
<li><strong>pyautogui.keyUp()</strong> ： 模拟按键释放；</li>
<li><strong>pyautogui.press()</strong> ： # 就是调用keyDown() &amp; keyUp(),模拟一次按键</li>
<li><strong>pyautogui.typewrite(‘this’,0.5)</strong> ： 第一参数是输入内容，第二个参数是每个字符间的间隔时间；</li>
<li><strong>pyautogui.typewrite([‘T’,‘h’,‘i’,‘s’])</strong>：typewrite 还可以传入单字母的列表；</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">输出： $ ；</span><br><span class="line">pyautogui.keyDown(<span class="string">&#x27;shift&#x27;</span>)    <span class="comment"># 按下shift</span></span><br><span class="line">pyautogui.press(<span class="string">&#x27;4&#x27;</span>)    <span class="comment"># 按下 4</span></span><br><span class="line">pyautogui.keyUp(<span class="string">&#x27;shift&#x27;</span>)   <span class="comment"># 释放 shift</span></span><br><span class="line"><span class="comment"># 缓慢的输出$：</span></span><br><span class="line">pyautogui.typewrite(<span class="string">&#x27;$$$$&#x27;</span>, <span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>
<p><strong>键盘特殊按键</strong></p>
<p>有时我们需要输入一些特殊的按键，比如向左的箭头，这些有相对应的键盘字符串表示，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输出：This</span></span><br><span class="line">pyautogui.typewrite([<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;left&#x27;</span>,<span class="string">&#x27;left&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,])</span><br></pre></td></tr></table></figure>
<p>解释：这里的left就是向左的箭头；诸如此类的键盘字符串，还有很多，参考下表： </p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>键盘字符串</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>enter(或return 或 \n)</td>
<td>回车</td>
</tr>
<tr>
<td>esc</td>
<td>ESC键</td>
</tr>
<tr>
<td>shiftleft, shiftright</td>
<td>左右SHIFT键</td>
</tr>
<tr>
<td>altleft, altright</td>
<td>左右ALT键</td>
</tr>
<tr>
<td>ctrlleft, ctrlright</td>
<td>左右CTRL键</td>
</tr>
<tr>
<td>tab (\t)</td>
<td>TAB键</td>
</tr>
<tr>
<td>backspace, delete</td>
<td>BACKSPACE 、DELETE键</td>
</tr>
<tr>
<td>pageup, pagedown</td>
<td>PAGE UP 和 PAGE DOWN键</td>
</tr>
<tr>
<td>home, end</td>
<td>HOME 和 END键</td>
</tr>
<tr>
<td>up, down, left,right</td>
<td>箭头键</td>
</tr>
<tr>
<td>f1, f2, f3…. f12</td>
<td>F1…….F12键</td>
</tr>
<tr>
<td>volumemute, volumedown,volumeup</td>
<td>声音变大变小静音（有些键盘没有）</td>
</tr>
<tr>
<td>pause</td>
<td>PAUSE键，暂停键</td>
</tr>
<tr>
<td>capslock</td>
<td>CAPS LOCK 键</td>
</tr>
<tr>
<td>numlock</td>
<td>NUM LOCK 键</td>
</tr>
<tr>
<td>scrolllock</td>
<td>SCROLLLOCK 键</td>
</tr>
<tr>
<td>insert</td>
<td>INSERT键</td>
</tr>
<tr>
<td>printscreen</td>
<td>PRINT SCREEN键</td>
</tr>
<tr>
<td>winleft, winright</td>
<td>Win键（windows ）</td>
</tr>
<tr>
<td>command</td>
<td>command键（Mac OS X ）</td>
</tr>
<tr>
<td>option</td>
<td>option（Mac OS X）</td>
</tr>
</tbody>
</table>
</div>
<p><strong>快捷键</strong></p>
<p>如果我们需要模拟复制的快捷键 ctrl + c ，如果用前面的方法，则代码为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.keyDown(<span class="string">&#x27;ctrl&#x27;</span>)</span><br><span class="line">pyautogui.keyDown(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">pyautogui.keyUp(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">pyautogui.keyUp(<span class="string">&#x27;ctrl&#x27;</span>)</span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>
<p>快捷键的按键与释放顺序非常关键，这时我们可以使用 pyautogui.hotkey()，这个函数可以接受多个参数，按传入顺序按下，再按照相反顺序释放。上述快捷键 ctrl + c ，可以将代码变为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.hotkey(<span class="string">&#x27;ctrl&#x27;</span>,<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><strong>提示信息框</strong></p>
<p><strong>提示框/警告框</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line">a = pyautogui.alert(text=<span class="string">&#x27;This is an alert box.&#x27;</span>, title=<span class="string">&#x27;Test&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>
<p>例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h3><h4 id="练习一"><a href="#练习一" class="headerlink" title="练习一"></a>练习一</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1）装饰器</span></span><br><span class="line"><span class="comment"># 2）自动化关键数据记录：截图、日志、page_source</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> allure</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"><span class="comment"># 装饰器的外函数需要一个形参代表函数对象</span></span><br><span class="line"><span class="comment"># 问题：需要通过driver实例截图和打印page_source，装饰器需要先去获取driver实例对象</span></span><br><span class="line"><span class="comment"># 解决：</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ui_exception_record</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):  <span class="comment"># 内函数</span></span><br><span class="line">        <span class="comment"># 获取被装饰方法的self，如def test_baidu(self)方法中的self，即实例对象</span></span><br><span class="line">        <span class="comment"># 通过self就可以拿到声明的实例变量</span></span><br><span class="line">        <span class="comment"># 前提条件，被装饰的方法是一个实例方法，实例需要有实例变量self.driver</span></span><br><span class="line">        <span class="comment"># 注意：要保证使用装饰器时，driver已经声明，在用例类里面的前置操作对self.driver声明，也可以将driver = args[0].driver放在except Exception里面的第一行</span></span><br><span class="line">        <span class="comment"># driver = args[0].driver</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 当被装饰方法/函数发生异常时就捕获并做数据记录</span></span><br><span class="line">            <span class="keyword">return</span> func(*args, **kwargs)   <span class="comment"># 这里会执行被装饰函数</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            driver = args[<span class="number">0</span>].driver</span><br><span class="line">            <span class="comment"># 出现异常时的处理，截图操作</span></span><br><span class="line">            timestamp = <span class="built_in">int</span>(time.time())  <span class="comment"># 获取当前时间的时间戳</span></span><br><span class="line">            <span class="comment"># 提前创建好image和pagesource路径</span></span><br><span class="line">            image_path = <span class="string">f&quot;./image/image_<span class="subst">&#123;timestamp&#125;</span>.PNG&quot;</span></span><br><span class="line">            page_source_path = <span class="string">f&quot;./page_source/page_source_<span class="subst">&#123;timestamp&#125;</span>.html &quot;</span></span><br><span class="line">            <span class="comment"># 截图</span></span><br><span class="line">            driver.save_screenshot(image_path)</span><br><span class="line">            <span class="comment"># 记录page_source,将获取的page_source写入到record.html</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(page_source_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write( driver.page_source)</span><br><span class="line">            <span class="comment"># 将截图放到报告中</span></span><br><span class="line">            allure.attach.file(image_path, name=<span class="string">&quot;picture&quot;</span>, attachment_type=allure.attachment_type.PNG)</span><br><span class="line">            <span class="comment"># 将pagesource记录放到报告中</span></span><br><span class="line">            <span class="comment"># 想要html的源码可以将attachment_type=allure.attachment_type.TEXT</span></span><br><span class="line">            allure.attach.file(page_source_path, name=<span class="string">&quot;pagesource&quot;</span>, attachment_type=allure.attachment_type.TEXT)</span><br><span class="line">            <span class="comment"># 问题1：异常处理会影响用例本身的结果，如本来就是有异常的用例，却通过了</span></span><br><span class="line">            <span class="comment"># 解决：在exception之后再把异常抛出</span></span><br><span class="line">            <span class="keyword">raise</span> Exception</span><br><span class="line">    <span class="keyword">return</span> inner  <span class="comment"># 返回内函数，不需要加括号</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 问题2：异常捕获处理代码和业务代码无关，不能耦合，如有多条用例就要写多个异常捕获</span></span><br><span class="line"><span class="comment"># 解决：使用装饰器装饰用例或者相关方法，就不会体现在源码中了</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestBaidu</span>:</span><br><span class="line">    <span class="comment"># 前置操作</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver = webdriver.Chrome()   <span class="comment"># driver声明</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 后置操作</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teardown</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果装饰器中的try没有return，被装饰方法有返回值时，会丢失返回值，其他方法调用就没有返回值</span></span><br><span class="line">    <span class="comment"># @ui_exception_record</span></span><br><span class="line">    <span class="comment"># def find(self):</span></span><br><span class="line">        <span class="comment"># return self.driver.find_element(By.ID, &quot;su&quot;)   # 返回find_element对象</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @ui_exception_record   </span><span class="comment"># 调用上面的装饰器</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_baidu</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;https://www.baidu.com/&quot;</span>)</span><br><span class="line">        <span class="comment"># self.find().click()  # 调用find()方法的返回对象，并点击</span></span><br><span class="line">        self.driver.find_element(By.ID, <span class="string">&quot;su&quot;</span>).click()  <span class="comment"># 定位&quot;百度一下&quot;按钮</span></span><br></pre></td></tr></table></figure>
<h4 id="练习二"><a href="#练习二" class="headerlink" title="练习二"></a>练习二</h4><p><strong>Jpress项目</strong></p>
<ul>
<li>testcases  测试用例</li>
<li>data   测试数据</li>
<li>logs log  日志</li>
<li>config  配置文件</li>
<li>reports  测试报告</li>
<li>screenshots  截屏</li>
<li>lib  第三方库</li>
<li>util  类</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>web自动化</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://www.fixbox.top/2024/01/22/3-5-Web%E8%87%AA%E5%8A%A8%E5%8C%96/">https://www.fixbox.top/2024/01/22/3-5-Web自动化/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>Fylasd</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2024-01-22</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2024-01-22</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/web%E8%87%AA%E5%8A%A8%E5%8C%96/">web自动化</a></div><div class="post_share"><div class="social-share" data-image="https://img2.baidu.com/it/u=3725066843,1857864369&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/22/3-6-Appium%E6%A1%86%E6%9E%B6/" title="Appium框架"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Appium框架</div></div></a></div><div class="next-post pull-right"><a href="/2024/01/22/3-7-IOS%E8%87%AA%E5%8A%A8%E5%8C%96/" title="IOS自动化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">IOS自动化</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2.baidu.com/it/u=3725066843,1857864369&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Fylasd</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/"><i class="fab fa-github"></i><span>前往小家</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到博客空间</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85selenium%E5%8C%85"><span class="toc-text">安装selenium包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AB%E5%A4%A7%E5%85%83%E7%B4%A0"><span class="toc-text">八大元素</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81id"><span class="toc-text">1、id</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81name"><span class="toc-text">2、name</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81class-name"><span class="toc-text">3、class_name</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81tag-name"><span class="toc-text">4、tag_name</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81link-text"><span class="toc-text">5、link_text</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81partail-link-text"><span class="toc-text">6、partail_link_text</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81xpath"><span class="toc-text">7、xpath</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E3%80%81css"><span class="toc-text">8、css</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%86"><span class="toc-text">框</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E9%80%89%E6%A1%86"><span class="toc-text">单选框</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E9%80%89%E6%A1%86"><span class="toc-text">多选框</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E6%8B%89%E6%A1%86"><span class="toc-text">下拉框</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%B9%E6%80%A7%E6%A1%86"><span class="toc-text">弹性框</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#iframe%E6%A1%86"><span class="toc-text">iframe框</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%A7%E8%81%94%E6%97%A5%E6%9C%9F%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-text">级联日期选择器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6"><span class="toc-text">文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0"><span class="toc-text">上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD"><span class="toc-text">下载</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-text">其他</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%A0%81"><span class="toc-text">验证码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E5%BE%85"><span class="toc-text">等待</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BC%A0%E6%A0%87%E9%94%AE%E7%9B%98"><span class="toc-text">鼠标键盘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BB%9A%E5%8A%A8%E6%9D%A1"><span class="toc-text">滚动条</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%8F%E5%B9%95%E6%88%AA%E5%B1%8F"><span class="toc-text">屏幕截屏</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PyAutoGUI"><span class="toc-text">PyAutoGUI</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE"><span class="toc-text">项目</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%E4%B8%80"><span class="toc-text">练习一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%E4%BA%8C"><span class="toc-text">练习二</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Fylasd</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="/js/tw_cn.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script async src="https://npm.elemecdn.com/tzy-blog/lib/js/other/sakura.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://www.fixbox.top/categories/Linux/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📒 Linux (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.fixbox.top/categories/SQL数据库/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📒 SQL数据库 (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.fixbox.top/categories/Python/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📒 Python (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="https://www.fixbox.top/categories" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(50% - 5px);background: #f2f2f2;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: #104E8B}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站采用多线部署，主线路托管于Vercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="本站采用多线部署，备用线路托管于4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.js"></script><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'true';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '1s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '2');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":90,"height":180},"mobile":{"show":false},"log":false});</script></body></html>