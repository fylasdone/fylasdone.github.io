<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Python框架测试 | 冯XX</title><meta name="author" content="Fylasd"><meta name="copyright" content="Fylasd"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Python自动化测试unittest框架​    python自带的一个单元测试框架，不用额外安装，即可直接使用。测试人员用来做自动化测试（接口&#x2F;UI自动化），作为自动化测试的执行框架，即管理和执行测试用例。 使用UnitTest框架的原因  能够组织多个用例去执行：能把多个测试用例放在一起，一起去执行 提供丰富的断言方法：代替人工自动的判断实际结果和预期结果是否相符 能够生成测试报告  uni">
<meta property="og:type" content="article">
<meta property="og:title" content="Python框架测试">
<meta property="og:url" content="https://www.fixbox.top/2024/01/22/3-4-Python%E6%A1%86%E6%9E%B6%E6%B5%8B%E8%AF%95/index.html">
<meta property="og:site_name" content="冯XX">
<meta property="og:description" content="Python自动化测试unittest框架​    python自带的一个单元测试框架，不用额外安装，即可直接使用。测试人员用来做自动化测试（接口&#x2F;UI自动化），作为自动化测试的执行框架，即管理和执行测试用例。 使用UnitTest框架的原因  能够组织多个用例去执行：能把多个测试用例放在一起，一起去执行 提供丰富的断言方法：代替人工自动的判断实际结果和预期结果是否相符 能够生成测试报告  uni">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img2.baidu.com/it/u=3725066843,1857864369&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500">
<meta property="article:published_time" content="2024-01-22T07:03:45.175Z">
<meta property="article:modified_time" content="2024-01-22T07:09:05.253Z">
<meta property="article:author" content="Fylasd">
<meta property="article:tag" content="Python框架测试">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img2.baidu.com/it/u=3725066843,1857864369&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"><link rel="shortcut icon" href="https://img1.baidu.com/it/u=2559221203,2316879426&fm=253&fmt=auto&app=138&f=PNG?w=400&h=400"><link rel="canonical" href="https://www.fixbox.top/2024/01/22/3-4-Python%E6%A1%86%E6%9E%B6%E6%B5%8B%E8%AF%95/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python框架测试',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-22 15:09:05'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><div id="myscoll"></div><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2.baidu.com/it/u=3725066843,1857864369&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="冯XX"><span class="site-name">冯XX</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Python框架测试</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-01-22T07:03:45.175Z" title="发表于 2024-01-22 15:03:45">2024-01-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-22T07:09:05.253Z" title="更新于 2024-01-22 15:09:05">2024-01-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/">软件测试</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">16.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>62分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Python框架测试"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Python自动化测试"><a href="#Python自动化测试" class="headerlink" title="Python自动化测试"></a>Python自动化测试</h2><h2 id="unittest框架"><a href="#unittest框架" class="headerlink" title="unittest框架"></a>unittest框架</h2><p>​    python自带的一个单元测试框架，不用额外安装，即可直接使用。测试人员用来做自动化测试（接口/UI自动化），作为自动化测试的执行框架，即管理和执行测试用例。</p>
<p><strong>使用UnitTest框架的原因</strong></p>
<ul>
<li>能够组织多个用例去执行：能把多个测试用例放在一起，一起去执行</li>
<li>提供丰富的断言方法：代替人工自动的判断实际结果和预期结果是否相符</li>
<li>能够生成测试报告</li>
</ul>
<p><strong>unittest中最核心的四个概念是：</strong></p>
<p>test case===&gt;测试用例, test suite===&gt;测试套件, </p>
<p>test runnerr===&gt;测试执行, test fixture===&gt;测试夹具。</p>
<p><strong>UnitTest框架核心要素（组成部分）</strong></p>
<ul>
<li>TestCase：测试用例，作用是用来书写真正的用例代码（脚本）</li>
<li>TestSuite：测试套件，作用是用来组装（打包）TestCase（测试用例）的，既可以将多个用例脚本文件组装到一起</li>
<li>TestRunner：测试执行（测试运行），作用是用来执行TestSuite（测试套件）的</li>
<li>TestLoader：测试加载，是对TestSuite（测试套件）功能的补充，也是用来 组装（打包）TestCase（测试用例）的</li>
<li>Fixture：测试夹具，是一种代码结构，相当于书写前置方法（执行用例之前的方法）代码和后置方法（执行用例之后）代码，即用例执行顺序为前置-&gt;用例-&gt;后置</li>
</ul>
<h3 id="1、TestCase"><a href="#1、TestCase" class="headerlink" title="1、TestCase"></a><strong>1、TestCase</strong></h3><p>1、作用</p>
<ul>
<li>用来书写真正的用例代码（脚本）</li>
<li>单独一个测试用例，也可以执行</li>
</ul>
<p>2、定义测试用例的步骤</p>
<ul>
<li>步骤1：导包—-&gt;import unittest</li>
<li>步骤2：定义测试类—-&gt;新建测试类 必须 继承unittest.TestCase类，习惯性类名以Test开头</li>
<li>步骤3：定义测试方法—-&gt;测试方法名称命名 必须 以test开头</li>
<li>步骤4：执行</li>
</ul>
<p>3、注意事项</p>
<ul>
<li>代码文件名，要满足标识符的规则：字母数字下划线组成，不能以数字开头</li>
<li>代码文件名，不要使用中文</li>
</ul>
<p>4、执行测试用例的两种方式</p>
<ul>
<li>方式1：使用pycharm在代码上点击鼠标右键，选择使用UnitTest运行<ul>
<li>在类名后边右键运行：会执行测试类中所有的测试方法</li>
<li>在方法名后边右键运行：只执行当前的测试方法</li>
</ul>
</li>
<li>方式2：调用unittest.main()来运行</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">学习TestCase（测试用例）的使用</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 1、导包</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="comment"># 2、定义测试类：只需要让类继承unittest.TestCase类，这个类就是测试类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestDemo</span>(unittest.TestCase):</span><br><span class="line">    <span class="comment"># 3、定义测试方法：测试方法中的代码就是真正的用例代码，测试方法名必须以test开头</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_method1</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;测试方法一&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_method2</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;测试方法二&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">4、执行测试用例的4种方式</span></span><br><span class="line"><span class="string">    4.1 在类名或者方法名后边右键运行</span></span><br><span class="line"><span class="string">        4.1.1在类名后边右键运行：会执行测试类中所有的测试方法</span></span><br><span class="line"><span class="string">        4.1.2在方法名后边右键运行：只执行当前的测试方法</span></span><br><span class="line"><span class="string">    4.2 使用unittest.main()执行测试用例</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 4.2</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        unittest.main()</span><br></pre></td></tr></table></figure>
<p>6、可能出现的错误</p>
<p>（1）文件名包含中文</p>
<p>（2）右键运行 没有unit test for……</p>
<ul>
<li>解决方案1：新建一个代码文件，将之前的代码复制过来</li>
<li>解决方案2：在主程序使用unittest.main()来执行</li>
<li>解决方案3：使用减号，将python中内容移除</li>
</ul>
<h3 id="2、TestSuite和TestRunner"><a href="#2、TestSuite和TestRunner" class="headerlink" title="2、TestSuite和TestRunner"></a>2、TestSuite和TestRunner</h3><p>1、TestSuite的作用</p>
<ul>
<li>将多条用例脚本集合在一起就是套件，即TestSuite是用来组装用例的</li>
</ul>
<p>2、将用例脚本集合到测试套件中的步骤</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">步骤<span class="number">1</span>： 导包---&gt;<span class="keyword">import</span> unittest</span><br><span class="line">步骤<span class="number">2</span>：实例化套件对象---&gt; suite = unittest.TestSuite()</span><br><span class="line">步骤<span class="number">3</span>：添加用例方法</span><br><span class="line">（<span class="number">1</span>）一次添加一个测试方法---&gt;suite.addTest(ClassName(‘MethodName’))</span><br><span class="line">                                                        </span><br><span class="line">    <span class="comment">#ClassName:测试类名 MethodName：测试方法名</span></span><br><span class="line">       （<span class="number">2</span>） 一次添加整个测试类---&gt;suite .addTest(unittest.makeSuite(测试类名))                       <span class="comment">#在不同的Python版本中，可能没有提示</span></span><br><span class="line">        （<span class="number">3</span>）一次添加整个测试类</span><br><span class="line">suite.addTest(unittest.defaultTestLoader.loadTestsFromTestCase(ClassName))</span><br><span class="line">             <span class="comment">#把指定测试类中的测试方法全部添加到测试套件中</span></span><br></pre></td></tr></table></figure>
<p>3、TestRunner的作用</p>
<ul>
<li>用来执行测试用例和测试套件</li>
</ul>
<p>4、执行对象执行测试套件的步骤</p>
<ul>
<li>步骤1： 导包—-&gt;import unittest</li>
<li>步骤2：实例化执行对象（运行对象）—-&gt; runner = unittest.TextTestRunner()</li>
<li>步骤:3：执行对象执行套件对象—-&gt; runner.run(suite) </li>
</ul>
<p>​                                 #执行对象.run(套件对象)</p>
<p>5、整体步骤</p>
<ul>
<li>步骤1： 导包—-&gt;import unittest</li>
<li>步骤2： 实例化套件对象—-&gt; suite = unittest.TestSuite()</li>
<li>步骤3：添加用例方法</li>
<li>步骤4：实例化执行对象（运行对象）—-&gt; runner = unittest.TextTestRunner()</li>
<li>步骤:5：执行对象执行套件对象—-&gt; runner.run(suite) </li>
</ul>
<p>6、注意事项</p>
<ul>
<li>TextSuite需要配合TestRunner才能被执行</li>
</ul>
<p>7、举例说明</p>
<p>（1）需求</p>
<ul>
<li>创建2个文件，并在每个文件中定义1个测试类和2个测试方法</li>
<li>批量执行所有的测试用例</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：导包---&gt;import unittest</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 导包：导入其他包含测试类测试方法的Python文件</span></span><br><span class="line"><span class="keyword">from</span> hm_02_testcase1 <span class="keyword">import</span> TestDemo1</span><br><span class="line"><span class="keyword">from</span> hm_02_testcase2 <span class="keyword">import</span> TestDemo2</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 步骤2：实例化套件对象---&gt; suite = unittest.TestSuite()</span></span><br><span class="line">suite = unittest.TestSuite()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">步骤3：添加用例方法</span></span><br><span class="line"><span class="string">3.1 方式1：一次添加一个测试方法---&gt;套件对象.addTest(测试类名(&#x27;测试方法名&#x27;))</span></span><br><span class="line"><span class="string">3.2 方式2：一次添加整个测试类-&gt;套件对象.addTest(unittest.defaultTestLoader.loadTestsFromTestCase(ClassName))</span></span><br><span class="line"><span class="string">                           #把指定测试类中的测试方法全部添加到测试套件中</span></span><br><span class="line"><span class="string">3.3 方式3：一次添加整个测试类---&gt;套件对象.addTest(unittest.makeSuite(测试类名))</span></span><br><span class="line"><span class="string">                           #在不同的Python版本中，可能没有提示</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 3.1</span></span><br><span class="line">suite.addTest(TestDemo1(<span class="string">&#x27;test_method1&#x27;</span>))</span><br><span class="line">suite.addTest(TestDemo1(<span class="string">&#x27;test_method2&#x27;</span>))</span><br><span class="line">suite.addTest(TestDemo2(<span class="string">&#x27;test_method1&#x27;</span>))</span><br><span class="line">suite.addTest(TestDemo2(<span class="string">&#x27;test_method2&#x27;</span>))</span><br><span class="line"><span class="comment"># 3.2</span></span><br><span class="line">suite.addTest(unittest.defaultTestLoader.loadTestsFromTestCase(TestDemo1))</span><br><span class="line">suite.addTest(unittest.defaultTestLoader.loadTestsFromTestCase(TestDemo2))</span><br><span class="line"><span class="comment"># 3.3</span></span><br><span class="line">suite.addTest(unittest.makeSuite(TestDemo1))</span><br><span class="line">suite.addTest(unittest.makeSuite(TestDemo2))</span><br><span class="line"><span class="comment"># 步骤4：实例化执行对象（运行对象）---&gt; runner = unittest.TextTestRunner()</span></span><br><span class="line">runner = unittest.TextTestRunner()</span><br><span class="line"><span class="comment"># 步骤5：执行对象执行套件对象---&gt; runner.run(suite)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>8、test suite(测试套件)、test runne(测试执行)==&gt;runCase</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">概念:</span><br><span class="line">    test suite 测试套件:把需要执行的测试用例放到一个套子</span><br><span class="line">    test runner 测试执行:使用测试执行去执行所有在套子里面的测试用例</span><br><span class="line">语法:</span><br><span class="line">    测试套件:适合作为调试测试用例</span><br><span class="line">        suite = unittest.TestSuite()</span><br><span class="line">        suite.addTest(测试类(<span class="string">&#x27;测试方法&#x27;</span>))</span><br><span class="line">    测试执行:</span><br><span class="line">        runner = unittest.TextTestRunner()</span><br><span class="line">        runner.run(suite)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试套件、测试执行代码实现</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> Case.test_03_用例执行顺序 <span class="keyword">import</span> TestLoginPay</span><br><span class="line"><span class="keyword">from</span> Case.test_04_断言 <span class="keyword">import</span> TestLogin03</span><br><span class="line"><span class="comment"># unittest.main()</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 添加不同的测试用例</span></span><br><span class="line"><span class="comment"># 实例化一个测试套件</span></span><br><span class="line">suite = unittest.TestSuite()</span><br><span class="line">suite.addTest(TestLoginPay(<span class="string">&#x27;test_01_login&#x27;</span>))</span><br><span class="line">suite.addTest(TestLoginPay(<span class="string">&quot;test_04_create_order&quot;</span>))</span><br><span class="line">suite.addTest(TestLogin03(<span class="string">&quot;test_login&quot;</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 实例化一个测试执行</span></span><br><span class="line">runner = unittest.TextTestRunner()</span><br><span class="line">runner.run(suite)</span><br></pre></td></tr></table></figure>
<p>9、执行所有==&gt;runAllcase</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">语法:</span><br><span class="line">    test suite:</span><br><span class="line">        unittest.defaultTestLoader.discover(start_dir=测试用例的目录,pattern=选取</span><br><span class="line">测试用例执行的规则)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#执行所有case代码实现</span><br><span class="line">import unittest</span><br><span class="line"># 添加所有的测试用例套件</span><br><span class="line">suite = unittest.defaultTestLoader.discover(&quot;./Case&quot;,pattern=&quot;test_03*.py&quot;)</span><br><span class="line"># 实例化一个测试执行</span><br><span class="line">runner = unittest.TextTestRunner()</span><br><span class="line"># 执行测试</span><br><span class="line">runner.run(suite)</span><br></pre></td></tr></table></figure>
<p>10、 测试执行==&gt;test runner</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">概念：</span><br><span class="line">    HTMLTestRunner:第三方插件</span><br><span class="line">    下载resource里面的HTMLTestRunnerPlugins放到python安装目录下的 lib 目录下</span><br><span class="line">     <span class="number">1.</span>生成的报告应该放在Report里面</span><br><span class="line">     <span class="number">2.</span>生成的报告应该以 .html结尾</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#test runner报告生成实现代码</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">import</span> HTMLTestRunnerPlugins</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># 获取测试报告的路径进行拼接</span></span><br><span class="line">report_path = os.path.dirname(__file__) + <span class="string">&#x27;/Report/&#x27;</span></span><br><span class="line"><span class="comment"># 获取当前时间</span></span><br><span class="line">now = time.strftime(<span class="string">&#x27;%Y-%m-%d %H_%M_%S&#x27;</span>)</span><br><span class="line"><span class="comment"># 根据路径和时间拼接最终的文件路径</span></span><br><span class="line">report_name = report_path + now + <span class="string">&#x27;HTMLReport.html&#x27;</span></span><br><span class="line"><span class="comment"># 添加执行的测试目录到套件里面</span></span><br><span class="line">suite = unittest.defaultTestLoader.discover(<span class="string">&#x27;./Case&#x27;</span>)</span><br><span class="line"><span class="comment"># 打开我们刚才拼接好的路径</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(report_name, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> fq:</span><br><span class="line">    <span class="comment"># 实例化一个 HTMLTestRunner</span></span><br><span class="line">    runner = HTMLTestRunnerPlugins.HTMLTestRunner(</span><br><span class="line">        stream=fq,</span><br><span class="line">        verbosity=<span class="number">2</span>,</span><br><span class="line">        title=<span class="string">&#x27;web自动化测试报告&#x27;</span>,</span><br><span class="line">        description=<span class="string">&quot;执行完所有的测试用例&quot;</span>,</span><br><span class="line">        tester=<span class="string">&#x27;第一组成员&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># 执行套件</span></span><br><span class="line">    runner.run(suite)</span><br></pre></td></tr></table></figure>
<p>11、数据驱动</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">概念：</span><br><span class="line">    数据驱动:有的用例只是参数不一样,其他代码完全一样,就可以通过改变测试参数来实现一条</span><br><span class="line">用例方法执行多种不同的测试场景.在unittest里面需要使用 ddt 来提供参数化的功能</span><br><span class="line">            pip install ddt  安装</span><br><span class="line">语法：</span><br><span class="line">    ddt可以参数化读取列表嵌套列表或者列表嵌套字典的数据</span><br><span class="line">    列表嵌套列表读取:</span><br><span class="line">        先在类前面加上: @ddt.ddt</span><br><span class="line">        在方法前面加上: @ddt.data(*列表嵌套列表)</span><br><span class="line"><span class="meta">                      @ddt.unpack</span></span><br><span class="line">    列表嵌套字典读取:</span><br><span class="line">        先在类前面加上: @ddt.ddt</span><br><span class="line">        在方法前面加上: @ddt.data(*列表嵌套列表)</span><br><span class="line">                      在方法里面使用一个形式参数来接收</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据驱动代码实现</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">import</span> ddt</span><br><span class="line"><span class="keyword">from</span> Common.OperationData <span class="keyword">import</span> OperationData</span><br><span class="line"><span class="keyword">from</span> Page.Login_Page <span class="keyword">import</span> LoginPage</span><br><span class="line"> </span><br><span class="line">data_list = OperationData(<span class="string">&#x27;user_data.xls&#x27;</span>).get_data_list()</span><br><span class="line">data_dict = OperationData(<span class="string">&#x27;user_data.xls&#x27;</span>).get_data_dict()</span><br><span class="line"> </span><br><span class="line"><span class="meta">@ddt.ddt</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestLoginDDt</span>(unittest.TestCase):</span><br><span class="line"><span class="meta">    @ddt.data(<span class="params">*data_dict</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_login_dict</span>(<span class="params">self, dict_data</span>):</span><br><span class="line">        <span class="built_in">print</span>(dict_data)</span><br><span class="line">        login = LoginPage(<span class="string">&quot;chrome&quot;</span>)</span><br><span class="line">        login.open_login_url()</span><br><span class="line">        <span class="comment"># 输入账号</span></span><br><span class="line">        login.send_user_name(dict_data[<span class="string">&#x27;username&#x27;</span>])</span><br><span class="line">        <span class="comment"># 输入密码</span></span><br><span class="line">        login.send_password(dict_data[<span class="string">&#x27;password&#x27;</span>])</span><br><span class="line">        <span class="comment"># 点击登录</span></span><br><span class="line">        login.click_login()</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># 进行断言</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">str</span>(dict_data[<span class="string">&quot;expected&quot;</span>]) == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;判断表达式:&quot;</span>,login.login_after_assert())</span><br><span class="line">            self.assertTrue(login.login_after_assert(),msg=<span class="string">&quot;登录失败&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">str</span>(dict_data[<span class="string">&quot;expected&quot;</span>]) == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            self.assertTrue(<span class="keyword">not</span> login.login_after_assert(), msg=<span class="string">&quot;登录失败&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;预期结果超过限制&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>
<h3 id="3、TestLoader"><a href="#3、TestLoader" class="headerlink" title="3、TestLoader"></a><strong>3、TestLoader</strong></h3><p><strong>TestLoader：测试加载</strong></p>
<p>1、作用</p>
<ul>
<li>作用和 TestSuite一样，也是 用来组装测试用例的，同样需要使用 TextTestRunner()去 执行</li>
</ul>
<p>2、为什么有了TestSuite还要用TestLoader？</p>
<ul>
<li>TestSuite：假如有10个用例脚本，通过makeSuite(测试类名)也需要10次才能将所有用例脚本都添加到测试套件中</li>
<li>TestLoader：使用unittest.TestLoader，通过该类下面的discover()方法自动搜索指定目录下指定开头的.py文件，并将查找到的测试用例组装到套件中 ，一行代码就可以将10个用例脚本都添加到套件中</li>
<li>结论：使用 TestLoader加载用例脚本更方便</li>
</ul>
<p>3、通过TestLoader批量添加用例方法到套件中的步骤</p>
<blockquote>
<ul>
<li>步骤1： 导包—-&gt;import unittest</li>
<li>步骤2：实例化加载对象 并加载用例— -&gt; 得到的是套件对象</li>
</ul>
<p>​    suite = unittest.TestLoader().discover(‘用例所在的目录’,’用例代码文件名*.py’)</p>
<ul>
<li>步骤3：实例化执行对象并执行套件对象</li>
</ul>
</blockquote>
<p>4、注意事项</p>
<ul>
<li>unittest.TestLoader().discover( ‘用例所在的目录’,’用例代码文件名*.py’ )最终返回的还是套件对象，执行套件对象需要使用TestRunner</li>
</ul>
<p>5、TestLoader与TestSuite区别</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img-blog.csdnimg.cn/062e85bd3c3542cc96b537cf30ae6f20.png" alt="img"></p>
<h3 id="4、Fixture"><a href="#4、Fixture" class="headerlink" title="4、Fixture"></a><strong>4、Fixture</strong></h3><p>1、Fixture引入案例</p>
<p>tpshop网页登录用例：</p>
<p>1、打开浏览器（一般只打开一次）</p>
<p>2、打开网页，点击登录（每次）</p>
<p>3、输入用户名、密码、验证码，点击【登录】（每次）</p>
<p>4、关闭页面（每次）</p>
<p>5、关闭浏览器（一般只关闭一次）</p>
<p><strong><em>\</em>如果有3条用例：**</strong></p>
<p>1、打开浏览器（一般只打开一次，类，使用类 级别 Fixture）</p>
<p>2、打开网页，点击登录（每次）</p>
<p>3、输入用户名1、密码1、验证码1，点击【登录】（每次，测试方法，使用 方法级别 Fixture）</p>
<p>4、关闭页面（每次）</p>
<p>2、打开网页，点击登录（每次）</p>
<p>3、输入用户名2、密码2、验证码2，点击【登录】（每次，测试方法，使用 方法级别 Fixture）</p>
<p>4、关闭页面（每次）</p>
<p>2、打开网页，点击登录（每次）</p>
<p>3、输入用户名3、密码3、验证码3，点击【登录】（每次，测试方法，使用 方法级别 Fixture）</p>
<p>4、关闭页面（每次）</p>
<p>5、关闭浏览器（一般只关闭一次，类，使用类 级别 Fixture）</p>
<p><strong><em>\</em>结论：**</strong></p>
<ul>
<li>对于1、打开浏览器，2、打开网页，3、关闭网页，4、关闭浏览器，每个测试方法中都需要写，很麻烦，使用Fixture的话，这部分代码只写一次就可以了，执行每个测试用例方法前后都会自动执行Fixture写的2、4、这部分的代码</li>
</ul>
<p><strong>2、Fixture介绍</strong></p>
<p>（1）作用</p>
<ul>
<li>是一种代码结构，会在用例执行前后自动执行</li>
<li>简单理解就是对一个测试用例环境的初始化和销毁</li>
</ul>
<p>（2）Fixture控制级别</p>
<ul>
<li>方法级别 Fixture：在每个用例执行前、后都会自动调用，方法名是固定的</li>
<li>类级别 Fixture：在类中所有的测试方法执行前、后会自动执行的代码，一个类中只执行一次，类级别的Fixture需要写作类方法</li>
<li>模块级别 Fixture （了解）：模块就是代码文件，模块级别就是在这个代码文件执行前、后会自动执行的代码，在类外部定义函数</li>
</ul>
<p><strong>3、方法级别Fixture</strong></p>
<p>（1）使用方式</p>
<ul>
<li>初始化（前置处理）<ul>
<li>def setUp(self):  #每个用例执行之前都会自动调用</li>
</ul>
</li>
<li>销毁（后置处理）<ul>
<li>def tearDown(self):  #每个用例执行之后都会自动调用</li>
</ul>
</li>
</ul>
<p>（2）总结</p>
<ul>
<li>运行于测试方法的始末，即：运行一次用例就会运行一次setUp和tearDown</li>
</ul>
<p><strong>4、类级别Fixture</strong></p>
<p>（1）使用方式</p>
<ul>
<li>初始化（前置处理）<ul>
<li>@classmethod</li>
<li>def setUpClass(cls):  #类前置方法，方法名不能变，因为这里相当于覆盖式重写了父类unittest中的setUpClass方法</li>
</ul>
</li>
<li>销毁（后置处理）<ul>
<li>@classmethod</li>
<li>def tearDownClass(cls):  #类后置方法</li>
</ul>
</li>
</ul>
<p>（2）总结</p>
<ul>
<li>运行于测试类的始末，即：每个测试类只会运行一次setUpClass和tearDownClass</li>
<li>类前置 方法前置 用例 方法后置 方法前置 用例 方法后置 类后置</li>
</ul>
<p><strong>5、模块级别Fixture（了解）</strong></p>
<p>（1）使用方式</p>
<ul>
<li>初始化（前置处理）<ul>
<li>def setUpModule():  #首先自动执行</li>
</ul>
</li>
<li>销毁（后置处理）<ul>
<li>def tearDownModule():  #最后自动执行</li>
</ul>
</li>
</ul>
<p>（2）总结</p>
<ul>
<li>运行于整个模块的始末，即：整个模块只会运行一次setUpModule和tearDownModule</li>
</ul>
<p><strong>6、注意</strong></p>
<ul>
<li>Fixture不一定是成对出现的，需要前置写前置，需要后置写后置即可</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestLogin</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;2、打开网页，点击登录&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDown</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;4、关闭网页&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUpClass</span>(<span class="params">cls</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;1、打开浏览器&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDownClass</span>(<span class="params">cls</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;5、关闭浏览器&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_1</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;3、输入用户名1、密码1、验证码1，点击【登录】&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_2</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;3、输入用户名2、密码2、验证码2，点击【登录】&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_3</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;3、输入用户名3、密码3、验证码3，点击【登录】&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">概念：</span><br><span class="line">    test fixture==&gt;测试夹具</span><br><span class="line">语法</span><br><span class="line">    方法级别:</span><br><span class="line">        setup()     在每一个测试方法执行之前执行 setup 的代码</span><br><span class="line">        teardown()  在每一个测试方法执行之后执行 teardown 的代码</span><br><span class="line">    类级别:</span><br><span class="line">        setupClass() 在每一个测试类执行之前执行的方法 需要使用@<span class="built_in">classmethod</span>装饰</span><br><span class="line">        teardownClass() 在每一个测试类执行之后执行的方法 需要使用@<span class="built_in">classmethod</span>装饰</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#测试夹具实现代码</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestLogin</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_login</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;普通登录测试&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;普通登录测试&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_login_remember</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;记住密码测试&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;记住密码测试&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUp</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;在每一个测试方法执行之前执行&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDown</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;在每一个测试方法执行之后执行&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUpClass</span>(<span class="params">cls</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;在每一个测试类执行之前执行的方法，需要使用@classmethod装饰&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDownClass</span>(<span class="params">cls</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;在每一个测试类执行之后执行的方法,需要使用@classmethod装饰&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#unittest断言方法</span></span><br><span class="line"><span class="comment"># 概念</span></span><br><span class="line">    断言:判断预期和实际结果是否相符合</span><br><span class="line"><span class="comment"># 语法</span></span><br><span class="line">    self.assertEqual(a,b,msg=<span class="string">&#x27;错误描述&#x27;</span>) ==&gt; 判断  a==b成立则测试用例通过</span><br><span class="line">    self.assertTrue(x,msg=<span class="string">&#x27;错误描述&#x27;</span>) ==&gt; 判断 表达式x 是否为true,为true通过测试</span><br><span class="line">    self.assertIn(a,b,msg=<span class="string">&#x27;错误描述&#x27;</span>) ==&gt; 判断 a <span class="keyword">in</span> b成立则测试通过</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#unittest断言实现代码</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestLogin03</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_login</span>(<span class="params">self</span>):</span><br><span class="line">        expected = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">        result = <span class="string">&quot;admin&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;登录测试&quot;</span>)</span><br><span class="line">        self.assertEqual(expected,result, msg=<span class="string">&#x27;用户名输入错误&#x27;</span>)  <span class="comment"># 判断表达式a==b成立，则测试通过</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_add_to_cart</span>(<span class="params">self</span>):</span><br><span class="line">        expected = <span class="number">12</span></span><br><span class="line">        result = <span class="number">12</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;加入购物车的界面&quot;</span>)</span><br><span class="line">        self.assertTrue(expected == result,msg=<span class="string">&#x27;数量不对&#x27;</span>)  <span class="comment"># 判断表达式a==b是否为True,为true通过测试</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_create_order</span>(<span class="params">self</span>):</span><br><span class="line">        expected = <span class="string">&#x27;230527&#x27;</span></span><br><span class="line">        result = <span class="string">&#x27;tbd230527&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;创建订单的界面&quot;</span>)</span><br><span class="line">        self.assertIn(expected,result,msg=<span class="string">&quot;订单号错误&quot;</span>)  <span class="comment"># 判断表达式a是否在b里面</span></span><br><span class="line">        <span class="comment"># self.assertTrue(expected in result,msg=&#x27;订单号错误&#x27;)</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">跳过测试</span><br><span class="line">    概念</span><br><span class="line">        <span class="number">1.</span>当我们写的部分用例,在某些情况下不需要执行的时候可以跳过</span><br><span class="line">        <span class="number">2.</span>当系统更新之后,部分的测试用例失效,但是不确定后面是否还会再改回来,就直接跳过</span><br><span class="line">    语法</span><br><span class="line">    装饰器实现的跳过测试用例</span><br><span class="line"><span class="meta">        @unittest.skip(<span class="params">原因</span>) ==&gt; 没有条件,直接跳过</span></span><br><span class="line"><span class="meta">        @unittest.skipIf(<span class="params">表达式,原因</span>) ==&gt; 表达式为真跳过测试</span></span><br><span class="line"><span class="meta">        @unittest.skipUnless(<span class="params">表达式,原因</span>) ==&gt; 表达式为假跳过测试</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 跳过测试代码实现</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment"># 为0性别为男，为1性别为女</span></span><br><span class="line">sex = random.randint(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestLoginPay</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_01_page_enter</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;进入商品界面&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @unittest.skip(<span class="params">reason=<span class="string">&#x27;不想浏览&#x27;</span></span>)  </span><span class="comment"># 没有必要条件直接跳过</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_02_browse_products</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;浏览商品的界面&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @unittest.skipIf(<span class="params"><span class="number">1</span>==<span class="number">1</span>,reason=<span class="string">&#x27;不想加入购物车&#x27;</span></span>)  </span><span class="comment"># 表达式为真跳过测试</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_03_add_to_cart</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;加入购物车的界面&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_04_create_order</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;创建订单的界面&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @unittest.skipUnless(<span class="params">sex==<span class="number">1</span>, reason=<span class="string">&#x27;不想支付订单&#x27;</span></span>)  </span><span class="comment"># 表达式为假跳过测试，引用随机数</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_05_pay_order</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;支付订单的界面&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>
<p><strong>六、练习1</strong></p>
<p>1、需求</p>
<ul>
<li>创建一个目录case，作用就是用来存放用例脚本</li>
<li>在case目录中创建5个用例代码文件，test_case1.py……</li>
<li>使用TestLoader去执行用例</li>
</ul>
<p>2、注意</p>
<ul>
<li>实际应用中，用例都是存放在单独的目录中的</li>
</ul>
<p>3、实现代码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img-blog.csdnimg.cn/645fffc6025f4b31b1ed6032bd8bd069.png" alt="img"></p>
<p><strong>七、练习2</strong></p>
<p>1、需求</p>
<ul>
<li>定义一个tools模块，在这个模块中定义add方法，add方法可以对两个数字求和，返回求和结果 </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a,b</span>):</span><br><span class="line">        <span class="keyword">return</span> a+b</span><br></pre></td></tr></table></figure>
<ul>
<li>这个add函数相当于开发的功能代码，进行自动化测试时可以调用开发的代码，但是不能修改开发的代码</li>
<li>书写用例，通过多组数据对add()函数进行测试</li>
</ul>
<p>2、代码实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#测试用例</span></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> lx2.tools <span class="keyword">import</span> add</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestAdd</span>(unittest.TestCase):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_tools_add1</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">2</span> == add(<span class="number">1</span>, <span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;用例<span class="subst">&#123;<span class="number">1</span>&#125;</span><span class="subst">&#123;<span class="number">1</span>&#125;</span><span class="subst">&#123;<span class="number">2</span>&#125;</span>测试通过&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;用例<span class="subst">&#123;<span class="number">1</span>&#125;</span><span class="subst">&#123;<span class="number">1</span>&#125;</span><span class="subst">&#123;<span class="number">2</span>&#125;</span>测试不通过&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_tools_add2</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">3</span> == add(<span class="number">1</span>, <span class="number">2</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;用例<span class="subst">&#123;<span class="number">1</span>&#125;</span><span class="subst">&#123;<span class="number">2</span>&#125;</span><span class="subst">&#123;<span class="number">3</span>&#125;</span>测试通过&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;用例<span class="subst">&#123;<span class="number">1</span>&#125;</span><span class="subst">&#123;<span class="number">2</span>&#125;</span><span class="subst">&#123;<span class="number">3</span>&#125;</span>测试不通过&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_tools_add3</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">7</span> == add(<span class="number">3</span>, <span class="number">4</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;用例<span class="subst">&#123;<span class="number">3</span>&#125;</span><span class="subst">&#123;<span class="number">4</span>&#125;</span><span class="subst">&#123;<span class="number">7</span>&#125;</span>测试通过&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;用例<span class="subst">&#123;<span class="number">3</span>&#125;</span><span class="subst">&#123;<span class="number">4</span>&#125;</span><span class="subst">&#123;<span class="number">7</span>&#125;</span>测试不通过&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_tools_add4</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">9</span> == add(<span class="number">4</span>, <span class="number">5</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;用例<span class="subst">&#123;<span class="number">4</span>&#125;</span><span class="subst">&#123;<span class="number">5</span>&#125;</span><span class="subst">&#123;<span class="number">9</span>&#125;</span>测试通过&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;用例<span class="subst">&#123;<span class="number">4</span>&#125;</span><span class="subst">&#123;<span class="number">5</span>&#125;</span><span class="subst">&#123;<span class="number">9</span>&#125;</span>测试不通过&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img-blog.csdnimg.cn/effd9d427e9c40d0a3cb2aa4b83a27c3.png" alt="img"></p>
<p><strong>总结一下</strong>：</p>
<ol>
<li>unittest是Python自带的单元测试框架，我们可以用其来作为我们自动化测试框架的用例组织执行框架。</li>
<li>unittest的流程：写好TestCase，然后由TestLoader加载TestCase到TestSuite，然后由TextTestRunner来运行TestSuite，运行的结果保存在TextTestResult中，我们通过命令行或者unittest.main()执行时，main会调用TextTestRunner中的run来执行，或者我们可以直接通过TextTestRunner来执行用例。</li>
<li>一个class继承unittest.TestCase即是一个TestCase，其中以 <code>test</code> 开头的方法在load时被加载为一个真正的TestCase。</li>
<li>verbosity参数可以控制执行结果的输出，<code>0</code> 是简单报告、<code>1</code> 是一般报告、<code>2</code> 是详细报告。</li>
<li>可以通过addTest和addTests向suite中添加case或suite，可以用TestLoader的loadTestsFrom__()方法。</li>
<li>用 <code>setUp()</code>、<code>tearDown()</code>、<code>setUpClass()</code>以及 <code>tearDownClass()</code>可以在用例执行前布置环境，以及在用例执行后清理环境</li>
<li>我们可以通过skip，skipIf，skipUnless装饰器跳过某个case，或者用TestCase.skipTest方法。</li>
<li>参数中加stream，可以将报告输出到文件：可以用TextTestRunner输出txt报告，以及可以用HTMLTestRunner输出html报告。</li>
</ol>
<h2 id="pytest框架"><a href="#pytest框架" class="headerlink" title="pytest框架"></a>pytest框架</h2><h3 id="pytest"><a href="#pytest" class="headerlink" title="pytest"></a>pytest</h3><ol>
<li>简单灵活，容易上手;支持参数化; 测试用例的skip和xfail 处理;</li>
<li>能够支持简单的单元测试和复杂的功能测试，还可以用来做 selenium/appium等自动化测试、接口自动化测试 (pytest+requests);</li>
<li>pytest具有很多第三方插件，并且可以自定义扩展， 比较好 用的如 pytest-allure(完美html测试报告生成) pytest-xdist (多CPU分发)等;</li>
<li>可以很好的和jenkins集成;</li>
<li>等等</li>
</ol>
<p><strong>安装</strong></p>
<p>导入相关依赖库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pip install –U pytest 安装pytest，U表示升级,也可取消-U</span><br><span class="line">pip install sugar</span><br><span class="line">pip install pytest-rerunfailures</span><br><span class="line">pip install pytest-xdist</span><br><span class="line">pip install pytest-assume</span><br><span class="line">pip install pytest-html …</span><br><span class="line">pip list查看</span><br><span class="line">pytest --version</span><br><span class="line">pytest –h 帮助</span><br></pre></td></tr></table></figure>
<p><strong>pytest的框架结构</strong><br>Import pytest 类似的setup,teardown同样更灵活，还有个session()</p>
<p>模块级 (setup_module/teardown_module) 不在类中的函数有用<br>函数级 (setup_function/teardown_function) 不在类中的函数有用<br>类级 (setup_class/teardown_class)只在 类中前后运行一次。<br>方法级 (setup_method/teardown_methond) 运行在类中方法始末**</p>
<p><strong>执行方式</strong></p>
<p>pytest的执行方式<br>Pytest/py.test(终端，命令行，pycharm可配置pytest方式执行)</p>
<ol>
<li>Pytest –v (最高级别信息—verbose)</li>
<li>pytest -v -s filename 3.Pytest-q (静默)<br>(输出打印)<br>多种执行方式<br>1.pytest将在当前目录及其子目录中运行test _ <em> .py或</em> test.py形 式的所有文件。*<br>2.以test开头的函数，以Test开头的类，以test开头的方法。所有包 package都要有_init.py文件。<br>3.Pytest可以执行unittest框架写的用例和方法</li>
</ol>
<p><strong>pytets执行测试用例</strong></p>
<p>1：py测试文件必须以test（test_xxx）开头（或者以test结尾）<br>2：测试类必须以Test开头，并且不能有init方法——-测试类Test开头<br>3：测试方法必须以test开头<br>4：断言必须使用assert</p>
<p><strong>一般做项目是新建package包</strong></p>
<p>项目文件<br>　lib库文件（登录接口源代码，其他接口公共的类,封装的库，登录的，订单的）（包）<br>　data文件（参数化数据，excel文件，yaml文件，csv文件—-测试文件，用例，文档）(可以是普通文件夹)<br>　test_case文件（放测试用例的 ）（包）<br>　test_func01.py（测试用例，写的最好见名知意）<br>　report文件（存放测试报告的普通文件夹）<br>　config（配置文件）</p>
<h3 id="pytest标记"><a href="#pytest标记" class="headerlink" title="pytest标记"></a>pytest标记</h3><p>由于某种原因（如test_func2的功能尚未开发完成），我们只想执行指定的测试函数。在pytest中有几种方式可以解决：</p>
<p>第一种，显式指定函数名，通过：：标记test_no_mark.py::test_func1</p>
<p>第二种，使用模糊匹配，使用-k选项标识。pytest -k func1 test_no_mark.py</p>
<p>第三种，使用 pytest.mark在函数上进行标记</p>
<p>给用例打标签</p>
<p>注册标签名，通过.ini配置文件，格式如下：</p>
<ul>
<li>[pytest]</li>
<li>markers =</li>
<li>do: do</li>
<li>undo: undo</li>
<li>在用例上打标记</li>
</ul>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import pytest</span><br><span class="line"></span><br><span class="line">@pytest.mark.do</span><br><span class="line">deftest01():</span><br><span class="line">	print(&#x27;test01&#x27;)</span><br><span class="line">@pytest.mark.undo</span><br><span class="line">def test02():</span><br><span class="line">	print(&#x27;test02&#x27;)</span><br></pre></td></tr></table></figure>
<p>创建pytest.ini文件</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[test]</span></span><br><span class="line"><span class="attr">markers</span>=</span><br><span class="line">	do:do</span><br><span class="line">	undo:do</span><br></pre></td></tr></table></figure>
<h3 id="pytest函数"><a href="#pytest函数" class="headerlink" title="pytest函数"></a>pytest函数</h3><p>函数级别的测试用例必须test_开头：如下test_tc01，test_tc02两个测试用例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_tc01</span>():　　　　<span class="comment">#定义函数类型测试用例　　</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="number">1</span>+<span class="number">1</span>==<span class="number">2</span>  　　<span class="comment">#断言</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_tc02</span>():</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">1</span>+<span class="number">1</span>==<span class="number">3</span>  　　<span class="comment">#断言</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        pytest.main([<span class="string">&quot;test_func01.py&quot;</span>])        <span class="comment">#我主动运行我的pytest框架(自动调用所有的test测试函数，按照顺序依次运行，test开头的用例自动识别）</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>工作一般以类位单元，一个模块一个类，登录类，订单类，购物类</p>
<p>类级别的测试l类必须以Test开头，并且类李不能有init方法，类里面的函数都是test_开头</p>
<p>封装好函数和类就行，其他的交给框架，设置好，框架帮你自动组织怎么运行</p>
<p>封装为了分层，后面更好维护，代码结构整洁。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test_login</span>():  　　　　　　　　　　　　<span class="comment">#登录模块的测试类</span></span><br><span class="line">　　<span class="keyword">def</span> <span class="title function_">test_login01</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---test_login01----&quot;</span>)</span><br><span class="line">    <span class="keyword">assert</span> <span class="number">1</span> + <span class="number">1</span> == <span class="number">2</span></span><br><span class="line">　　<span class="keyword">def</span> <span class="title function_">test_login02</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---test_login02----&quot;</span>)</span><br><span class="line">    <span class="keyword">assert</span> <span class="number">1</span> + <span class="number">1</span> == <span class="number">3</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">　　pytest.main([<span class="string">&quot;test_func01.py&quot;</span>,<span class="string">&quot;-s&quot;</span>])  <span class="comment">#框架自己调用函数　　需要打印对应的信息，需要在列表里面加-s</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>自动化测试里面的环境初始化与清除</strong></p>
<p>环境初始化目的：清空测试环境的垃圾数据，前置条件</p>
<p>需不需要分层：需要。比如：课程模块：课程模块的初始化需要</p>
<p>1：删除所有的课程</p>
<p>2：新增我们的一些课程（这个给修改/查询/删除接口使用）模块级别的（大的课程模块第一件事就是删除以前的课程）</p>
<p>干掉数据后假如需要删除课程，这个接口需要单独的fixture的初始化，增加课程才能删除，其他的接口不需要这个fixture初始化，）</p>
<p>分层：模块层次的初始化，某个接口也需要初始化——框架的分层</p>
<p>条件初始化要和接口挂钩，接口该怎么就要怎么设计</p>
<p>环境初始化和清除，</p>
<p>一头一尾，两个不同概念，（环境的初始化也可以是清除数据）一个接口可以多个级别的fixture，可以</p>
<p>分布式：</p>
<p>1：并行执行 2：分布式</p>
<p>优化运行时间：分布式，（搭建环境麻烦）</p>
<p>什么是环境初始化：</p>
<p>做这个用例之前想要做个操作，初始化动作，比如登录，首先需要连上这个项目(要先能ping通)，环境初始化–比如课程新增需要数据全部清空，也是环境初始化。</p>
<p>功能测试：保证测试环境数据和跑什么系统的，或者后台有什么进程执行，或者项目里面测试这功能，功能里面有没有垃圾数据要清除　　做个初始化</p>
<p>unittest：最基础的框架，python自带（环境初始化和数据清除用setup和teardown）</p>
<p>jemeter：也有环境清除和初始化</p>
<p>不管做什么测试比如（功能，自动化，性能）都要对当前测试环境初始化，做完后要垃圾数据进行回收（特别是自动化，不然很多用例明明是对的会失败）每次做一个场景，模块的时候，看看模块有没有需要前置的或者环境清除的步骤（基本操作流程）。</p>
<p>pytest是unittest的升级版，对环境清除操作非常灵活（分层分级）</p>
<p>pytest：fixture操作类进行环境初始化 @fixture这样的一个装饰器</p>
<p>pytest的fixture操作</p>
<p>环境初始化与清除</p>
<p>pytest提供的fixture实现unitest中的setup/teardown功能，可以在每次执行case之前初始化数据</p>
<p>不同的是，fixture可以只在执行某几个特定case前运行，只需要在运行case前调用即可，比setup/teardown使用灵活</p>
<p>pytest的初始化和清除可以类里面写个setup_class方法做，以类为单元，模块，包，方法为单元都可以，也可以用fixture来做</p>
<p><strong>pytest前置和后置条件（环境初始化与清除）</strong></p>
<p>环境初始化</p>
<p>1：清除以前的数据</p>
<p>2：测试的时候不是每个接口都要执行，可以定制化执行，固定执行某些接口，先执行删除用例，但是数据已经被清除了，无法删除，修改–需要新增一批测试数据，所以这时候需要环境初始化和清除的想法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Test_login</span>(): <span class="comment">#登录模块的测试类</span></span><br><span class="line">       <span class="comment">#该测试类---有个前置的操作（初始化）</span></span><br><span class="line">       <span class="keyword">def</span> <span class="title function_">setup_class</span>(<span class="params">self</span>): <span class="comment">#类级别的初始化--可选项</span></span><br><span class="line">           <span class="comment">#一个项目，先登录，再购物，登录就是购物类的前置条件，可以放在setup_class里面</span></span><br><span class="line">           <span class="built_in">print</span>(<span class="string">&quot;执行测试类之前，我需要执行操作&quot;</span>)</span><br><span class="line"></span><br><span class="line">       <span class="keyword">def</span> <span class="title function_">test_login01</span>(<span class="params">self</span>):</span><br><span class="line">           <span class="built_in">print</span>(<span class="string">&quot;---test_login01----&quot;</span>)</span><br><span class="line">           <span class="keyword">assert</span> <span class="number">1</span> + <span class="number">1</span> == <span class="number">2</span></span><br><span class="line">       <span class="keyword">def</span> <span class="title function_">test_login02</span>(<span class="params">self</span>):</span><br><span class="line">           <span class="built_in">print</span>(<span class="string">&quot;---test_login02----&quot;</span>)</span><br><span class="line">           <span class="keyword">assert</span> <span class="number">1</span> + <span class="number">1</span> == <span class="number">3</span></span><br><span class="line"></span><br><span class="line">       <span class="keyword">def</span> <span class="title function_">teardown</span>(<span class="params">self</span>):　<span class="comment">#看业务本身需不需要初始化和清除环境，--可选项</span></span><br><span class="line">           <span class="built_in">print</span>(<span class="string">&quot;------该测试类的环境清除-----&quot;</span>)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">       pytest.main([<span class="string">&quot;test_func01.py&quot;</span>,<span class="string">&quot;-s&quot;</span>]) </span><br></pre></td></tr></table></figure>
<p><strong>pyets种有四种级别的setup和teardown</strong></p>
<p>1：setup_module和teardown_module,在整个测试用例所在的文件中所在的文件中所有的方法运行前和运行后运行，只运行一次—模块的<br>2：setup_class和teardown_class,在整个测试文件中的一个class中所有的用例的签后运行 ——class类<br>3：setup_method和teardown_method,在class内的每个方法运行前后运行 ————-方法的<br>4：setup_function和teardown_function,在非class下属的每个测试方法的前后运行 ——函数的分层分级（不同级别有不同方法）</p>
<h3 id="pytest参数"><a href="#pytest参数" class="headerlink" title="pytest参数"></a>pytest参数</h3><p>在pytest 中，也可以使用参数化测试，即每组参数都独立执行一次测试。</p>
<p>使用的工具就是 pytest.mark.parametrize（argnames，argvalues)。</p>
<p>例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="comment">#列表</span></span><br><span class="line">data1 =[<span class="string">&#x27;123&#x27;</span>,<span class="string">&#x27;456&#x27;</span>]</span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&#x27;pwd&#x27;</span>,data1</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test1</span>(<span class="params">pwd</span>):</span><br><span class="line">    <span class="built_in">print</span>(pwd)</span><br><span class="line"><span class="comment">#元组</span></span><br><span class="line">data2 = [</span><br><span class="line">    (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">    (<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line">]</span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&#x27;a,b,c&#x27;</span>,data2</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test2</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    <span class="built_in">print</span>(a,b,c)</span><br><span class="line"><span class="comment">#字典</span></span><br><span class="line">data3 = (</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;user&#x27;</span>:<span class="number">1</span>,</span><br><span class="line">        <span class="string">&#x27;pwd&#x27;</span>:<span class="number">2</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;age&#x27;</span>:<span class="number">3</span>,</span><br><span class="line">        <span class="string">&#x27;email&#x27;</span>:<span class="string">&#x27;4@qq.com&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&#x27;pwd&#x27;</span>,data3</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test3</span>(<span class="params">dic</span>):</span><br><span class="line">    <span class="built_in">print</span>(dic)</span><br><span class="line"><span class="comment">#id</span></span><br><span class="line">data4=[</span><br><span class="line">    pytest.param(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="built_in">id</span>=<span class="string">&quot;(a+b):pass&quot;</span>),<span class="comment"># id的值可以自定义，只要方便理解每个用例是干什么的即可</span></span><br><span class="line">    pytest.param(<span class="number">4</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="built_in">id</span>=<span class="string">&quot;(a+b):fail&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a,b</span>)</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestParametrize</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"><span class="meta">    @pytest.mark.parametrize(<span class="params"><span class="string">&#x27;a,b，expect&#x27;</span>，data_1</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_parametrize_l</span>(<span class="params">self，a，b， expect</span>):</span><br><span class="line">    	<span class="keyword">assert</span> add(a,b) == expect</span><br><span class="line"><span class="comment">#列表</span></span><br></pre></td></tr></table></figure>
<h3 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a><strong>读取文件</strong></h3><p><strong>Selenium读取csV文件</strong></p>
<ul>
<li>CSV文件就是逗号分隔的文本文件。</li>
<li>使用python的csv模块来处理csv文件</li>
<li>结合pytest的参数化处理方式来，实现ddt</li>
<li>实例</li>
</ul>
<p>创建CSV文件，py文件如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wqaq,sced,cxx,sdss</span><br><span class="line">123,456,789,000</span><br><span class="line">qwe,qaz,qsx,qdv</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_data</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test_csv.csv&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lst = csv.reader(f)</span><br><span class="line">        my_data = []</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> lst:</span><br><span class="line">            my_data.extend(row)</span><br><span class="line">        <span class="keyword">return</span> my_data</span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&#x27;name&#x27;</span>,get_data(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test01</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="built_in">print</span>(name)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&#x27;-sv&#x27;</span>,<span class="string">&#x27;test_csv.py&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p><strong>Selenium读取json文件</strong></p>
<ul>
<li>使用python的json模块来处理json文件</li>
<li>结合pytest的参数化处理方式来，实现ddt</li>
<li>实例</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;key&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;Tom&quot;</span><span class="punctuation">,</span><span class="string">&quot;Kite&quot;</span><span class="punctuation">,</span><span class="string">&quot;Jod&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_data</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test_json.json&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lst = []</span><br><span class="line">        data = json.load(f)</span><br><span class="line">        lst.extend(data[<span class="string">&#x27;key&#x27;</span>])</span><br><span class="line">        <span class="keyword">return</span> lst</span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&#x27;name&#x27;</span>,get_data(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test01</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="built_in">print</span>(name)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&#x27;-sv&#x27;</span>,<span class="string">&#x27;test_json.py&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p><strong>Selenium读取Excel文件</strong></p>
<ul>
<li>安装xlrd模块</li>
<li>使用xlrd模块来处理excel文件</li>
<li>结合pytest的参数化处理方式来，实现ddt</li>
<li>实例</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">import</span> xlrd</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_data</span>():</span><br><span class="line">    filename = <span class="string">&#x27;test_excel.xls&#x27;</span></span><br><span class="line">    wb = xlrd.open_workbook(filename)</span><br><span class="line">    sheet = wb.sheet_by_index(<span class="number">0</span>)</span><br><span class="line">    rows = sheet.nrows</span><br><span class="line">    cols = sheet.ncols</span><br><span class="line">    lst = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(rows):</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(cols):</span><br><span class="line">            cell_data = sheet.cell_value(row, col)</span><br><span class="line">            lst.append(cell_data)</span><br><span class="line">    <span class="keyword">return</span> lst</span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&#x27;name&#x27;</span>, get_data(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test1</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="built_in">print</span>(name)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&#x27;-sv&#x27;</span>,<span class="string">&#x27;test_excel.py&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p><strong>Selenium读取MySql数据库文件</strong></p>
<ul>
<li>安装mysqlclient模块</li>
<li>获得数据库连接</li>
<li>查询数据</li>
<li>实例</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line">conn = MySQLdb.connect(</span><br><span class="line">    host=<span class="string">&quot;192.168.0.104&quot;</span>,</span><br><span class="line">    user=<span class="string">&quot;root&quot;</span>,</span><br><span class="line">    password=<span class="string">&quot;0000&quot;</span>,</span><br><span class="line">    database=<span class="string">&quot;mydb1&quot;</span>,</span><br><span class="line">    charset=<span class="string">&quot;utf8&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_data</span>():</span><br><span class="line">    query_sql = <span class="string">&#x27;select * from user&#x27;</span></span><br><span class="line">    lst = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cursor = conn.cursor()</span><br><span class="line">        cursor.execute(query_sql)</span><br><span class="line">        r = cursor.fetchall()</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> r:</span><br><span class="line">            u = (x[<span class="number">0</span>],x[<span class="number">1</span>],x[<span class="number">2</span>])</span><br><span class="line">            lst.append(u)</span><br><span class="line">        <span class="keyword">return</span> lst</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        cursor.close()</span><br><span class="line">        conn.close()</span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&#x27;username,birthday,sex&#x27;</span>, get_data(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">testl</span>(<span class="params">username,birthday,sex</span>):</span><br><span class="line">    <span class="built_in">print</span>(username,birthday,sex)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&#x27;-sv&#x27;</span>,<span class="string">&#x27;test_mysql.py&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p><strong>Selenium  ddt(用处不多)</strong></p>
<ul>
<li>安装ddt模块</li>
<li>使用@ddt、@data、@unpack、@file_data加载数据</li>
<li>实例</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> ddt <span class="keyword">import</span> ddt,data,unpack,file_data</span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_data</span>():</span><br><span class="line">    testdata = [&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;age&#x27;</span>: <span class="number">20</span>&#125;,&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;kite&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">30</span>&#125;]</span><br><span class="line">    <span class="keyword">return</span> testdata</span><br><span class="line"><span class="meta">@ddt</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyTestCase</span>(unittest.TestCase):</span><br><span class="line">    <span class="comment"># 读取元组数据-单组元素</span></span><br><span class="line"><span class="meta">    @data(<span class="params"><span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test1</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment"># 读取元组数据-多组元素</span></span><br><span class="line"><span class="meta">    @data(<span class="params">(<span class="params"><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span>),(<span class="params"><span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span>)</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test2</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment"># 读取元组数据-拆分数据</span></span><br><span class="line"><span class="meta">    @data(<span class="params">(<span class="params"><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span>),(<span class="params"><span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span>)</span>)</span></span><br><span class="line"><span class="meta">    @unpack</span></span><br><span class="line">    <span class="comment"># 拆分数据</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test3</span>(<span class="params">self,value1,value2,value3</span>):</span><br><span class="line">        <span class="built_in">print</span>(value1,value2,value3)</span><br><span class="line">    <span class="comment"># 列表</span></span><br><span class="line"><span class="meta">    @data(<span class="params">[&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;age&#x27;</span>: <span class="number">20</span>&#125;,&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;kite&#x27;</span>,<span class="string">&#x27;age&#x27;</span>: <span class="number">30</span>&#125;]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test4</span>(<span class="params">self,value</span>):</span><br><span class="line">        <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment"># 字典</span></span><br><span class="line"><span class="meta">    @data(<span class="params">&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;age&#x27;</span>: <span class="string">&#x27;20&#x27;</span>&#125;,&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;kite&#x27;</span>,<span class="string">&#x27;age&#x27;</span>: <span class="string">&#x27;30&#x27;</span>&#125;</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test5</span>(<span class="params">self,value</span>):</span><br><span class="line">        <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment"># 字典-拆分</span></span><br><span class="line"><span class="meta">    @data(<span class="params">&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;tom&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="string">&#x27;20&#x27;</span>&#125;, &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;kite&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="string">&#x27;30&#x27;</span>&#125;</span>)</span></span><br><span class="line"><span class="meta">    @unpack</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test6</span>(<span class="params">self,name,age</span>):</span><br><span class="line">        <span class="built_in">print</span>(name,age)</span><br><span class="line">    <span class="comment"># 变量或者方法调用</span></span><br><span class="line">    testdata = [&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;age&#x27;</span>: <span class="number">20</span>&#125;,&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;kite&#x27;</span>,<span class="string">&#x27;age&#x27;</span>: <span class="number">30</span>&#125;]</span><br><span class="line">    <span class="comment"># @data（*testdata)</span></span><br><span class="line"><span class="meta">    @data(<span class="params">get_data(<span class="params"></span>)</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test7</span>(<span class="params">self,value</span>):</span><br><span class="line">        <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment"># 读文件</span></span><br><span class="line"><span class="meta">    @file_data(<span class="params">os.getcwd(<span class="params"></span>)+<span class="string">&#x27;/test_json.json&#x27;</span></span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test8</span>(<span class="params">self, value2</span>):</span><br><span class="line">        <span class="built_in">print</span>(value2)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure>
<h3 id="fixture"><a href="#fixture" class="headerlink" title="fixture"></a>fixture</h3><p><strong>unittest setup 和 teardown 简介</strong></p>
<p>学过 unittest 的都知道里面用前置和后置setup和teardown 非常好用。</p>
<ul>
<li>在每次用例开始前和结束后都去执行一次。</li>
<li>当然还有更高级一点的 setupClass 和 teardownClass，需配合 @classmethod 装饰器一起使用。</li>
<li>在做 selenium 自动化的时候，它的效率尤为突出，可以只启动一次浏览器执行多个用例。</li>
</ul>
<ol>
<li>模块级（setup_module/teardown_module）开始于模块始末，全局的</li>
<li>函数级（setup_function/teardown_function）只对函数用例生效（不在类中）</li>
<li>类级（setup_class/teardown_class）只在类中前后运行一次(在类中)</li>
<li>方法级（setup_method/teardown_method）开始于方法始末（在类中）</li>
<li>类里面的（setup/teardown）运行在调用方法的前后</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="comment">#函数级别的@pytest.fixture()初始化操作</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture() </span><span class="comment">#标记函数是个初始化操作，标记后需要传给每个函数statr_func这个函数名才会执行初始化操作（函数级别的）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">statr1_func</span>():</span><br><span class="line"></span><br><span class="line"><span class="comment">#这不是测试函数，一个普通函数,pytest执行用例只能识别test开头的方法和函数，所以pytest.main不会执行(不参加pytest用例)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;------初始化操作1------&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">statr2_func</span>():</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;------初始化操作2------&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#fixture:有哪些操作（可以多个初始化可以一起调，需要两个初始化，需要连接，需要登录）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这种写法很方便，函数需要statr_func1函数做一个初始化操作可以调用statr_func1这个函数，---def test_001(statr1_func):</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要其他初始化方法可以选择性调用其他初始化函数，传递函数名就行（灵活选择）----def test_002(statr2_func):</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#函数初始化操作需要传递几个函数也可以多个函数名传递--def test_003(statr2_func,statr1_func):</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#方便灵活</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_001</span>(<span class="params">statr1_func</span>):</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-----test01------&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_002</span>(<span class="params">statr2_func</span>):</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-----test02 ------&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_003</span>(<span class="params">statr2_func,statr1_func</span>):</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-----test03 ------&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    pytest.main([<span class="string">&quot;test_pytest.py&quot;</span>,<span class="string">&quot;-s&quot;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>类级别的初始化class，可以使用setup做初始化，也可以使用fixture做初始化</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="meta">      @pytest.fixture(<span class="params">scope=<span class="string">&quot;class&quot;</span></span>)  </span><span class="comment">#类级别的初始化函数  scope=&quot;class&quot; 就是把这个初始化定义成类级别的</span></span><br><span class="line">      <span class="keyword">def</span> <span class="title function_">statr1_func</span>():</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&quot;------初始化操作1------&quot;</span>)</span><br><span class="line">      <span class="keyword">class</span> <span class="title class_">Test_00</span>:　<span class="comment">#需要执行 Test_00测试类，需要做初始化(可以setup_class)</span></span><br><span class="line">          <span class="comment"># def setup_class(self):</span></span><br><span class="line">          <span class="comment"># print(&quot;类内部的初始化,&quot;)#只对类有用,类级别的，类里只做一次(几个类的初始化操作一样这种不适合，需要重复写)</span></span><br><span class="line">            <span class="comment">#fixture初始化类就是避免重复代码</span></span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">test_001</span>(<span class="params">self,statr1_func</span>):</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;-----test01------&quot;</span>)</span><br><span class="line"> </span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">test_002</span>(<span class="params">self,statr1_func</span>):</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;-----test02 ------&quot;</span>)</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">          pytest.main([<span class="string">&quot;test_pytest01.py&quot;</span>,<span class="string">&quot;-s&quot;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>类级别初始化fixture，虽然test_001和test_002都调用了statr1_func这个类级别的初始化函数，但是执行类测试用例的时候只执行statr1_func初始函数一次<br>多个类都可以调用statr1_func这个类级别的初始化方法,调用的时候最好放在类里的第一个函数，后面的函数可以不传(因为对应的是类级别的初始化)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="meta">     @pytest.fixture(<span class="params">scope=<span class="string">&quot;class&quot;</span></span>)  </span><span class="comment">#类级别的初始化函数</span></span><br><span class="line">     <span class="keyword">def</span> <span class="title function_">statr1_func</span>():</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">&quot;------初始化操作1------&quot;</span>)</span><br><span class="line">     <span class="comment">#一个模块里面有函数用例也有类的用例怎么做：（class级别的初始化只对类有用，对函数没用）</span></span><br><span class="line">     <span class="keyword">def</span> <span class="title function_">test_003</span>(<span class="params">statr1_func</span>):  <span class="comment">#测试函数,</span></span><br><span class="line">         <span class="built_in">print</span>(<span class="string">&quot;-----test03------&quot;</span>)</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">class</span> <span class="title class_">Test_00</span>:   <span class="comment">#需要执行test00测试类，需要做初始化(可以setup_class)</span></span><br><span class="line">         <span class="keyword">def</span> <span class="title function_">test_001</span>(<span class="params">self,statr1_func</span>):</span><br><span class="line">             <span class="built_in">print</span>(<span class="string">&quot;-----test01------&quot;</span>)</span><br><span class="line"> </span><br><span class="line">         <span class="keyword">def</span> <span class="title function_">test_002</span>(<span class="params">self,statr1_func</span>):</span><br><span class="line">             <span class="built_in">print</span>(<span class="string">&quot;-----test02 ------&quot;</span>)</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">         pytest.main([<span class="string">&quot;test_pytest01.py&quot;</span>,<span class="string">&quot;-s&quot;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>初始化方法statr1_func定义成class类级别的，函数级别的测试测试用例test__003调用初始化函数会执行一次，<br>　　class类级别的测试用例Test_00调用初始化函数会执行一次（一共执行两次）<br>　　看级别的，整个模块的级别的化最好用module，否则有问题，fixture可以做return，会有返回值的，对应级别来做，<br>执行结果：<br>　test_pytest01.py<br>　———初始化操作1———<br>　———test03———<br>　———初始化操作1———<br>　———test01———<br>　———test02 ———</p>
<p><strong>类级别初始化实际代码：初始化操作是登录操作</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#课程模块的测试类</span></span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">from</span> lib.api_lib.lesson <span class="keyword">import</span> Lesson</span><br><span class="line"><span class="keyword">from</span> lib.api_lib.lesson <span class="keyword">import</span> Login</span><br><span class="line"><span class="keyword">from</span> tools.execlMethod <span class="keyword">import</span> get_excelData</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line"><span class="meta">   @pytest.fixture(<span class="params">scope=<span class="string">&quot;class&quot;</span></span>) 　　</span><span class="comment">#类级别的初始化函数</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">start_func</span>():</span><br><span class="line">      <span class="keyword">global</span> sessionid</span><br><span class="line">      sessionid = Login().login(<span class="string">&#x27;&#123;&quot;username&quot;:&quot;auto&quot;,&quot;password&quot;:&quot;sdfsdfsdf&quot;&#125;&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Test_lesson</span>:</span><br><span class="line">   <span class="comment">#1:课程新增接口,前置条件登录(封装完一个方法后想办法做数据驱动)，课程增加需要通过excel表用例来做</span></span><br><span class="line"><span class="meta">   @pytest.mark.parametrize(<span class="params"><span class="string">&quot;inData,repsData&quot;</span>, get_excelData(<span class="params"><span class="string">&#x27;2-课程模块&#x27;</span>, <span class="number">2</span>, <span class="number">26</span></span>)</span>)</span></span><br><span class="line">      <span class="keyword">def</span> <span class="title function_">test_lesson_add</span>(<span class="params">self,start_func,inData,repsData</span>):</span><br><span class="line">        reps=Lesson(sessionid).lesson_add(inData)</span><br><span class="line">        <span class="built_in">print</span>(reps)</span><br><span class="line">        <span class="keyword">assert</span> reps[<span class="string">&quot;retcode&quot;</span>]==json.loads(repsData)[<span class="string">&quot;retcode&quot;</span>]</span><br><span class="line">   <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">      pytest.main([<span class="string">&quot;test_lesson01.py&quot;</span>, <span class="string">&quot;-s&quot;</span>, <span class="string">&quot;--alluredir&quot;</span>, <span class="string">&quot;../report/tmp&quot;</span>])</span><br><span class="line">      os.system(<span class="string">&quot;allure serve ../report/tmp&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>模块级别的初始化mudule，不管是类还是方法@pytest.fixture(scope=“module”)模块（module）级别的初始化，（整个模块所有的类所有的东西要做一步操作，可以使用module这个模式）只在模块运行前面只做一次，后面不做了，哪怕多调用也没用，一个模块里面有test_003函数测试用例，也有classTest_00类级别的测试用例，定义一个模块级别的初始化函数statr1_func函数里面调用初始化方法def test_003(statr1_func):</p>
<p>和类里面的方法调用初始化方法</p>
<p>test_001(self,statr1_func):，test_001(self,statr1_func):</p>
<p>整个模块执行的时候初始化函数都只执行一次（不管你这个模块里面调用多少次）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="meta">        @pytest.fixture(<span class="params">scope=<span class="string">&quot;module&quot;</span></span>)  </span><span class="comment">#模块级别的初始化函数</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">statr1_func</span>():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;------初始化操作1------&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="comment">#一个模块里面有函数用例也有类的用例怎么做：（class级别的初始化只对类有用，对函数没用）</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">test_003</span>(<span class="params">statr1_func</span>):  　<span class="comment">#测试函数,</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-----test03------&quot;</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">Test_00</span>:   </span><br><span class="line">			<span class="comment">#需要执行test00测试类，需要做初始化(可以setup_class)</span></span><br><span class="line">            <span class="comment"># def setup_class(self):</span></span><br><span class="line">            <span class="comment"># print(&quot;类内部的初始化,&quot;) 　</span></span><br><span class="line">            <span class="comment"># 只对类有用,类级别的，类里只做一次(几个类的初始化操作一样这种不适合，需要重复写)</span></span><br><span class="line">            <span class="comment"># fixture初始化类就是避免重复代码</span></span><br><span class="line"> </span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">test_001</span>(<span class="params">self,statr1_func</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;-----test01------&quot;</span>)</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">test_001</span>(<span class="params">self,statr1_func</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;-----test02 ------&quot;</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">            pytest.main([<span class="string">&quot;test_pytest01.py&quot;</span>,<span class="string">&quot;-s&quot;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">执行结果：test_pytest01.py</span><br><span class="line">------初始化操作<span class="number">1</span>------</span><br><span class="line">-----test03------</span><br><span class="line">.-----test01------</span><br><span class="line">.-----test02 ------</span><br></pre></td></tr></table></figure>
<p>在这个模块下面所有的都会调用（包级别的，包里面运行前做个环境清除）需要在testcase文件夹里面创建一个conftest.py模块，这个固定名称，pytest自动识别这个名称</p>
<p>testcase里面：新增课程前面需要登录，增加课程前面需要清除数据，需要2个级别的初始化，1：登录 2：整个环境的清除test_case（测试用例文件夹）创建一个：conftest.py文件　　里面写包级别的初始化conftest.py文件里也能写类级别和模块级别的初始化，而且不需要调用，这个conftest.py模块是pytest自动识别导入的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> test_case <span class="comment">#文件夹</span></span><br><span class="line">     conftest.py           </span><br><span class="line">         <span class="keyword">import</span> pytest</span><br><span class="line">         <span class="comment">#包级别的初始化，在运行整个包之前做个初始化，包里面不同作用域，每个包里面都可以放一个，每个包里面的操作都可以不一样</span></span><br><span class="line"><span class="meta">         @pytest.fixture(<span class="params">scope=<span class="string">&quot;session&quot;</span>,autouse=<span class="literal">True</span></span>)</span></span><br><span class="line">         <span class="comment">#session级别的处于时候autouse=True默认自动执行</span></span><br><span class="line">         <span class="keyword">def</span> <span class="title function_">start_demo</span>(<span class="params">request</span>):  <span class="comment">#包的开始</span></span><br><span class="line">             <span class="built_in">print</span>(<span class="string">&quot;我是整个包的初始化&quot;</span>)</span><br><span class="line">             <span class="keyword">def</span> <span class="title function_">fin</span>(): </span><br><span class="line">                 <span class="comment">#尾部这是包级别的，整个包做完后做个环境数据的清除    包的结束</span></span><br><span class="line">                 <span class="built_in">print</span>(<span class="string">&#x27;---测试完成，包的数据清除---&#x27;</span>)</span><br><span class="line">             request.addfinalizer(fin)　</span><br><span class="line">             <span class="comment">#回调，当我整个包运行完了后回调fin这个方法</span></span><br><span class="line"><span class="comment">#fixture的参数autouse: bool = False,---自动执行参数</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>#session的级别，包里面有很多模块，很多模块需要对整个包进行初始化在conftest.py里面做模块的数据初始化和清除（conftest.py只对当前包有用）</p>
<p><strong>两种调用初始化和清除函数的方式+初始化清除函数的返回值的使用</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">befor_func</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;xxxxxxxxxxxxx测试用例的初始化xxxxxxxxxxxxxxxx&#x27;</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">10</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;zzzzzzzzzzzzzzzzzz测试用例的清除zzzzzzzzzzzzzz&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_001</span>(<span class="params">befor_func</span>):</span><br><span class="line">    <span class="comment">#调用初始化和清除方式一：直接在测试用例里传递初始化清除函数的函数名来调用</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;测试用例001&quot;</span>)</span><br><span class="line">    res=befor_func　　　　　　　　　　　　　　　　　　　　</span><br><span class="line">    <span class="comment">#如果初始化清除函数有返回值，可以直接这样接收参数来使用</span></span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line"> </span><br><span class="line"><span class="meta">@pytest.mark.usefixtures(<span class="params"><span class="string">&#x27;befor_func&#x27;</span></span>)　　　　　　　　</span></span><br><span class="line"><span class="comment">#调用初始化和清除方式二：使用usefixtures放在测试用例前面直接调用初始化清除函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_002</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;测试用例002&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&quot;test1.py&quot;</span>,<span class="string">&#x27;-s&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>pytest前置条件+后置条件的两种写法</strong></p>
<p>1：使用yield关键字来是实现　　推荐使用这种，因为yield关键字能返回函数的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">befor_func</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;xxxxxxxxxxxxx测试用例的初始化xxxxxxxxxxxxxxxx&#x27;</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">10</span>　　　　　　　　　　　　　　　　　　　　　　　　　　　　</span><br><span class="line">    <span class="comment">#yield后面跟的是测试用例的后置条件，支持用例执行后就执行yield里的内容</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;zzzzzzzzzzzzzzzzzz测试用例的清除zzzzzzzzzzzzzz&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_001</span>(<span class="params">befor_func</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;测试用例001&quot;</span>)</span><br><span class="line">    res=befor_func</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&quot;test1.py&quot;</span>,<span class="string">&#x27;-s&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>2：使用finc()函数来实现　　　　这种就不能返回返回值了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">befor_func</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;xxxxxxxxxxxxx测试用例的初始化xxxxxxxxxxxxxxxx&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fin</span>():　　　　　　　　　　　　　　　　　　　　　　　　</span><br><span class="line">        <span class="comment">#尾部这是后置条件，测试用例执行后就会调用这个函数　　　　　　</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;zzzzzzzzzzzz测试用例的清除zzzzzzzzzzz&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    request.addfinalizer(fin)　　　　　　　　　　　　　　　</span><br><span class="line">    <span class="comment">#回调，当我整个包运行完了后回调fin这个方法　　　　　　　　　　</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_001</span>(<span class="params">befor_func</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;测试用例001&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&quot;test1.py&quot;</span>,<span class="string">&#x27;-s&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>16：pytest数据驱动（参数化）　<br>pytest数据驱动的意义：</p>
<p>参数化（登录用例4条，每一个账号密码都不同，使用框架把4个用例全部执行完，不需要for循环遍历执行，采用数据驱动方案来做）</p>
<p>pytest内置装饰器@pytest.mark.parametrize可以让测试数据参数化，把测试数据单独管理，类似ddt数据驱动的作用，方便代码和测试数据分离</p>
<p>@pytest.mark.parametrize(“a”,[1,2,3])：　　　　　　　　参数化传一组参数</p>
<p>@pytest.mark.parametrize(“a,b”, [(1,2),(3,4),(5,6)]) 　　 参数化传多组参数</p>
<p>登录账户密码（name和psw不同的用例组合，一个接口几十个用例怎么做——几十组数据——传的参数不同（什么请求方式和各种都一样）可以把name和psw分别采取多组数据进行参数化，数据分离，一个接口跑4次，每次用不同的参数）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="comment">#[(1,2),(3,4),(5,6)]   [1,2,3]</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test_login</span>():  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup_class</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;执行测试类之前，我需要执行操作&quot;</span>)</span><br><span class="line"><span class="meta">    @pytest.mark.parametrize(<span class="params"><span class="string">&quot;a&quot;</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span>)            </span></span><br><span class="line">	 <span class="comment">#(&quot;变量名&quot;,[1,2,3]),数据需要封装成一个列表，多个数据需要封装成列表嵌套元组----数据驱动</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_login01</span>(<span class="params">self,a</span>):                  </span><br><span class="line">        <span class="comment">#数据驱动，一定要把变量名a引入引来，不然无法参数化</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;---test_login01----&quot;</span>)</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">1</span> + <span class="number">1</span> == a</span><br><span class="line"><span class="meta">        @pytest.mark.parametrize(<span class="params"><span class="string">&quot;a,b&quot;</span>, [(<span class="params"><span class="number">1</span>,<span class="number">2</span></span>),(<span class="params"><span class="number">3</span>,<span class="number">4</span></span>),(<span class="params"><span class="number">5</span>,<span class="number">6</span></span>)]</span>)    \</span></span><br><span class="line">        <span class="comment">#数据驱动传多组参数</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">test_login02</span>(<span class="params">self,a,b</span>):</span><br><span class="line">             <span class="built_in">print</span>(<span class="string">&quot;---test_login02----&quot;</span>)</span><br><span class="line">             <span class="keyword">assert</span> a + <span class="number">1</span> == b</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">teardown_class</span>(<span class="params">self</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;------该测试类的环境清除-----&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        pytest.main([<span class="string">&quot;test_func01.py&quot;</span>,<span class="string">&quot;-s&quot;</span>])  </span><br></pre></td></tr></table></figure>
<p><strong>fixture的自动应用autouse</strong></p>
<p>平常写自动化用例会写一些前置的fixture操作，用例需要用到就直接传该函数的参数名称就行了。当用例很多的时候，每次都传这个参数，会比较麻烦。<br>fixture里面有个参数autouse，默认是Fasle没开启的，可以设置为True开启自动使用fixture功能，这样用例就不用每次都去传参了</p>
<p>设置autouse=True<br>autouse设置为True，自动调用fixture功能<br>start设置scope为module级别，在当前.py用例模块只执行一次，autouse=True自动使用[图片]open_home设置scope为function级别，<br>每个用例前都调用一次，自动使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture(<span class="params">scope=<span class="string">&quot;module&quot;</span>,autouse=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n----开始执行module------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;module : %s&#x27;</span>% request.module.__name__)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;------启动浏览器-------&#x27;</span>)</span><br><span class="line">    <span class="keyword">yield</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;------结束测试 end!----------&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture(<span class="params">scope=<span class="string">&quot;function&quot;</span>,autouse=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">open_home</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;function:%s \n--回到首页--&quot;</span>% request.function.__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_01</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;----用例01-----&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_02</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;----用例02-----&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&quot;-s&quot;</span>,<span class="string">&quot;autouse.py&quot;</span>])</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">----开始执行module------</span><br><span class="line">module : autouse</span><br><span class="line">------启动浏览器-------</span><br><span class="line">function:test_01 </span><br><span class="line">--回到首页--</span><br><span class="line">.----用例01-----</span><br><span class="line">function:test_02 </span><br><span class="line">--回到首页--</span><br><span class="line">.----用例02-----</span><br><span class="line">------结束测试 end!----------</span><br></pre></td></tr></table></figure>
<h3 id="allure"><a href="#allure" class="headerlink" title="allure"></a>allure</h3><p>部署使用<br>Pytest作为一个高扩展性、功能强大的自动化测试框架，自身的测试结果是较为简单的，如果想要一份完整<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=测试报告&amp;spm=1001.2101.3001.7020">测试报告</a>需要其他插件的支持。如果你对测试报告要求没那么高，你可以使用 pytest-html 插件，基本覆盖了测试报告的常规内容。</p>
<p>注意：allure-pytest 从1.7之后已弃用，从2.0版本开始迁移至 allure-python 项目（即使用allure2），另外要运行allure命令行也需要Java的支持。</p>
<p>Allure提供了一个清晰的全局，涵盖了所涵盖的功能，缺陷聚集的位置，执行时间表，以及许多其他方便的事情。</p>
<p>独特的模块化和可扩展性，确保你能够进行适当的微调，以使更适合你自己。</p>
<p>官方文档：Allure Framework</p>
<p><a target="_blank" rel="noopener" href="https://docs.qameta.io/">https://docs.qameta.io/</a></p>
<p><strong>安装：</strong><br>（1）allure-pytest插件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install -U allure-pytest</span><br><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>这将安装allure-pytest和allure-python-commons程序包，以生成与allure2兼容的报告数据。</p>
<p>（2）allure工具：</p>
<p>官方下载地址：<a target="_blank" rel="noopener" href="https://github.com/allure-framework/allure2/releases">https://github.com/allure-framework/allure2/releases</a></p>
<p>解压软件包(建议直接放到Python文件夹下)，然后添加bin目录到环境变量中，最后使用 allure —version 验证是否安装成功。</p>
<p>一：pytest自带的报告框架 pytest-html</p>
<p>二：allure环境搭建（allure是报告库不是python专属的，很全面的框架）-allure报告漂亮</p>
<p>1：下载allure.zip（压缩包）<br>2：解压allure.zip到一个文件目录<br>3：将allure-2.13.3\bin路径添加到环境变量path<br>4：pip install allure-pytest ——-allure报告本身不是很漂亮，通过allure-pytest这个库可以定制化报告，让报告变得很漂亮<br>5：验证（cmd输入allure）</p>
<p>三：allure和pytest联合执行生成报告：运行两条语句</p>
<p>1：执行pytest单元测试，生成的allure报告需要的数据存在/tmp目录</p>
<p>pytest -sq —alluredir=…/report/tmp #pytest把allure报告的生成的中间文件放到一个临时文件里（pytets生成报告，需要数据，所以先把数据存起来）</p>
<p>#所有的报告需要数据支持的，数据来源pytest框架本身，结果数据存到一个文件，存在…/report/tmp文件夹#tmp临时文件，一般json格式</p>
<p>2：执行命令，生成测试报告</p>
<p>allure generate …/report/tmp -o …/report/report -clean #allure指令生成对应报告</p>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a><strong>描述</strong></h3><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">使用方法</th>
<th style="text-align:center">参数值</th>
<th style="text-align:center">参数值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">@allure.epic()</td>
<td style="text-align:center">epic描述</td>
<td style="text-align:center">敏捷里面的概念，定义史诗，往下是feature</td>
</tr>
<tr>
<td style="text-align:center">@allure.feature()</td>
<td style="text-align:center">模块名称</td>
<td style="text-align:center">功能点的描述，往下是story</td>
</tr>
<tr>
<td style="text-align:center">@allure.story()</td>
<td style="text-align:center">用户故事</td>
<td style="text-align:center">用户故事，往下是title</td>
</tr>
<tr>
<td style="text-align:center">@allure.title(用例的标题)</td>
<td style="text-align:center">用例的标题</td>
<td style="text-align:center">重命名html报告名称</td>
</tr>
<tr>
<td style="text-align:center">@allure.testcase()</td>
<td style="text-align:center">测试用例的链接地址</td>
<td style="text-align:center">对应功能测试用例系统里面的case</td>
</tr>
<tr>
<td style="text-align:center">@allure.issue()</td>
<td style="text-align:center">缺陷</td>
<td style="text-align:center">对应缺陷管理系统里面的链接</td>
</tr>
<tr>
<td style="text-align:center">@allure.description</td>
<td style="text-align:center">用例描述</td>
<td style="text-align:center">测试用例的描述</td>
</tr>
<tr>
<td style="text-align:center">@allure.step()</td>
<td style="text-align:center">操作步骤</td>
<td style="text-align:center">测试用例的步骤</td>
</tr>
<tr>
<td style="text-align:center">@allure.severity()</td>
<td style="text-align:center">用例等级</td>
<td style="text-align:center">blocker, critical, normal, minor, trivial</td>
</tr>
<tr>
<td style="text-align:center">@allure.link()</td>
<td style="text-align:center">链接</td>
<td style="text-align:center">定义一个链接，在测试报告展现</td>
</tr>
<tr>
<td style="text-align:center">@allure.attachment()</td>
<td style="text-align:center">附件</td>
<td style="text-align:center">报告添加附件</td>
</tr>
</tbody>
</table>
</div>
<p><strong>allure模拟代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line">      <span class="keyword">import</span> os</span><br><span class="line">      <span class="keyword">class</span> <span class="title class_">Test_login</span>():  </span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">setup_class</span>(<span class="params">self</span>):</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;执行测试类之前，我需要执行操作&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">          @pytest.mark.parametrize(<span class="params"><span class="string">&quot;a&quot;</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span>)</span></span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">test_login01</span>(<span class="params">self,a</span>):  </span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;---test_login01----&quot;</span>)</span><br><span class="line">              <span class="keyword">assert</span> <span class="number">1</span> + <span class="number">1</span> == a</span><br><span class="line"> </span><br><span class="line"><span class="meta">          @pytest.mark.parametrize(<span class="params"><span class="string">&quot;a,b&quot;</span>, [(<span class="params"><span class="number">1</span>,<span class="number">2</span></span>),(<span class="params"><span class="number">3</span>,<span class="number">4</span></span>),(<span class="params"><span class="number">5</span>,<span class="number">6</span></span>)]</span>)</span></span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">test_login02</span>(<span class="params">self,a,b</span>):</span><br><span class="line">               <span class="built_in">print</span>(<span class="string">&quot;---test_login02----&quot;</span>)</span><br><span class="line">               <span class="keyword">assert</span> a + <span class="number">1</span> == b</span><br><span class="line"> </span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">teardown_class</span>(<span class="params">self</span>):</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;------该测试类的环境清除-----&quot;</span>)</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">                          </span><br><span class="line">      <span class="comment">#需要打印对应的信息，需要在列表里面加-s            </span></span><br><span class="line">      <span class="comment">#1:--alluredir ---生成临时文件，测试用例的结果数据放到目录   --alluredir   存放目录</span></span><br><span class="line">          pytest.main([<span class="string">&quot;test_func01.py&quot;</span>,<span class="string">&quot;-s&quot;</span>,<span class="string">&quot;--alluredir&quot;</span>,<span class="string">&quot;../report/tmp&quot;</span>])  </span><br><span class="line">          <span class="comment">#框架自己调用函数</span></span><br><span class="line">          <span class="comment">#通过--alluredir把allure需要的数据存到../report/tmp这个路径下面            </span></span><br><span class="line">          <span class="comment">#../--所在路径的父级别目录是test_case的目录隔壁邻居report文件下tmp，专门放alluer报告生成的需要的数据源</span></span><br><span class="line">          <span class="comment"># 2:临时数据没有报告的，allure generate allure才会生成报告   -----allure生成器生成allure报告--generate allure生成器,cmd指令</span></span><br><span class="line">          <span class="comment">#需要os模块os.system()调用指令可以在local的cmd里面敲</span></span><br><span class="line">          os.system(<span class="string">&quot;allure generate ../report/tmp -o ../report/report --clean&quot;</span>)</span><br><span class="line">          <span class="comment">#os.system(&quot;allure generate 报告需要的数据 -o 报告存放目录 --clean&quot;)</span></span><br><span class="line">          <span class="comment">#-o生成</span></span><br><span class="line">          <span class="comment">#allure generate生成报告指令，把../report/tmp 的文件-o生成报告out out一下，生成的报告放在../report/report</span></span><br><span class="line">          <span class="comment">#--clean把上次报告清除一下用--clean</span></span><br><span class="line">　 　　　　　 <span class="comment">#allure报告生成的是一个服务，（本地服务）和jinkins结合，放在整个里面去集成，放到公共服务器里面          </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>allure报告的优化</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line">      <span class="keyword">import</span> os</span><br><span class="line">      <span class="keyword">import</span> allure       </span><br><span class="line"><span class="meta">      @allure.feature(<span class="params"><span class="string">&quot;登录模块&quot;</span></span>)                                                      </span><span class="comment">#一级标题，大模块标题（类标签）</span></span><br><span class="line">      <span class="keyword">class</span> <span class="title class_">Test_login</span>():                                                         </span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">setup_class</span>(<span class="params">self</span>):                                                 </span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;执行测试类之前，我需要执行操作&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">          @allure.story(<span class="params"><span class="string">&quot;登录login01&quot;</span></span>)                                                  </span><span class="comment"># 二级标签（每个接口的标签）</span></span><br><span class="line"><span class="meta">          @allure.title(<span class="params"><span class="string">&quot;login01&quot;</span></span>)                                                     </span><span class="comment"># 标题，每个用例带个标题（报告体现在每个测试用例）(一个接口有几个用例，title用例的标签)</span></span><br><span class="line"><span class="meta">          @pytest.mark.parametrize(<span class="params"><span class="string">&quot;a&quot;</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span>)                                      </span></span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">test_login01</span>(<span class="params">self,a</span>):                                                      </span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;---test_login01----&quot;</span>)</span><br><span class="line">              <span class="keyword">assert</span> <span class="number">1</span> + <span class="number">1</span> == a</span><br><span class="line"> </span><br><span class="line"><span class="meta">          @allure.story(<span class="params"><span class="string">&quot;登录login02&quot;</span></span>)                                             			   </span><span class="comment"># 二级标签，定制allure报告层级</span></span><br><span class="line"><span class="meta">          @allure.title(<span class="params"><span class="string">&quot;login02&quot;</span></span>) </span></span><br><span class="line">          <span class="comment"># 标题，每个用例带个标题（报告体现在每个测试用例）</span></span><br><span class="line"><span class="meta">          @pytest.mark.parametrize(<span class="params"><span class="string">&quot;a,b&quot;</span>, [(<span class="params"><span class="number">1</span>,<span class="number">2</span></span>),(<span class="params"><span class="number">3</span>,<span class="number">4</span></span>),(<span class="params"><span class="number">5</span>,<span class="number">6</span></span>)]</span>)                      </span></span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">test_login02</span>(<span class="params">self,a,b</span>):</span><br><span class="line">               <span class="built_in">print</span>(<span class="string">&quot;---test_login02----&quot;</span>)</span><br><span class="line">               <span class="keyword">assert</span> a + <span class="number">1</span> == b</span><br><span class="line"> </span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">teardown_class</span>(<span class="params">self</span>):                                               </span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;------该测试类的环境清除-----&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">      @allure.feature(<span class="params"><span class="string">&quot;购物模块&quot;</span></span>)</span></span><br><span class="line">      <span class="keyword">class</span> <span class="title class_">Test_Shopping</span>():</span><br><span class="line"><span class="meta">          @allure.story(<span class="params"><span class="string">&quot;shopping&quot;</span></span>)</span></span><br><span class="line"><span class="meta">          @allure.title(<span class="params"><span class="string">&quot;shopping01&quot;</span></span>)</span></span><br><span class="line"><span class="meta">          @pytest.mark.parametrize(<span class="params"><span class="string">&quot;a,b&quot;</span>, [(<span class="params"><span class="number">1</span>, <span class="number">2</span></span>), (<span class="params"><span class="number">3</span>, <span class="number">4</span></span>), (<span class="params"><span class="number">5</span>, <span class="number">6</span></span>)]</span>)</span></span><br><span class="line">          <span class="keyword">def</span> <span class="title function_">test_shopping</span>(<span class="params">self, a, b</span>):</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;---test_login02----&quot;</span>)</span><br><span class="line">              <span class="keyword">assert</span> a + <span class="number">1</span> == b</span><br><span class="line">      <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">          pytest.main([<span class="string">&quot;test_func01.py&quot;</span>,<span class="string">&quot;-s&quot;</span>,<span class="string">&quot;--alluredir&quot;</span>,<span class="string">&quot;../report/tmp&quot;</span>])    </span><br><span class="line">          os.system(<span class="string">&quot;allure generate ../report/tmp -o ../report/report --clean&quot;</span>)</span><br><span class="line">          <span class="comment">#allure报告生成的是一个服务，（本地服务）和jinkins结合，放在整个里面去集成，放到公共服务器里面。</span></span><br></pre></td></tr></table></figure>
<p><strong>其他知识点</strong><br>测试用例一般写在excel表格文件里面，数据分离（维护好excel就行）</p>
<p>pytest–从头到尾到报告执行发邮件</p>
<p>字典是一种存储类型，json是一种格式（完全不同）</p>
<p><strong>pytest参数解析</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">　pytest.main([<span class="string">&#x27;test_boss.py&#x27;</span>,<span class="string">&#x27;-s&#x27;</span>,<span class="string">&#x27;-k test_modify_psw&#x27;</span>,<span class="string">&#x27;--alluredir=tmp/my_allure_results&#x27;</span>])</span><br><span class="line"> </span><br><span class="line">　　　　test_boss.py 　　　　　　　　指定测试用例文件，</span><br><span class="line">　　　　-s 　　　　　　　　　　　　 显示<span class="built_in">print</span>语句</span><br><span class="line">　　　　-k test_modify_psw 　　　　 指定某个测试用例</span><br><span class="line"> </span><br><span class="line">　　　　-n 　　　　　　　　　　　　表示用两个进程启动测试脚本</span><br><span class="line"> </span><br><span class="line">　　　　生成报告缓存文件　　--alluredir=tmp/my_allure_results</span><br><span class="line"> </span><br><span class="line">　　　　os.system(<span class="string">&#x27;allure serve tmp/my_allure_results&#x27;</span>)　　　　打开测试报告，命令行需要python 的os模块调用</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>pytest的初始化和清除：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line">        <span class="comment">#假设启动被测app的时候需要去填写配置项信息，每个的端口号不同，多终端需要两个appim server</span></span><br><span class="line">        <span class="comment">#这时候setup_module和teardown_module不能传参，搞不定，需要换一种方法做测试用例的初始化和清除，　　　　　　　　　　　</span></span><br><span class="line">    	<span class="comment">#setup_module以模块为作用域，不写module以测试用例（测试函数）为作用域</span></span><br><span class="line">        <span class="comment"># def setup_module(): 　　 </span></span><br><span class="line">        <span class="comment">#测试用例之前执行，原始的setup和teardown有个缺陷，里面不能传参数        　　　　　　   </span></span><br><span class="line">        <span class="comment">#默认test级别，每个测试用例执行的时候都会执行一次，希望当前某个模块执行的时候只执行一次（不管里面用例执行多少次）          　　　　　　   </span></span><br><span class="line">        <span class="comment">#setup初始化和tear_down升个级，升级成module模块级别的</span></span><br><span class="line">        <span class="comment">#     print(&quot;启动被测app&quot;)</span></span><br><span class="line">        <span class="comment">#     print(&#x27;连接appium服务&#x27;)</span></span><br><span class="line">        <span class="comment"># def teardown_module():</span></span><br><span class="line">        <span class="comment">#     print(&#x27;关闭被测app&#x27;)</span></span><br><span class="line">        <span class="comment">#     print(&#x27;断开appium服务&#x27;)</span></span><br><span class="line">        <span class="comment">#定义个函数，名字随便取　　使用@pytest.fixture装饰器把这个函数装饰成初始化清除函数</span></span><br><span class="line"><span class="meta">        @pytest.fixture(<span class="params">scope=<span class="string">&#x27;module&#x27;</span></span>)    </span></span><br><span class="line">        <span class="comment">#作用域默认test，初始化，加装饰器，初始化清除函数,autouse=True（自动执行）这种方法不建议使用</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">before_test</span>():                  </span><br><span class="line">            <span class="comment">#初始化函数升级作用域到module模块级别</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;启动被测app&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;连接appium服务&#x27;</span>)</span><br><span class="line">            <span class="keyword">yield</span>   <span class="comment">#后面写清除动作，</span></span><br><span class="line">            after_test()</span><br><span class="line"> </span><br><span class="line">        <span class="comment">#清除函数，清除函数并不会直接被初始化函数使用，我们必须放在初始化函数yiled后面才能回被调用</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">after_test</span>():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;关闭被测app&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;断开appium服务&#x27;</span>)</span><br><span class="line">        <span class="comment">#目前一共有两个port，需要测试两个手机，两个多终端,before_test需要装饰器标记</span></span><br><span class="line">        <span class="comment">#测试用例的参数化</span></span><br><span class="line"><span class="meta">        @pytest.mark.usefixtures(<span class="params"><span class="string">&#x27;before_test&#x27;</span></span>)                        </span></span><br><span class="line">        <span class="comment">#这表示调用某个自定义的初始化函数，括号里面的字符串写被调用函数的名字</span></span><br><span class="line"><span class="meta">        @pytest.mark.parametrize(<span class="params"><span class="string">&#x27;psw&#x27;</span>,[<span class="string">&#x27;boss123&#x27;</span>,<span class="string">&#x27;boss456&#x27;</span>]</span>)</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">test_app</span>(<span class="params">psw</span>):                        </span><br><span class="line">            <span class="comment">#测试用例，可能涉及到其他参数,比如需要一些配置信息,测试用例涉及到参数，　　　　　　　　　　　　　　　　　　　　　　</span></span><br><span class="line">            <span class="comment">#多组参数需要使用装饰器pytest.mark.parametrize(数据驱动)，psw传参和形参名字对应</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;测试boss app&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;登录测试账号<span class="subst">&#123;psw&#125;</span>&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">            pytest.main([<span class="string">&#x27;pytest_ywt.py&#x27;</span>,<span class="string">&#x27;-s&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>pytest之：不只是测试函数test_app能参数化，初始化函数before_test也能参数化。</p>
<p>重点：</p>
<p>测试用例的参数化+初始化清除函数的参数化　　</p>
<p>初始化清除函数的参数化能够实现appium的多终端测试</p>
<p>初始化清除函数的参数化，方法很多种：</p>
<p>before_test初始化函数注入参数，因为print(f’连接appium服务{port}’)里面port需要变化的，</p>
<p>@pytest.fixture(scope=‘module’,params=[(4723,),(4727,)])　　：初始化清除函数的参数化</p>
<p>始化函数装饰器里面加params参数传参，port=request.param[0] 来调用params里的参数</p>
<p>#初始化清除函数的参数化：只传单个参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="meta">@pytest.fixture(<span class="params">scope=‘module’,params=[(<span class="params"><span class="number">4723</span>,</span>),(<span class="params"><span class="number">4727</span>,</span>)]</span>) </span></span><br><span class="line"><span class="comment">#初始化清除函数的参数化params</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">before_test</span>(<span class="params">request</span>):</span><br><span class="line">port=request.param[<span class="number">0</span>] 　　　　　　　　　　　　　　</span><br><span class="line"><span class="comment">#param[0]，假如注入多个参数一个port和一个data–需要params传元组，</span></span><br><span class="line"><span class="comment">#params=[(4723,100),(4727,200)],一个参数的话不需要写成列表嵌套元素，　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　</span></span><br><span class="line"><span class="comment">#params[0]代表获取元组第一个</span></span><br><span class="line"><span class="built_in">print</span>(“启动被测app”)</span><br><span class="line"><span class="built_in">print</span>(f’连接appium服务&#123;port&#125;<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">yield #后面写清除动作，</span></span><br><span class="line"><span class="string">after_test()　　　　　　　　　　　　　　　　　　　　　　　　</span></span><br><span class="line"><span class="string">#request是pytest的对象，我们在用对象里面的方法的时候pycham不会自动帮我们取显示名字，</span></span><br><span class="line"><span class="string">#它也不知道request里面到底什么内容</span></span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">def</span> <span class="title function_">after_test</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;关闭被测app&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;断开appium服务&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">@pytest.mark.usefixtures(<span class="params"><span class="string">&#x27;before_test&#x27;</span></span>)    </span></span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&#x27;psw&#x27;</span>,[<span class="string">&#x27;boss123&#x27;</span>,<span class="string">&#x27;boss456&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_app</span>(<span class="params">psw</span>):                                   </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;测试boss app&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;登录测试账号<span class="subst">&#123;psw&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        pytest.main([<span class="string">&#x27;pytest_ywt.py&#x27;</span>,<span class="string">&#x27;-s&#x27;</span>])    　　</span><br><span class="line">        <span class="comment">#初始化清除函数的参数化：传多个参数　　　　　　　　　　　　　　</span></span><br><span class="line">        <span class="keyword">import</span> pytest</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">　　　　　@pytest.fixture(scope=<span class="string">&#x27;module&#x27;</span>,params=[(<span class="number">4723</span>,<span class="string">&#x27;xiaomi&#x27;</span>),(<span class="number">4727</span>,<span class="string">&#x27;meizu&#x27;</span>)])  </span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">before_testquest</span>):           </span><br><span class="line">                port=request.param[<span class="number">0</span>]    　　　　　　</span><br><span class="line">                <span class="comment">#param[0]，假如注入多个参数一个port和一个data，需要params传元组，params=[(4723,100),(4727,200)],                        　　　　</span></span><br><span class="line">                <span class="comment">#一个参数的话不需要写成列表嵌套元素，request.params[0]代表获取元组第一个</span></span><br><span class="line">                device=request.param[<span class="number">1</span>]      　　　　</span><br><span class="line">                <span class="comment">#request.param[1]对应元素里面第二个参数，</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;在<span class="subst">&#123;device&#125;</span>启动被测app&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;连接appium服务<span class="subst">&#123;port&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">yield</span>   </span><br><span class="line">                <span class="comment">#后面写清除动作，</span></span><br><span class="line">                after_test()</span><br><span class="line">                <span class="comment">#request是pytest的对象，(固定写法：request.param)</span></span><br><span class="line">　　　　　　　　　 <span class="comment">#我们在用对象里面的方法的时候pycham不会自动帮我们去显示名字，它也不知道request里面到底什么内容</span></span><br><span class="line">```cpp</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">after_test</span>():</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;关闭被测app&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;断开appium服务&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">            @pytest.mark.usefixtures(<span class="params"><span class="string">&#x27;before_test&#x27;</span></span>)                    </span></span><br><span class="line"><span class="meta">            @pytest.mark.parametrize(<span class="params"><span class="string">&#x27;psw&#x27;</span>,[<span class="string">&#x27;boss123&#x27;</span>,<span class="string">&#x27;boss456&#x27;</span>]</span>)</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">test_app</span>(<span class="params">psw</span>):           </span><br><span class="line">                                        </span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;测试boss app&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;登录测试账号<span class="subst">&#123;psw&#125;</span>&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">                pytest.main([<span class="string">&#x27;pytest_ywt.py&#x27;</span>,<span class="string">&#x27;-s&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>pytest框架执行代码也能在cmd里面直接输入命令执行<br>xxx\test_case&gt; pytest -s 　　</p>
<p>在test_case这个目录执行会运行test_case文件里面所有的测试文件（test开头的测试用例）</p>
<h3 id="分布式"><a href="#分布式" class="headerlink" title="分布式"></a>分布式</h3><p>设置用例每个模块独立，有什么前置做到模块里面，比如测试10个模块，用相关联来做，不能做分布式(并发执行)</p>
<p>每个模块独立还能定制执行那个模块，关联性太强做不到</p>
<p>最好做到每个接口都独立化（前置条件做好）不要做太大关联性的接口</p>
<p>每一层都能做环境清除和定制化（包，模块。类，函数）分层，为后面mark（定点执行哪些用例）和分布式打基础</p>
<p>分布式：必须做到用例的隔离（低耦合，高内聚），用例走串行风险很大，很难维护</p>
<p>3000个请求，全部独立化，然后分布式来做（效率提高几倍–几十倍）</p>
<p>26：分布式的实现<br>　　分布式的核心点：封装设计：相互独立，登录和课程相互独立，至少模块为单元要相互独立，封装相互独立，接口用例之间最好也相互独立　　才能进行分布式</p>
<p>一：pytest分布式环境搭建和理论介绍：</p>
<p>第一步：安装一个库 pip install pytest-xdist 　　分布式运行插件,可以做分布式（这个库有两种运行方式）</p>
<p>运行方式：</p>
<p>1：串行，顺序运行，串行运行，从头到尾</p>
<p>2：并行:pytest-xdist做分布式有两种，一种多核，一种多台机器</p>
<p>一：多核：单机多核来做（同时跑） 使用-n参数</p>
<p>电脑多核有假有真：超线程技术（8内核搞成16核），真8核假8核—</p>
<p>cpu个数：硬件，几个cpu槽，i9900.i710–一般电脑就算一个cpu，单cpu，服务器可能有多个cpu</p>
<p>核数： 电脑的核数，</p>
<p>逻辑核数：逻辑核数可以虚拟化，8核可以变成16核（超线程技术）</p>
<p>多核的话xdist本身的多核的话一般用逻辑核数来做的</p>
<p>二：多机（可以使用虚拟机）—需要搭环境，多台机器 很麻烦，装环境，下库</p>
<p>二：测试用例比较多怎么办：分布式 两种情况</p>
<p>1：量大：多机 （需要文件报告收集还需要搭环境，做起来比较麻烦）</p>
<p>2：单机多核　　很简单，加-n 参数就行 （做ui和需要一些时间等待的时候时间优化特别明显）</p>
<p>串行运行：本身是线程去跑的，python就一个进程，里面很多线程，</p>
<p>走进程的话需要多台机器来做，分量， 用例设计不好会有大问题，数据不对(用例一定要独立化)</p>
<p>并行和多机：用例一定要设计好，不然数据容易出错，逻辑独立（不能有任何关联，不能有前后关系）　　数据和代码封装时候独立化</p>
<p>三：分布式运行代码</p>
<p>#验证单机多核分布式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line">   <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">test_01</span>():</span><br><span class="line">       time.sleep(<span class="number">3</span>)</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&quot;-----test01-----&quot;</span>)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">test_02</span>():</span><br><span class="line">       time.sleep(<span class="number">3</span>)</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&quot;-----test01-----&quot;</span>)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">       <span class="comment"># pytest.main([&quot;test_xdist.py&quot;,&quot;-sq&quot;])  　　　　　　　　</span></span><br><span class="line">       <span class="comment">#这是串行跑的   6s</span></span><br><span class="line">       pytest.main([<span class="string">&quot;test_xdist.py&quot;</span>, <span class="string">&quot;-sq&quot;</span>,<span class="string">&quot;-n&quot;</span>,<span class="string">&quot;8&quot;</span>]) 　　　　</span><br><span class="line">       <span class="comment">#单机多核并行   加&quot;-n&quot;,&quot;8&quot; 参数  ，用8个核来跑,5.41s,时间少了</span></span><br><span class="line">       <span class="comment">#或者测试用例文件目录下 cmd，输入 pytest test_xdist.py -n 8  也可以    这样cmd里执行看到的结果更直观，</span></span><br><span class="line">       <span class="comment">#多核来跑在ui里面时间提升很大，ui里面很多地方需要sleep，等待元素（有等待的的提升比较大）多核跑更快</span></span><br><span class="line">       <span class="comment">#有等待的情况用多核跑效果越明显</span></span><br></pre></td></tr></table></figure>
<p>串行运行本身按照线程去跑的，python本身就一个进程，里面很多线程<br>走进程的话，多台机器做比较合适—分量，<br>用例一定要设计好，不然数据容易出错，逻辑独立（不能有任何关联，不能有前后关系）——数据和代码封装时候独立化</p>
<p>pytest cmd执行多个模块用例：pytest test_xdist.py test_login.py -sq 　　：运行两个.py文件（写多个运行多个）<br>pytest cmd执行多个包的用例：pytest test_xdist test_login -sq 　　：运行test_xdist包和test_login 包<br>还可以运行不同模块的两个包,加包路径 case/test_xdist.py case2/test2_xdist.py</p>
<p><strong>pytest的用例定制化执行　　mark标签</strong></p>
<p>所有的接口不需要全部都跑（冒烟，定制化执行某些指定的业务，）　　　　　“-m”,“test_lesson_add”</p>
<p>一：pytest框架mark标签　　标记非常丰富　　mark标签</p>
<p>mark标签：对于pytest，我们可以再每一个模块，每一个类，每一个方法和用例前面都加上mark，</p>
<p>那样我们在pytest运行的时候就可以只运行带有该mark标签的模块，类，用例</p>
<p>这样的话可以方便我们选择执行自动化时，是执行全部用例，某个模块用例，</p>
<p>某个流程用例，某个单独用例，总之就是可以某个单独的标签下所有用例</p>
<p>mark可以标记不同层次的东西（类，函数，方法都可以标记）文件不用标记（本身就可以定制化执行）</p>
<p>@pytest.mark.lessson_moudle 　　给测试类贴个标签，标签名字叫lessson_moudle标识课程模块，</p>
<p>各个函数，类都可以贴上标签（类似别称），选择某个标签就运行某一个（灵活方便）</p>
<p>什么都不选中照常运行，（全部运行，没有限制）</p>
<p>mark标签pytest运行可能报错，</p>
<p>PytestUnknownMarkWarning报错:是一个标签的mark警告，整个pytest这么写不识别你，但是不会报错，只是警告，</p>
<p>消除警告（增加标签栏，相当于标签的声明）</p>
<p>标签声明写法：teach_sq文件夹里创建一个pytest.ini的文件（pycham需要安装ini插件 file-setting-plugins(搜索ini)社区版似乎不行）</p>
<p>pycham找不到可以离线装</p>
<p>teach_sq<br>pytest.ini——-文件内容如下，相当于pytest的mark标签声明一下</p>
<p><strong>筛选测试用例代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"> </span><br><span class="line"><span class="meta">@pytest.mark.zzzzz</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_001</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;test_001&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_002</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;test_001&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&quot;test1.py&quot;</span>,<span class="string">&#x27;-s&#x27;</span>,<span class="string">&#x27;-m&#x27;</span>,<span class="string">&#x27;zzzzz&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="allure报告"><a href="#allure报告" class="headerlink" title="allure报告"></a>allure报告</h2><p><strong>1、基本使用</strong></p>
<p><strong>&gt;&gt;&gt; 要使allure侦听器能够在测试执行过程中收集结果，只需添加 —alluredir 选项并提供路径即可存储结果。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest --alluredir=&lt;directory-with-results&gt;</span><br></pre></td></tr></table></figure>
<p><strong>单文件python例子(项目根目录,运行后生产一些文件)：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pytest --alluredir ./reports/pytest test01.py</span><br><span class="line"></span><br><span class="line">启动：</span><br><span class="line">allure serve ./reports</span><br></pre></td></tr></table></figure>
<p>插件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pytest-dependency</span><br></pre></td></tr></table></figure>
<p>如果你运行后进行了用例更改，那么下次运行可能还是会查看到之前记录，可添加 <strong>—clean-alluredir</strong> 选项清除之前记录。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest --alluredir=&lt;directory-with-results&gt; --clean-alluredir</span><br></pre></td></tr></table></figure>
<p><strong>&gt;&gt;&gt;</strong> 要在测试完成后查看实际报告，你需要使用allure命令行应用程序从结果生成报告。</p>
<p>（1）在默认浏览器中显示生成的报告</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allure serve &lt;my-allure-results&gt;</span><br><span class="line">allure serve output</span><br></pre></td></tr></table></figure>
<p>2）要从现有的Allure结果生成报告，可以使用以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allure generate &lt;directory-with-results&gt;</span><br></pre></td></tr></table></figure>
<p>默认报告将生成到allure-report文件夹，你可以使用 -o 标志更改目标文件夹：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allure generate &lt;directory-with-results&gt;</span><br></pre></td></tr></table></figure>
<p>（3）生成报告后，可以在默认系统浏览器中将其打开，只需运行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allure open &lt;directory-with-report&gt;</span><br></pre></td></tr></table></figure>
<p>你也可以找到该目录，使用浏览器打开该目录下index.html。注意：有时打开会找不到数据或者乱码，如果你使用的是pycharm，请在pycharm中右击打开。</p>
<p>（4）如果要删除生成的报告数据，只需运行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allure report clean</span><br></pre></td></tr></table></figure>
<p>默认情况下，报告命令将在 <strong>allure-results</strong> 文件夹中查找报告，如果要从其他位置使用报告，则可以使用 <strong>-o</strong> 选项。</p>
<p>（5）你也可以使用 <strong>allure help</strong> 命令查看更多帮助。</p>
<p>测试报告，你可以在allure报告中看到所有默认的pytest状态：只有由于一个断言错误而未成功进行的测试将被标记为失败，其他任何异常都将导致测试的状态为坏。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#更改测试文件的识别规则</span><br><span class="line">python_files=test_*.py</span><br><span class="line">#更改测试方法的命名规则</span><br><span class="line">python_functions=test_*</span><br><span class="line">#配置生成测试报告#</span><br><span class="line">-m level1只运行level1级别的用例</span><br><span class="line">addopts= --html=./reports/report.html -v --alluredir ./allure_temp</span><br><span class="line">markers=</span><br><span class="line">	level1：高级别的用例</span><br><span class="line">	level2：低级别的用例</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>Python框架测试</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://www.fixbox.top/2024/01/22/3-4-Python%E6%A1%86%E6%9E%B6%E6%B5%8B%E8%AF%95/">https://www.fixbox.top/2024/01/22/3-4-Python框架测试/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>Fylasd</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2024-01-22</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2024-01-22</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python%E6%A1%86%E6%9E%B6%E6%B5%8B%E8%AF%95/">Python框架测试</a></div><div class="post_share"><div class="social-share" data-image="https://img2.baidu.com/it/u=3725066843,1857864369&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/22/3-5-Web%E8%87%AA%E5%8A%A8%E5%8C%96/" title="web自动化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">web自动化</div></div></a></div><div class="next-post pull-right"><a href="/2024/01/22/2-1-HTML-CSS%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="HTML+CSS复习笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">HTML+CSS复习笔记</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2.baidu.com/it/u=3725066843,1857864369&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Fylasd</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/"><i class="fab fa-github"></i><span>前往小家</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到博客空间</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95"><span class="toc-text">Python自动化测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unittest%E6%A1%86%E6%9E%B6"><span class="toc-text">unittest框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81TestCase"><span class="toc-text">1、TestCase</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81TestSuite%E5%92%8CTestRunner"><span class="toc-text">2、TestSuite和TestRunner</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81TestLoader"><span class="toc-text">3、TestLoader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81Fixture"><span class="toc-text">4、Fixture</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pytest%E6%A1%86%E6%9E%B6"><span class="toc-text">pytest框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pytest"><span class="toc-text">pytest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pytest%E6%A0%87%E8%AE%B0"><span class="toc-text">pytest标记</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pytest%E5%87%BD%E6%95%B0"><span class="toc-text">pytest函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pytest%E5%8F%82%E6%95%B0"><span class="toc-text">pytest参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-text">读取文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fixture"><span class="toc-text">fixture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#allure"><span class="toc-text">allure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0"><span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F"><span class="toc-text">分布式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#allure%E6%8A%A5%E5%91%8A"><span class="toc-text">allure报告</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Fylasd</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="/js/tw_cn.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script async src="https://npm.elemecdn.com/tzy-blog/lib/js/other/sakura.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'true';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://assets.akilar.top/image/cover1.webp);"> <a class="categoryBar-list-link" href="categories/腾讯广告/">腾讯广告</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">Ubuntu指南</span></li><li class="categoryBar-list-item" style="background:url(https://assets.akilar.top/image/cover2.webp);"> <a class="categoryBar-list-link" href="categories/web前端/">web前端</a><span class="categoryBar-list-count">11</span><span class="categoryBar-list-descr">玩转Win10</span></li><li class="categoryBar-list-item" style="background:url(https://assets.akilar.top/image/cover3.webp);"> <a class="categoryBar-list-link" href="categories/Linux/">Linux</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">长篇小说连载</span></li><li class="categoryBar-list-item" style="background:url(https://assets.akilar.top/image/cover4.webp);"> <a class="categoryBar-list-link" href="categories/SQL数据库/">SQL数据库</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">个人日记</span></li><li class="categoryBar-list-item" style="background:url(https://assets.akilar.top/image/cover5.webp);"> <a class="categoryBar-list-link" href="categories/Python/">Python</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">诗词歌赋</span></li><li class="categoryBar-list-item" style="background:url(https://assets.akilar.top/image/cover6.webp);"> <a class="categoryBar-list-link" href="categories/软件测试/">软件测试</a><span class="categoryBar-list-count">6</span><span class="categoryBar-list-descr">杂谈教程</span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站采用多线部署，主线路托管于Vercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="本站采用多线部署，备用线路托管于4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '1s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '2');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":90,"height":180},"mobile":{"show":false},"log":false});</script></body></html>